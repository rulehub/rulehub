{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"RuleHub Documentation","text":"<p>Welcome to the RuleHub documentation. This site aggregates compliance maps, policy bundles, and supporting metadata for multiple domains (FinTech, RegTech, Kubernetes, etc.).</p>"},{"location":"#quick-start","title":"Quick Start","text":"<p>See Getting Started for local environment setup, validation commands, and how to generate coverage reports.</p>"},{"location":"#what-you-will-find-here","title":"What You Will Find Here","text":"<ul> <li>High\u2011level architecture and metadata model</li> <li>Compliance coverage maps and how they are produced</li> <li>Framework\u2011specific guidance (Gatekeeper / Kyverno)</li> <li>Security, provenance, and release process notes</li> <li>Reference source material attribution</li> </ul>"},{"location":"#repository-structure-snapshot","title":"Repository Structure Snapshot","text":"<pre><code>policies/          # Policy sources (by domain / framework)\ncompliance/maps/   # YAML compliance coverage maps\naddons/            # Distribution-ready policy sets / bundles\ntools/             # Validation, coverage, export utilities\ndocs/              # This documentation content (MkDocs source)\n</code></pre>"},{"location":"#next-steps","title":"Next Steps","text":"<ul> <li>Read the Policy Architecture overview.</li> <li>Explore the Metadata schema expectations.</li> <li>Generate coverage: <code>make coverage</code>.</li> </ul>"},{"location":"#contributing","title":"Contributing","text":"<p>Contribution guidelines are in the root <code>CONTRIBUTING.md</code>. Please review before opening a PR.</p>"},{"location":"#roadmap","title":"Roadmap","text":"<p>Early focus is completeness and provenance of policy references, followed by automated publishing (OPA bundle, OCI distribution, SBOMs, and signatures). See the project TODO for tracked items.</p>"},{"location":"build-info/","title":"Build Info","text":"<ul> <li>Build date: 2025-08-17</li> <li>Domain: Betting</li> <li>Policies: 27</li> </ul>"},{"location":"ci-security/","title":"CI &amp; Security","text":""},{"location":"ci-security/#ci-security-checks","title":"CI security checks","text":"<p>This repo runs the following workflows:</p> <ul> <li>Trivy IaC scan: .github/workflows/trivy.yml</li> <li>Checkov scan: .github/workflows/checkov.yml</li> <li>Secret scanning (TruffleHog): .github/workflows/secrets-scan.yml</li> <li>(Removed) internal policy drift check - handled in external Helm chart repo.</li> </ul> <p>How to read results in GitHub:</p> <ol> <li>Open the Security tab &gt; Code scanning alerts. You will see tools named \"Trivy\" and \"Checkov\". Click an alert to view impacted file, line, and remediation guidance. Use filters (severity, branch, tool) to focus.</li> <li>On a pull request, a short summary comment is posted by Trivy/Checkov. For full details, follow the Security tab link above; PR Checks also show the SARIF upload step.</li> <li>Secret scanning: TruffleHog reports inline in the job logs and will fail the job if verified or likely secrets are found. Click the \"Secret Scanning\" job in the PR Checks to see matched detectors and locations. Rotate any exposed credentials and force-push a fix if needed.</li> <li>Helm chart policy drift (if any) is validated in the <code>rulehub-charts</code> repository CI.</li> </ol> <p>Tips for Trivy/Checkov SARIF views:</p> <ul> <li>Use \"Filter\" to narrow by severity (error/warning/note) and by tool.</li> <li>Each alert links to the exact file/line; open the \"Rule\" to see remediation guidance.</li> <li>You can suppress false positives at the code level using the tool's ignore annotations where applicable, but prefer fixing misconfigurations.</li> </ul> <p>YAML linting: Helm templates are no longer present in this repository.</p>"},{"location":"ci-security/#local-execution-of-github-actions-act","title":"Local execution of GitHub Actions (act)","text":"<p>You can dry\u2011run or fully execute most workflows locally using the <code>act</code> tool. This is useful for quick iteration on workflow YAML before pushing.</p> <p>Install (macOS):</p> <pre><code>brew install act\n</code></pre> <p>Recommended runtime image mapping (add to <code>~/.actrc</code>):</p> <pre><code>-P ubuntu-latest=ghcr.io/catthehacker/ubuntu:act-22.04\n</code></pre> <p>List jobs that would run for an event:</p> <pre><code>act -l\n</code></pre> <p>Run a workflow (simulate push):</p> <pre><code>act push -W .github/workflows/python-tests.yml\n</code></pre> <p>Run a single job from matrix (example Python 3.11):</p> <pre><code>act push -j tests --matrix python-version=3.11 -W .github/workflows/python-tests.yml\n</code></pre> <p>Skip supply\u2011chain (OIDC/signing) steps in <code>opa-bundle-publish</code> (OIDC not available locally):</p> <pre><code>act push -W .github/workflows/opa-bundle-publish.yml -s SKIP_SUPPLYCHAIN=1\n</code></pre> <p>Provide secrets:</p> <pre><code>echo \"GH_TOKEN=ghp_xxx\" &gt; .secrets\nact -s GH_TOKEN=ghp_xxx ...\n</code></pre> <p>Notes / limitations:</p> <ul> <li>OIDC (id-token) and keyless cosign signing can't be reproduced; gate those steps with <code>SKIP_SUPPLYCHAIN</code> (already supported).</li> <li><code>GITHUB_TOKEN</code> permissions differ; don't rely on fine\u2011grained permission simulation locally.</li> <li>Only Linux runner images are emulated.</li> </ul> <p>When to still push a branch / PR:</p> <ul> <li>Validating GitHub security permissions, id\u2011token usage, release publishing, Pages deploy.</li> <li>Scorecard / codeql workflows (they rely on GitHub backend context).</li> </ul> <p>Quick workflow editing loop:</p> <ol> <li>Edit YAML.</li> <li><code>act -l</code> to confirm selection.</li> <li>Run targeted job with <code>-W</code> and <code>-j</code>.</li> <li>Commit once green locally.</li> </ol> <p>If act becomes slow, prune unused Docker layers occasionally:</p> <pre><code>docker system prune -f\n</code></pre>"},{"location":"ci-security/#link-checking-hard-vs-soft-failures","title":"Link checking (hard vs soft failures)","text":"<p>The <code>link-check</code> workflow retries up to 3 times and classifies final failures:</p> <ul> <li>Hard failures (non-429 and non-5xx HTTP codes, DNS errors) fail the job.</li> <li>Soft failures (HTTP 429 or 5xx) are tolerated after retries but reported in the job summary and artifact (<code>lychee.json</code>).</li> </ul> <p>Rationale: transient rate limits and upstream outages shouldn't block unrelated PRs, while genuine 404/410 issues must be fixed promptly.</p> <p>Local reproduction:</p> <pre><code>make link-check-json   # creates lychee.json and classifies\n</code></pre> <p>Review the uploaded artifact on failed or partially soft-failed runs for details.</p>"},{"location":"ci-security/#metadata-strict-mode-locally","title":"Metadata strict mode locally","text":"<p>The metadata validation workflow runs in strict mode (failing on empty path arrays) automatically for pull requests. To opt into strict mode for local <code>act</code> runs or manual dispatches, export <code>STRICT_METADATA=1</code>:</p> <pre><code>STRICT_METADATA=1 act push -W .github/workflows/metadata-validate.yml -j validate\n</code></pre> <p>You can also define a repository or organization variable <code>STRICT_METADATA=1</code> to enforce strict mode on all events.</p>"},{"location":"compliance-maps/","title":"Compliance Maps","text":"<p>This guide describes the purpose, structure, and maintenance rules for compliance map files that link regulation sections to specific policies in the catalog.</p> <ul> <li>Location: <code>compliance/maps/*.yml</code> (one file per regulation/domain)</li> <li>Template: <code>templates/compliance-map.yml.tmpl</code></li> <li>Validation schema: <code>tools/schemas/compliance-map.schema.json</code></li> <li>Validation command: <code>make validate-maps</code> or <code>python3 tools/validate_compliance_maps.py</code></li> </ul>"},{"location":"compliance-maps/#file-structure-and-example","title":"File structure and example","text":"<p>Minimal structure:</p> <pre><code>regulation: PCI DSS           # regulation / domain name\nversion: '4.0'                # version (string or number)\nsections:                     # section key -&gt; object with title and policy list\n  '3.4':\n    title: Protect stored cardholder data\n    policies:\n      - pci.storage_encryption\n      - pci.ebs_encryption\n  '4.2':\n    title: Use strong cryptography for transmission\n    policies:\n      - pci.https_only\n</code></pre> <p>More examples:</p> <ul> <li><code>compliance/maps/gdpr.yml</code> - article style keys: <code>\"Art.5(1)(c)\"</code></li> <li><code>compliance/maps/pci.yml</code> - numeric sections: <code>'3.4'</code>, <code>'8.2'</code></li> <li><code>compliance/maps/fintech_us.yml</code> - textual keys: <code>\"State MTL\"</code></li> </ul>"},{"location":"compliance-maps/#naming-sections-and-policies","title":"Naming: sections and policies","text":""},{"location":"compliance-maps/#section-keys-sections","title":"Section keys (<code>sections</code>)","text":"<ul> <li>Key = stable identifier for the regulation section (number, article, marker) (e.g., <code>\"3.4\"</code>, <code>\"Art.5(1)(c)\"</code>, <code>\"State MTL\"</code>).</li> <li>If the key contains dots, parentheses, or starts with a number, quote it to prevent YAML auto-conversion.</li> <li>Use the canonical citation form from the source regulation; avoid retroactive reformatting (breaks references/diffs).</li> <li><code>title</code> = concise human-readable section name (nullable but recommended).</li> </ul> <p>Recommended key styles:</p> <ul> <li>Articles: <code>\"Art.6\"</code>, <code>\"Art.5(1)(c)\"</code></li> <li>Numeric: <code>'3.4'</code>, <code>'12.10'</code> (quote to keep precision, avoid float)</li> <li>Text groups: <code>\"Workload Security\"</code>, <code>\"State MTL\"</code></li> </ul>"},{"location":"compliance-maps/#policy-identifiers-policies","title":"Policy identifiers (<code>policies[]</code>)","text":"<p>Schema-enforced format: <code>^[a-z0-9_]+\\.[a-z0-9_]+$</code></p> <ul> <li>lowercase letters, digits, underscores only</li> <li>dot separates namespace and short id</li> </ul> <p>Identifier must match <code>id</code> in <code>policies/**/metadata.yaml</code>. Examples: <code>gdpr.data_minimization</code>, <code>pci.storage_encryption</code>, <code>fintech.us_mtl_license</code>.</p> <p>Deriving id from folder structure (when <code>metadata.yaml</code> omits <code>id</code>):</p> <ul> <li><code>policies/&lt;namespace&gt;/&lt;short_id&gt;/metadata.yaml</code> -&gt; <code>&lt;namespace&gt;.&lt;short_id&gt;</code></li> </ul>"},{"location":"compliance-maps/#validation-tooling","title":"Validation &amp; tooling","text":"<p>Baseline validation:</p> <ul> <li><code>make validate-maps</code> or <code>python3 tools/validate_compliance_maps.py</code></li> <li>Ensures JSON schema compliance, at least one policy per section, no unknown policy ids.</li> </ul> <p>Duplicate detection/fix within a single map:</p> <ul> <li>Check: <code>python3 tools/fix_compliance_map_dupes.py --check</code></li> <li>Auto-fix: <code>python3 tools/fix_compliance_map_dupes.py --fix</code></li> <li>Rule: a policy id must appear at most once (even across different sections). First occurrence kept, later ones removed.</li> </ul> <p>Also run <code>make validate</code> which additionally validates policy metadata and file paths.</p>"},{"location":"compliance-maps/#common-mistakes-avoidance","title":"Common mistakes &amp; avoidance","text":"<ol> <li>Unknown policy id</li> </ol> <p>Cause: id absent from <code>policies/**/metadata.yaml</code>.   Fix: verify spelling/case/underscores; add or correct metadata.</p> <ol> <li>Duplicate policy id</li> </ol> <p>Symptom: validator warning or <code>--check</code> output.   Fix: remove duplicates manually or run <code>--fix</code>.</p> <ol> <li>Empty or missing <code>policies</code> array</li> </ol> <p>Symptom: warning or schema error.   Fix: add at least one policy id (placeholder TODO discouraged).</p> <ol> <li>Invalid policy id format</li> </ol> <p>Symptom: schema error.   Fix: lowercase; replace dashes/spaces with underscores.</p> <ol> <li>Unquoted section keys</li> </ol> <p>Symptom: YAML converts <code>'3.4'</code> to float.   Fix: quote keys with dots/parentheses/leading digits.</p> <ol> <li>Inconsistent <code>regulation</code> / <code>version</code></li> </ol> <p>Symptom: divergent naming/versioning styles.   Recommendation: use canonical regulation name (e.g., <code>PCI DSS</code>, <code>GDPR</code>); quote versions (<code>'4.0'</code>, <code>'2016/679'</code>).</p> <ol> <li>YAML syntax errors (indentation, duplicate keys)</li> </ol> <p>Fix: lint before commit; avoid mixing tabs/spaces.</p>"},{"location":"compliance-maps/#maintenance-recommendations","title":"Maintenance recommendations","text":"<ul> <li>Keep section keys stable for referential changes (reports, catalogs, dashboards).</li> <li>Provide meaningful <code>title</code> values for readability.</li> <li>Consolidate small homogeneous requirements instead of duplicating the same policy across many sections.</li> <li>Reuse cross-cutting policies via shared domains (e.g., k8s-baseline) and reference them from individual maps.</li> </ul>"},{"location":"compliance-maps/#useful-repo-references","title":"Useful repo references","text":"<ul> <li>Template: <code>templates/compliance-map.yml.tmpl</code></li> <li>Schema: <code>tools/schemas/compliance-map.schema.json</code></li> <li>Validator: <code>tools/validate_compliance_maps.py</code></li> <li>Duplicate remover: <code>tools/fix_compliance_map_dupes.py</code></li> <li>Coverage reports: <code>docs/coverage.md</code> (Markdown), <code>dist/coverage.html</code> (Mermaid/HTML)</li> </ul>"},{"location":"coverage/","title":"Compliance Coverage","text":""},{"location":"coverage/#eu-amld-56","title":"EU AMLD 5/6","text":"Section Title Policies Coverage Paths <code>Article 13</code> Customer due diligence aml.address_verification, aml.kyc_basic_cdd, aml.minimum_age, aml.ubo_identification OK aml.address_verification: OK policies/aml/address_verification/policy.rego, OK policies/aml/address_verification/policy_test.rego; aml.kyc_basic_cdd: OK policies/aml/kyc_basic_cdd/policy.rego, OK policies/aml/kyc_basic_cdd/policy_test.rego; aml.minimum_age: OK policies/aml/minimum_age/policy.rego, OK policies/aml/minimum_age/policy_test.rego; aml.ubo_identification: OK policies/aml/ubo_identification/policy.rego, OK policies/aml/ubo_identification/policy_test.rego <code>Article 18</code> Enhanced due diligence aml.high_risk_country_edd, aml.sanctions_check OK aml.high_risk_country_edd: OK policies/aml/high_risk_country_edd/policy.rego, OK policies/aml/high_risk_country_edd/policy_test.rego; aml.sanctions_check: OK policies/aml/sanctions_check/policy.rego, OK policies/aml/sanctions_check/policy_test.rego <code>Article 20</code> PEP aml.pep_screening_required OK aml.pep_screening_required: OK policies/aml/pep_screening_required/policy.rego, OK policies/aml/pep_screening_required/policy_test.rego <code>Article 33</code> Transaction monitoring aml.txn_monitoring_thresholds OK aml.txn_monitoring_thresholds: OK policies/aml/txn_monitoring_thresholds/policy.rego, OK policies/aml/txn_monitoring_thresholds/policy_test.rego <p>Coverage: 8/8 (100%)</p>"},{"location":"coverage/#betting-multi-jurisdiction-current","title":"Betting (multi-jurisdiction) current","text":"Section Title Policies Coverage Paths <code>1. Operator Controls</code> Licensing, KYC and Core Controls betting.adr_provider_listed_uk, betting.affordability_checks_uk, betting.complaints_process_published, betting.kyc_onboarding, betting.kyc_on_withdrawal, betting.license_check_adm_it, betting.license_check_anj_fr, betting.license_check_au_nt, betting.license_check_brazil_14790, betting.license_check_ca_on_igaming, betting.license_check_coljuegos_co, betting.license_check_dgoj_es, betting.license_check_ggl_de, betting.license_check_gra_sg, betting.license_check_ksa_nl, betting.license_check_mga, betting.license_check_spelinspektionen_se, betting.license_check_spillemyndigheden_dk, betting.license_check_ukgc, betting.license_check_us_co_division, betting.license_check_us_nj_dge, betting.license_check_us_nv_ngcb, betting.license_check_us_pa_pgcb, betting.player_funds_segregation, betting.source_of_funds_checks, betting.source_of_funds_thresholds, betting.license_check_agco_on OK betting.adr_provider_listed_uk: OK policies/betting/adr_provider_listed_uk/policy.rego, OK policies/betting/adr_provider_listed_uk/policy_test.rego; betting.affordability_checks_uk: OK policies/betting/affordability_checks_uk/policy.rego, OK policies/betting/affordability_checks_uk/policy_test.rego; betting.complaints_process_published: OK policies/betting/complaints_process_published/policy.rego, OK policies/betting/complaints_process_published/policy_test.rego; betting.kyc_onboarding: OK policies/betting/kyc_onboarding/policy.rego, OK policies/betting/kyc_onboarding/policy_test.rego; betting.kyc_on_withdrawal: OK policies/betting/kyc_on_withdrawal/policy.rego, OK policies/betting/kyc_on_withdrawal/policy_test.rego; betting.license_check_adm_it: OK policies/betting/license_check_adm_it/policy.rego, OK policies/betting/license_check_adm_it/policy_test.rego; betting.license_check_anj_fr: OK policies/betting/license_check_anj_fr/policy.rego, OK policies/betting/license_check_anj_fr/policy_test.rego; betting.license_check_au_nt: OK policies/betting/license_check_au_nt/policy.rego, OK policies/betting/license_check_au_nt/policy_test.rego; betting.license_check_brazil_14790: OK policies/betting/license_check_brazil_14790/policy.rego, OK policies/betting/license_check_brazil_14790/policy_test.rego; betting.license_check_ca_on_igaming: OK policies/betting/license_check_ca_on_igaming/policy.rego, OK policies/betting/license_check_ca_on_igaming/policy_test.rego; betting.license_check_coljuegos_co: OK policies/betting/license_check_coljuegos_co/policy.rego, OK policies/betting/license_check_coljuegos_co/policy_test.rego; betting.license_check_dgoj_es: OK policies/betting/license_check_dgoj_es/policy.rego, OK policies/betting/license_check_dgoj_es/policy_test.rego; betting.license_check_ggl_de: OK policies/betting/license_check_ggl_de/policy.rego, OK policies/betting/license_check_ggl_de/policy_test.rego; betting.license_check_gra_sg: OK policies/betting/license_check_gra_sg/policy.rego, OK policies/betting/license_check_gra_sg/policy_test.rego; betting.license_check_ksa_nl: OK policies/betting/license_check_ksa_nl/policy.rego, OK policies/betting/license_check_ksa_nl/policy_test.rego; betting.license_check_mga: OK policies/betting/license_check_mga/policy.rego, OK policies/betting/license_check_mga/policy_test.rego; betting.license_check_spelinspektionen_se: OK policies/betting/license_check_spelinspektionen_se/policy.rego, OK policies/betting/license_check_spelinspektionen_se/policy_test.rego; betting.license_check_spillemyndigheden_dk: OK policies/betting/license_check_spillemyndigheden_dk/policy.rego, OK policies/betting/license_check_spillemyndigheden_dk/policy_test.rego; betting.license_check_ukgc: OK policies/betting/license_check_ukgc/policy.rego, OK policies/betting/license_check_ukgc/policy_test.rego; betting.license_check_us_co_division: OK policies/betting/license_check_us_co_division/policy.rego, OK policies/betting/license_check_us_co_division/policy_test.rego; betting.license_check_us_nj_dge: OK policies/betting/license_check_us_nj_dge/policy.rego, OK policies/betting/license_check_us_nj_dge/policy_test.rego; betting.license_check_us_nv_ngcb: OK policies/betting/license_check_us_nv_ngcb/policy.rego, OK policies/betting/license_check_us_nv_ngcb/policy_test.rego; betting.license_check_us_pa_pgcb: OK policies/betting/license_check_us_pa_pgcb/policy.rego, OK policies/betting/license_check_us_pa_pgcb/policy_test.rego; betting.player_funds_segregation: OK policies/betting/player_funds_segregation/policy.rego, OK policies/betting/player_funds_segregation/policy_test.rego; betting.source_of_funds_checks: OK policies/betting/source_of_funds_checks/policy.rego, OK policies/betting/source_of_funds_checks/policy_test.rego; betting.source_of_funds_thresholds: OK policies/betting/source_of_funds_thresholds/policy.rego, OK policies/betting/source_of_funds_thresholds/policy_test.rego; betting.license_check_agco_on: OK policies/betting/license_check_agco_on/policy.rego, OK policies/betting/license_check_agco_on/policy_test.rego <code>2. Market Integrity</code> Integrity, Data, and Youth Protection betting.ads_bonus_terms_fair_clear, betting.ads_no_minors_targeting, betting.age_verification_before_gambling_uk, betting.credit_card_gambling_ban_uk, betting.data_integrity_audits, betting.game_rules_visible_before_play, betting.geofencing_regulated_markets, betting.in_play_delay_controls, betting.market_restrictions_youth, betting.match_fixing_monitoring, betting.no_bets_by_participants, betting.official_data_only, betting.reverse_withdrawal_ban_uk, betting.rng_certification_gli11, betting.rtp_disclosure_to_players, betting.suspicious_betting_reporting_uk, betting.slots_min_spin_speed_uk, betting.slots_no_autoplay_uk, betting.slots_no_losses_disguised_as_wins OK betting.ads_bonus_terms_fair_clear: OK policies/betting/ads_bonus_terms_fair_clear/policy.rego, OK policies/betting/ads_bonus_terms_fair_clear/policy_test.rego; betting.ads_no_minors_targeting: OK policies/betting/ads_no_minors_targeting/policy.rego, OK policies/betting/ads_no_minors_targeting/policy_test.rego; betting.age_verification_before_gambling_uk: OK policies/betting/age_verification_before_gambling_uk/policy.rego, OK policies/betting/age_verification_before_gambling_uk/policy_test.rego; betting.credit_card_gambling_ban_uk: OK policies/betting/credit_card_gambling_ban_uk/policy.rego, OK policies/betting/credit_card_gambling_ban_uk/policy_test.rego; betting.data_integrity_audits: OK policies/betting/data_integrity_audits/policy.rego, OK policies/betting/data_integrity_audits/policy_test.rego; betting.game_rules_visible_before_play: OK policies/betting/game_rules_visible_before_play/policy.rego, OK policies/betting/game_rules_visible_before_play/policy_test.rego; betting.geofencing_regulated_markets: OK policies/betting/geofencing_regulated_markets/policy.rego, OK policies/betting/geofencing_regulated_markets/policy_test.rego; betting.in_play_delay_controls: OK policies/betting/in_play_delay_controls/policy.rego, OK policies/betting/in_play_delay_controls/policy_test.rego; betting.market_restrictions_youth: OK policies/betting/market_restrictions_youth/policy.rego, OK policies/betting/market_restrictions_youth/policy_test.rego; betting.match_fixing_monitoring: OK policies/betting/match_fixing_monitoring/policy.rego, OK policies/betting/match_fixing_monitoring/policy_test.rego; betting.no_bets_by_participants: OK policies/betting/no_bets_by_participants/policy.rego, OK policies/betting/no_bets_by_participants/policy_test.rego; betting.official_data_only: OK policies/betting/official_data_only/policy.rego, OK policies/betting/official_data_only/policy_test.rego; betting.reverse_withdrawal_ban_uk: OK policies/betting/reverse_withdrawal_ban_uk/policy.rego, OK policies/betting/reverse_withdrawal_ban_uk/policy_test.rego; betting.rng_certification_gli11: OK policies/betting/rng_certification_gli11/policy.rego, OK policies/betting/rng_certification_gli11/policy_test.rego; betting.rtp_disclosure_to_players: OK policies/betting/rtp_disclosure_to_players/policy.rego, OK policies/betting/rtp_disclosure_to_players/policy_test.rego; betting.suspicious_betting_reporting_uk: OK policies/betting/suspicious_betting_reporting_uk/policy.rego, OK policies/betting/suspicious_betting_reporting_uk/policy_test.rego; betting.slots_min_spin_speed_uk: OK policies/betting/slots_min_spin_speed_uk/policy.rego, OK policies/betting/slots_min_spin_speed_uk/policy_test.rego; betting.slots_no_autoplay_uk: OK policies/betting/slots_no_autoplay_uk/policy.rego, OK policies/betting/slots_no_autoplay_uk/policy_test.rego; betting.slots_no_losses_disguised_as_wins: OK policies/betting/slots_no_losses_disguised_as_wins/policy.rego, OK policies/betting/slots_no_losses_disguised_as_wins/policy_test.rego <code>3. AML Monitoring</code> Ongoing Monitoring &amp; Anomalies betting.aml_high_risk_country_restrictions, betting.aml_sar_reporting_uk, betting.ongoing_aml_monitoring, betting.sanctions_screening_global, betting.txn_monitoring_anomalies OK betting.aml_high_risk_country_restrictions: OK policies/betting/aml_high_risk_country_restrictions/policy.rego, OK policies/betting/aml_high_risk_country_restrictions/policy_test.rego; betting.aml_sar_reporting_uk: OK policies/betting/aml_sar_reporting_uk/policy.rego, OK policies/betting/aml_sar_reporting_uk/policy_test.rego; betting.ongoing_aml_monitoring: OK policies/betting/ongoing_aml_monitoring/policy.rego, OK policies/betting/ongoing_aml_monitoring/policy_test.rego; betting.sanctions_screening_global: OK policies/betting/sanctions_screening_global/policy.rego, OK policies/betting/sanctions_screening_global/policy_test.rego; betting.txn_monitoring_anomalies: OK policies/betting/txn_monitoring_anomalies/policy.rego, OK policies/betting/txn_monitoring_anomalies/policy_test.rego <code>4. Player Protection &amp; Limits</code> Player Protection &amp; Limits betting.deposit_limit_controls, betting.loss_limit_controls, betting.reality_checks_elapsed_time, betting.safer_gambling_interactions, betting.self_exclusion_de_oasis, betting.self_exclusion_dk_rofus, betting.self_exclusion_es_rgiaj, betting.self_exclusion_nl_cruks, betting.self_exclusion_se_spelpaus, betting.self_exclusion_uk_gamstop, betting.session_time_limits_controls, betting.self_exclusion_on_igaming, betting.au_iga_no_prohibited_services OK betting.deposit_limit_controls: OK policies/betting/deposit_limit_controls/policy.rego, OK policies/betting/deposit_limit_controls/policy_test.rego; betting.loss_limit_controls: OK policies/betting/loss_limit_controls/policy.rego, OK policies/betting/loss_limit_controls/policy_test.rego; betting.reality_checks_elapsed_time: OK policies/betting/reality_checks_elapsed_time/policy.rego, OK policies/betting/reality_checks_elapsed_time/policy_test.rego; betting.safer_gambling_interactions: OK policies/betting/safer_gambling_interactions/policy.rego, OK policies/betting/safer_gambling_interactions/policy_test.rego; betting.self_exclusion_de_oasis: OK policies/betting/self_exclusion_de_oasis/policy.rego, OK policies/betting/self_exclusion_de_oasis/policy_test.rego; betting.self_exclusion_dk_rofus: OK policies/betting/self_exclusion_dk_rofus/policy.rego, OK policies/betting/self_exclusion_dk_rofus/policy_test.rego; betting.self_exclusion_es_rgiaj: OK policies/betting/self_exclusion_es_rgiaj/policy.rego, OK policies/betting/self_exclusion_es_rgiaj/policy_test.rego; betting.self_exclusion_nl_cruks: OK policies/betting/self_exclusion_nl_cruks/policy.rego, OK policies/betting/self_exclusion_nl_cruks/policy_test.rego; betting.self_exclusion_se_spelpaus: OK policies/betting/self_exclusion_se_spelpaus/policy.rego, OK policies/betting/self_exclusion_se_spelpaus/policy_test.rego; betting.self_exclusion_uk_gamstop: OK policies/betting/self_exclusion_uk_gamstop/policy.rego, OK policies/betting/self_exclusion_uk_gamstop/policy_test.rego; betting.session_time_limits_controls: OK policies/betting/session_time_limits_controls/policy.rego, OK policies/betting/session_time_limits_controls/policy_test.rego; betting.self_exclusion_on_igaming: OK policies/betting/self_exclusion_on_igaming/policy.rego, OK policies/betting/self_exclusion_on_igaming/policy_test.rego; betting.au_iga_no_prohibited_services: OK policies/betting/au_iga_no_prohibited_services/policy.rego, OK policies/betting/au_iga_no_prohibited_services/policy_test.rego <p>Coverage: 64/64 (100%)</p>"},{"location":"coverage/#edtech-multi-jurisdiction-current","title":"EdTech (multi-jurisdiction) current","text":"Section Title Policies Coverage Paths <code>US Federal</code> US Federal Student Privacy edtech.coppa_data_minimization, edtech.coppa_delete_on_parent_request, edtech.coppa_parental_consent_under_13, edtech.ferpa_consent_or_exception_for_disclosure, edtech.ferpa_directory_info_optout_respected, edtech.ferpa_parent_access_rights, edtech.ppra_parental_consent_sensitive_surveys OK edtech.coppa_data_minimization: OK policies/edtech/coppa_data_minimization/policy.rego, OK policies/edtech/coppa_data_minimization/policy_test.rego; edtech.coppa_delete_on_parent_request: OK policies/edtech/coppa_delete_on_parent_request/policy.rego, OK policies/edtech/coppa_delete_on_parent_request/policy_test.rego; edtech.coppa_parental_consent_under_13: OK policies/edtech/coppa_parental_consent_under_13/policy.rego, OK policies/edtech/coppa_parental_consent_under_13/policy_test.rego; edtech.ferpa_consent_or_exception_for_disclosure: OK policies/edtech/ferpa_consent_or_exception_for_disclosure/policy.rego, OK policies/edtech/ferpa_consent_or_exception_for_disclosure/policy_test.rego; edtech.ferpa_directory_info_optout_respected: OK policies/edtech/ferpa_directory_info_optout_respected/policy.rego, OK policies/edtech/ferpa_directory_info_optout_respected/policy_test.rego; edtech.ferpa_parent_access_rights: OK policies/edtech/ferpa_parent_access_rights/policy.rego, OK policies/edtech/ferpa_parent_access_rights/policy_test.rego; edtech.ppra_parental_consent_sensitive_surveys: OK policies/edtech/ppra_parental_consent_sensitive_surveys/policy.rego, OK policies/edtech/ppra_parental_consent_sensitive_surveys/policy_test.rego <code>US States</code> US State-Level Laws edtech.ca_sopipa_no_sale_of_student_data, edtech.ca_sopipa_no_targeted_advertising, edtech.co_student_data_transparency, edtech.ct_student_data_privacy, edtech.il_soppa_breach_notification, edtech.ny_edlaw2d_encryption_and_contracts OK edtech.ca_sopipa_no_sale_of_student_data: OK policies/edtech/ca_sopipa_no_sale_of_student_data/policy.rego, OK policies/edtech/ca_sopipa_no_sale_of_student_data/policy_test.rego; edtech.ca_sopipa_no_targeted_advertising: OK policies/edtech/ca_sopipa_no_targeted_advertising/policy.rego, OK policies/edtech/ca_sopipa_no_targeted_advertising/policy_test.rego; edtech.co_student_data_transparency: OK policies/edtech/co_student_data_transparency/policy.rego, OK policies/edtech/co_student_data_transparency/policy_test.rego; edtech.ct_student_data_privacy: OK policies/edtech/ct_student_data_privacy/policy.rego, OK policies/edtech/ct_student_data_privacy/policy_test.rego; edtech.il_soppa_breach_notification: OK policies/edtech/il_soppa_breach_notification/policy.rego, OK policies/edtech/il_soppa_breach_notification/policy_test.rego; edtech.ny_edlaw2d_encryption_and_contracts: OK policies/edtech/ny_edlaw2d_encryption_and_contracts/policy.rego, OK policies/edtech/ny_edlaw2d_encryption_and_contracts/policy_test.rego <code>International</code> International and Non-US Regulations edtech.au_app_11_security_edtech, edtech.au_app_5_notice_edtech, edtech.au_ndb_breach_notification_edtech, edtech.br_lgpd_children_consent_best_interest, edtech.ca_pipeda_consent_edtech, edtech.eu_dpia_high_risk_edtech, edtech.eu_eprivacy_cookie_consent_edtech, edtech.eu_gdpr_minors_consent_education, edtech.eu_scc_transfers_edplatform, edtech.in_dpdpa_children_verifiable_consent, edtech.kr_pipa_guardian_consent_under_14, edtech.nz_notice_at_collection_edtech, edtech.uk_aadc_privacy_by_default, edtech.uk_aadc_profiling_and_geolocation_off OK edtech.au_app_11_security_edtech: OK policies/edtech/au_app_11_security_edtech/policy.rego, OK policies/edtech/au_app_11_security_edtech/policy_test.rego; edtech.au_app_5_notice_edtech: OK policies/edtech/au_app_5_notice_edtech/policy.rego, OK policies/edtech/au_app_5_notice_edtech/policy_test.rego; edtech.au_ndb_breach_notification_edtech: OK policies/edtech/au_ndb_breach_notification_edtech/policy.rego, OK policies/edtech/au_ndb_breach_notification_edtech/policy_test.rego; edtech.br_lgpd_children_consent_best_interest: OK policies/edtech/br_lgpd_children_consent_best_interest/policy.rego, OK policies/edtech/br_lgpd_children_consent_best_interest/policy_test.rego; edtech.ca_pipeda_consent_edtech: OK policies/edtech/ca_pipeda_consent_edtech/policy.rego, OK policies/edtech/ca_pipeda_consent_edtech/policy_test.rego; edtech.eu_dpia_high_risk_edtech: OK policies/edtech/eu_dpia_high_risk_edtech/policy.rego, OK policies/edtech/eu_dpia_high_risk_edtech/policy_test.rego; edtech.eu_eprivacy_cookie_consent_edtech: OK policies/edtech/eu_eprivacy_cookie_consent_edtech/policy.rego, OK policies/edtech/eu_eprivacy_cookie_consent_edtech/policy_test.rego; edtech.eu_gdpr_minors_consent_education: OK policies/edtech/eu_gdpr_minors_consent_education/policy.rego, OK policies/edtech/eu_gdpr_minors_consent_education/policy_test.rego; edtech.eu_scc_transfers_edplatform: OK policies/edtech/eu_scc_transfers_edplatform/policy.rego, OK policies/edtech/eu_scc_transfers_edplatform/policy_test.rego; edtech.in_dpdpa_children_verifiable_consent: OK policies/edtech/in_dpdpa_children_verifiable_consent/policy.rego, OK policies/edtech/in_dpdpa_children_verifiable_consent/policy_test.rego; edtech.kr_pipa_guardian_consent_under_14: OK policies/edtech/kr_pipa_guardian_consent_under_14/policy.rego, OK policies/edtech/kr_pipa_guardian_consent_under_14/policy_test.rego; edtech.nz_notice_at_collection_edtech: OK policies/edtech/nz_notice_at_collection_edtech/policy.rego, OK policies/edtech/nz_notice_at_collection_edtech/policy_test.rego; edtech.uk_aadc_privacy_by_default: OK policies/edtech/uk_aadc_privacy_by_default/policy.rego, OK policies/edtech/uk_aadc_privacy_by_default/policy_test.rego; edtech.uk_aadc_profiling_and_geolocation_off: OK policies/edtech/uk_aadc_profiling_and_geolocation_off/policy.rego, OK policies/edtech/uk_aadc_profiling_and_geolocation_off/policy_test.rego <code>Security &amp; Ops</code> Security and Operational Baseline edtech.edtech_access_least_privilege, edtech.edtech_audit_logs_student_record_access, edtech.edtech_encryption_at_rest, edtech.edtech_encryption_in_transit, edtech.edtech_retention_after_course_completion OK edtech.edtech_access_least_privilege: OK policies/edtech/edtech_access_least_privilege/policy.rego, OK policies/edtech/edtech_access_least_privilege/policy_test.rego; edtech.edtech_audit_logs_student_record_access: OK policies/edtech/edtech_audit_logs_student_record_access/policy.rego, OK policies/edtech/edtech_audit_logs_student_record_access/policy_test.rego; edtech.edtech_encryption_at_rest: OK policies/edtech/edtech_encryption_at_rest/policy.rego, OK policies/edtech/edtech_encryption_at_rest/policy_test.rego; edtech.edtech_encryption_in_transit: OK policies/edtech/edtech_encryption_in_transit/policy.rego, OK policies/edtech/edtech_encryption_in_transit/policy_test.rego; edtech.edtech_retention_after_course_completion: OK policies/edtech/edtech_retention_after_course_completion/policy.rego, OK policies/edtech/edtech_retention_after_course_completion/policy_test.rego <p>Coverage: 32/32 (100%)</p>"},{"location":"coverage/#psd2-20152366","title":"PSD2 2015/2366","text":"Section Title Policies Coverage Paths <code>SCA</code> Strong Customer Authentication fintech.psd2_sca OK fintech.psd2_sca: OK policies/fintech/psd2_sca/policy.rego, OK policies/fintech/psd2_sca/policy_test.rego <p>Coverage: 1/1 (100%)</p>"},{"location":"coverage/#rbi-ekyc-placeholder","title":"RBI eKYC placeholder","text":"Section Title Policies Coverage Paths <code>High-risk eKYC</code> High-risk eKYC controls required fintech.rbi_ekyc_risk OK fintech.rbi_ekyc_risk: OK policies/fintech/rbi_ekyc_risk/policy.rego, OK policies/fintech/rbi_ekyc_risk/policy_test.rego <p>Coverage: 1/1 (100%)</p>"},{"location":"coverage/#fintech-max-2025-08-17","title":"Fintech Max 2025-08-17","text":"Section Title Policies Coverage Paths <code>AML/KYC Core</code> Screening, risk, monitoring fintech.aml_account_freeze_on_hit, fintech.aml_adverse_media_screening, fintech.aml_customer_risk_tiering, fintech.aml_duplicate_account_detection, fintech.aml_geolocation_restrictions, fintech.aml_ongoing_monitoring, fintech.aml_pep_screening, fintech.aml_risk_scoring_model, fintech.aml_sanctions_rescreening_frequency, fintech.aml_sanctions_screening, fintech.aml_transaction_velocity_limits, fintech.aml_unusual_activity_alerting, fintech.aml_watchlist_management, fintech.aml_pep_periodic_review, fintech.aml_manual_review_queue OK fintech.aml_account_freeze_on_hit: OK policies/fintech/aml_account_freeze_on_hit/policy.rego, OK policies/fintech/aml_account_freeze_on_hit/policy_test.rego; fintech.aml_adverse_media_screening: OK policies/fintech/aml_adverse_media_screening/policy.rego, OK policies/fintech/aml_adverse_media_screening/policy_test.rego; fintech.aml_customer_risk_tiering: OK policies/fintech/aml_customer_risk_tiering/policy.rego, OK policies/fintech/aml_customer_risk_tiering/policy_test.rego; fintech.aml_duplicate_account_detection: OK policies/fintech/aml_duplicate_account_detection/policy.rego, OK policies/fintech/aml_duplicate_account_detection/policy_test.rego; fintech.aml_geolocation_restrictions: OK policies/fintech/aml_geolocation_restrictions/policy.rego, OK policies/fintech/aml_geolocation_restrictions/policy_test.rego; fintech.aml_ongoing_monitoring: OK policies/fintech/aml_ongoing_monitoring/policy.rego, OK policies/fintech/aml_ongoing_monitoring/policy_test.rego; fintech.aml_pep_screening: OK policies/fintech/aml_pep_screening/policy.rego, OK policies/fintech/aml_pep_screening/policy_test.rego; fintech.aml_risk_scoring_model: OK policies/fintech/aml_risk_scoring_model/policy.rego, OK policies/fintech/aml_risk_scoring_model/policy_test.rego; fintech.aml_sanctions_rescreening_frequency: OK policies/fintech/aml_sanctions_rescreening_frequency/policy.rego, OK policies/fintech/aml_sanctions_rescreening_frequency/policy_test.rego; fintech.aml_sanctions_screening: OK policies/fintech/aml_sanctions_screening/policy.rego, OK policies/fintech/aml_sanctions_screening/policy_test.rego; fintech.aml_transaction_velocity_limits: OK policies/fintech/aml_transaction_velocity_limits/policy.rego, OK policies/fintech/aml_transaction_velocity_limits/policy_test.rego; fintech.aml_unusual_activity_alerting: OK policies/fintech/aml_unusual_activity_alerting/policy.rego, OK policies/fintech/aml_unusual_activity_alerting/policy_test.rego; fintech.aml_watchlist_management: OK policies/fintech/aml_watchlist_management/policy.rego, OK policies/fintech/aml_watchlist_management/policy_test.rego; fintech.aml_pep_periodic_review: OK policies/fintech/aml_pep_periodic_review/policy.rego, OK policies/fintech/aml_pep_periodic_review/policy_test.rego; fintech.aml_manual_review_queue: OK policies/fintech/aml_manual_review_queue/policy.rego, OK policies/fintech/aml_manual_review_queue/policy_test.rego <code>KYC Process</code> Identity verification &amp; lifecycle fintech.kyc_biometric_liveness, fintech.kyc_document_verification, fintech.kyc_reverification_schedule, fintech.kyc_source_of_funds, fintech.kyc_source_of_wealth OK fintech.kyc_biometric_liveness: OK policies/fintech/kyc_biometric_liveness/policy.rego, OK policies/fintech/kyc_biometric_liveness/policy_test.rego; fintech.kyc_document_verification: OK policies/fintech/kyc_document_verification/policy.rego, OK policies/fintech/kyc_document_verification/policy_test.rego; fintech.kyc_reverification_schedule: OK policies/fintech/kyc_reverification_schedule/policy.rego, OK policies/fintech/kyc_reverification_schedule/policy_test.rego; fintech.kyc_source_of_funds: OK policies/fintech/kyc_source_of_funds/policy.rego, OK policies/fintech/kyc_source_of_funds/policy_test.rego; fintech.kyc_source_of_wealth: OK policies/fintech/kyc_source_of_wealth/policy.rego, OK policies/fintech/kyc_source_of_wealth/policy_test.rego <code>Open Banking / PSD2</code> SCA, exemptions, APIs and consent fintech.fapi_compliance, fintech.ob_audit_logging, fintech.ob_consent_expiry_90d, fintech.ob_consent_revocation, fintech.ob_data_minimization, fintech.ob_rate_limits, fintech.ob_tpp_eidas_cert_validation, fintech.psd2_sca_enforced, fintech.psd2_sca_exemptions_controls, fintech.psd2_transaction_risk_analysis, fintech.xs2a_api_security OK fintech.fapi_compliance: OK policies/fintech/fapi_compliance/policy.rego, OK policies/fintech/fapi_compliance/policy_test.rego; fintech.ob_audit_logging: OK policies/fintech/ob_audit_logging/policy.rego, OK policies/fintech/ob_audit_logging/policy_test.rego; fintech.ob_consent_expiry_90d: OK policies/fintech/ob_consent_expiry_90d/policy.rego, OK policies/fintech/ob_consent_expiry_90d/policy_test.rego; fintech.ob_consent_revocation: OK policies/fintech/ob_consent_revocation/policy.rego, OK policies/fintech/ob_consent_revocation/policy_test.rego; fintech.ob_data_minimization: OK policies/fintech/ob_data_minimization/policy.rego, OK policies/fintech/ob_data_minimization/policy_test.rego; fintech.ob_rate_limits: OK policies/fintech/ob_rate_limits/policy.rego, OK policies/fintech/ob_rate_limits/policy_test.rego; fintech.ob_tpp_eidas_cert_validation: OK policies/fintech/ob_tpp_eidas_cert_validation/policy.rego, OK policies/fintech/ob_tpp_eidas_cert_validation/policy_test.rego; fintech.psd2_sca_enforced: OK policies/fintech/psd2_sca_enforced/policy.rego, OK policies/fintech/psd2_sca_enforced/policy_test.rego; fintech.psd2_sca_exemptions_controls: OK policies/fintech/psd2_sca_exemptions_controls/policy.rego, OK policies/fintech/psd2_sca_exemptions_controls/policy_test.rego; fintech.psd2_transaction_risk_analysis: OK policies/fintech/psd2_transaction_risk_analysis/policy.rego, OK policies/fintech/psd2_transaction_risk_analysis/policy_test.rego; fintech.xs2a_api_security: OK policies/fintech/xs2a_api_security/policy.rego, OK policies/fintech/xs2a_api_security/policy_test.rego <code>Auth &amp; API Security</code> Strong auth and secure APIs fintech.jwt_expiry_policy, fintech.mtls_required, fintech.oauth2_pkce_required, fintech.three_ds_required OK fintech.jwt_expiry_policy: OK policies/fintech/jwt_expiry_policy/policy.rego, OK policies/fintech/jwt_expiry_policy/policy_test.rego; fintech.mtls_required: OK policies/fintech/mtls_required/policy.rego, OK policies/fintech/mtls_required/policy_test.rego; fintech.oauth2_pkce_required: OK policies/fintech/oauth2_pkce_required/policy.rego, OK policies/fintech/oauth2_pkce_required/policy_test.rego; fintech.three_ds_required: OK policies/fintech/three_ds_required/policy.rego, OK policies/fintech/three_ds_required/policy_test.rego <code>PCI / AppSec</code> PCI DSS and application security controls fintech.pci_account_lockout, fintech.pci_default_passwords_changed, fintech.pci_file_integrity_monitoring, fintech.pci_https_only, fintech.pci_key_management, fintech.pci_log_retention, fintech.pci_malware_protection, fintech.pci_mfa_required, fintech.pci_network_segmentation, fintech.pci_pan_masking_in_logs, fintech.pci_secure_coding_practices, fintech.pci_session_timeout, fintech.pci_storage_encryption, fintech.pci_tls_min_version, fintech.pci_vulnerability_scanning OK fintech.pci_account_lockout: OK policies/fintech/pci_account_lockout/policy.rego, OK policies/fintech/pci_account_lockout/policy_test.rego; fintech.pci_default_passwords_changed: OK policies/fintech/pci_default_passwords_changed/policy.rego, OK policies/fintech/pci_default_passwords_changed/policy_test.rego; fintech.pci_file_integrity_monitoring: OK policies/fintech/pci_file_integrity_monitoring/policy.rego, OK policies/fintech/pci_file_integrity_monitoring/policy_test.rego; fintech.pci_https_only: OK policies/fintech/pci_https_only/policy.rego, OK policies/fintech/pci_https_only/policy_test.rego; fintech.pci_key_management: OK policies/fintech/pci_key_management/policy.rego, OK policies/fintech/pci_key_management/policy_test.rego; fintech.pci_log_retention: OK policies/fintech/pci_log_retention/policy.rego, OK policies/fintech/pci_log_retention/policy_test.rego; fintech.pci_malware_protection: OK policies/fintech/pci_malware_protection/policy.rego, OK policies/fintech/pci_malware_protection/policy_test.rego; fintech.pci_mfa_required: OK policies/fintech/pci_mfa_required/policy.rego, OK policies/fintech/pci_mfa_required/policy_test.rego; fintech.pci_network_segmentation: OK policies/fintech/pci_network_segmentation/policy.rego, OK policies/fintech/pci_network_segmentation/policy_test.rego; fintech.pci_pan_masking_in_logs: OK policies/fintech/pci_pan_masking_in_logs/policy.rego, OK policies/fintech/pci_pan_masking_in_logs/policy_test.rego; fintech.pci_secure_coding_practices: OK policies/fintech/pci_secure_coding_practices/policy.rego, OK policies/fintech/pci_secure_coding_practices/policy_test.rego; fintech.pci_session_timeout: OK policies/fintech/pci_session_timeout/policy.rego, OK policies/fintech/pci_session_timeout/policy_test.rego; fintech.pci_storage_encryption: OK policies/fintech/pci_storage_encryption/policy.rego, OK policies/fintech/pci_storage_encryption/policy_test.rego; fintech.pci_tls_min_version: OK policies/fintech/pci_tls_min_version/policy.rego, OK policies/fintech/pci_tls_min_version/policy_test.rego; fintech.pci_vulnerability_scanning: OK policies/fintech/pci_vulnerability_scanning/policy.rego, OK policies/fintech/pci_vulnerability_scanning/policy_test.rego <code>Crypto / VASP</code> Virtual asset service provider controls fintech.bitlicense_compliance, fintech.chain_analysis_risk_controls, fintech.cold_storage_ratio, fintech.custody_asset_segregation, fintech.hot_wallet_limits, fintech.proof_of_reserves_reporting, fintech.stablecoin_reserve_ratio, fintech.travel_rule_compliance, fintech.vasp_license_required, fintech.withdrawal_address_whitelist OK fintech.bitlicense_compliance: OK policies/fintech/bitlicense_compliance/policy.rego, OK policies/fintech/bitlicense_compliance/policy_test.rego; fintech.chain_analysis_risk_controls: OK policies/fintech/chain_analysis_risk_controls/policy.rego, OK policies/fintech/chain_analysis_risk_controls/policy_test.rego; fintech.cold_storage_ratio: OK policies/fintech/cold_storage_ratio/policy.rego, OK policies/fintech/cold_storage_ratio/policy_test.rego; fintech.custody_asset_segregation: OK policies/fintech/custody_asset_segregation/policy.rego, OK policies/fintech/custody_asset_segregation/policy_test.rego; fintech.hot_wallet_limits: OK policies/fintech/hot_wallet_limits/policy.rego, OK policies/fintech/hot_wallet_limits/policy_test.rego; fintech.proof_of_reserves_reporting: OK policies/fintech/proof_of_reserves_reporting/policy.rego, OK policies/fintech/proof_of_reserves_reporting/policy_test.rego; fintech.stablecoin_reserve_ratio: OK policies/fintech/stablecoin_reserve_ratio/policy.rego, OK policies/fintech/stablecoin_reserve_ratio/policy_test.rego; fintech.travel_rule_compliance: OK policies/fintech/travel_rule_compliance/policy.rego, OK policies/fintech/travel_rule_compliance/policy_test.rego; fintech.vasp_license_required: OK policies/fintech/vasp_license_required/policy.rego, OK policies/fintech/vasp_license_required/policy_test.rego; fintech.withdrawal_address_whitelist: OK policies/fintech/withdrawal_address_whitelist/policy.rego, OK policies/fintech/withdrawal_address_whitelist/policy_test.rego <code>Fraud &amp; Commerce</code> Fraud prevention and payments hygiene fintech.card_tokenization_required, fintech.chargeback_monitoring, fintech.device_fingerprinting, fintech.fraud_velocity_checks, fintech.geofencing_restricted_markets, fintech.ip_geolocation_consistency, fintech.mcc_whitelisting, fintech.pan_masking_in_logs, fintech.transaction_limits_per_risk OK fintech.card_tokenization_required: OK policies/fintech/card_tokenization_required/policy.rego, OK policies/fintech/card_tokenization_required/policy_test.rego; fintech.chargeback_monitoring: OK policies/fintech/chargeback_monitoring/policy.rego, OK policies/fintech/chargeback_monitoring/policy_test.rego; fintech.device_fingerprinting: OK policies/fintech/device_fingerprinting/policy.rego, OK policies/fintech/device_fingerprinting/policy_test.rego; fintech.fraud_velocity_checks: OK policies/fintech/fraud_velocity_checks/policy.rego, OK policies/fintech/fraud_velocity_checks/policy_test.rego; fintech.geofencing_restricted_markets: OK policies/fintech/geofencing_restricted_markets/policy.rego, OK policies/fintech/geofencing_restricted_markets/policy_test.rego; fintech.ip_geolocation_consistency: OK policies/fintech/ip_geolocation_consistency/policy.rego, OK policies/fintech/ip_geolocation_consistency/policy_test.rego; fintech.mcc_whitelisting: OK policies/fintech/mcc_whitelisting/policy.rego, OK policies/fintech/mcc_whitelisting/policy_test.rego; fintech.pan_masking_in_logs: OK policies/fintech/pan_masking_in_logs/policy.rego, OK policies/fintech/pan_masking_in_logs/policy_test.rego; fintech.transaction_limits_per_risk: OK policies/fintech/transaction_limits_per_risk/policy.rego, OK policies/fintech/transaction_limits_per_risk/policy_test.rego <p>Coverage: 69/69 (100%)</p>"},{"location":"coverage/#us-finreg-mtl","title":"US FinReg MTL","text":"Section Title Policies Coverage Paths <code>State MTL</code> Money Transmitter Licenses fintech.us_mtl_license OK fintech.us_mtl_license: OK policies/fintech/us_mtl_license/policy.rego, OK policies/fintech/us_mtl_license/policy_test.rego <p>Coverage: 1/1 (100%)</p>"},{"location":"coverage/#gdpr-2016679","title":"GDPR 2016/679","text":"Section Title Policies Coverage Paths <code>Art.5(1)(c)</code> Data minimization gdpr.data_minimization OK gdpr.data_minimization: OK policies/gdpr/data_minimization/policy.rego, OK policies/gdpr/data_minimization/policy_test.rego <code>Art.5(1)(e)</code> Storage limitation gdpr.data_retention OK gdpr.data_retention: OK policies/gdpr/data_retention/policy.rego, OK policies/gdpr/data_retention/policy_test.rego <code>Art.6</code> Lawfulness of processing gdpr.consent_required OK gdpr.consent_required: OK policies/gdpr/consent_required/policy.rego, OK policies/gdpr/consent_required/policy_test.rego <p>Coverage: 3/3 (100%)</p>"},{"location":"coverage/#igaming-multi-jurisdiction-current","title":"iGaming (multi-jurisdiction) current","text":"Section Title Policies Coverage Paths <code>Licensing</code> Licensing checks (per regulator) igaming.license_check_adm_it, igaming.license_check_anj_fr, igaming.license_check_dgoj_es, igaming.license_check_ukgc, igaming.license_check_us_nj_dge, igaming.license_check_us_nv_ngcb, igaming.license_check_us_pa_pgcb OK igaming.license_check_adm_it: OK policies/igaming/license_check_adm_it/policy.rego, OK policies/igaming/license_check_adm_it/policy_test.rego; igaming.license_check_anj_fr: OK policies/igaming/license_check_anj_fr/policy.rego, OK policies/igaming/license_check_anj_fr/policy_test.rego; igaming.license_check_dgoj_es: OK policies/igaming/license_check_dgoj_es/policy.rego, OK policies/igaming/license_check_dgoj_es/policy_test.rego; igaming.license_check_ukgc: OK policies/igaming/license_check_ukgc/policy.rego, OK policies/igaming/license_check_ukgc/policy_test.rego; igaming.license_check_us_nj_dge: OK policies/igaming/license_check_us_nj_dge/policy.rego, OK policies/igaming/license_check_us_nj_dge/policy_test.rego; igaming.license_check_us_nv_ngcb: OK policies/igaming/license_check_us_nv_ngcb/policy.rego, OK policies/igaming/license_check_us_nv_ngcb/policy_test.rego; igaming.license_check_us_pa_pgcb: OK policies/igaming/license_check_us_pa_pgcb/policy.rego, OK policies/igaming/license_check_us_pa_pgcb/policy_test.rego <code>Player Protection</code> Responsible gambling controls igaming.deposit_limit_controls, igaming.self_exclusion_uk_gamstop OK igaming.deposit_limit_controls: OK policies/igaming/deposit_limit_controls/policy.rego, OK policies/igaming/deposit_limit_controls/policy_test.rego; igaming.self_exclusion_uk_gamstop: OK policies/igaming/self_exclusion_uk_gamstop/policy.rego, OK policies/igaming/self_exclusion_uk_gamstop/policy_test.rego <code>Market Access &amp; Geo</code> Regulated market geofencing igaming.geofencing_regulated_markets OK igaming.geofencing_regulated_markets: OK policies/igaming/geofencing_regulated_markets/policy.rego, OK policies/igaming/geofencing_regulated_markets/policy_test.rego <p>Coverage: 10/10 (100%)</p>"},{"location":"coverage/#kubernetes-security-baseline-v1","title":"Kubernetes Security Baseline v1","text":"Section Title Policies Coverage Paths <code>Workload hardening</code> Restrict privileged escalation and root k8s.no_privileged, k8s.no_run_as_root, k8s.limit_capabilities, k8s.ban_hostnetwork, k8s.block_hostpath OK k8s.no_privileged: OK addons/kyverno/policies/no-privileged.yaml, OK policies/k8s/no_privileged/policy.rego, OK policies/k8s/no_privileged/policy_test.rego; k8s.no_run_as_root: OK addons/k8s-gatekeeper/templates/no-run-as-root.yaml, OK policies/k8s/no_run_as_root/policy.rego, OK policies/k8s/no_run_as_root/policy_test.rego; k8s.limit_capabilities: OK addons/k8s-gatekeeper/templates/limit-capabilities.yaml, OK policies/k8s/limit_capabilities/policy.rego, OK policies/k8s/limit_capabilities/policy_test.rego; k8s.ban_hostnetwork: OK addons/k8s-gatekeeper/templates/ban-hostnetwork.yaml, OK addons/k8s-gatekeeper/constraints/ban-hostnetwork.yaml, OK policies/k8s/ban_hostnetwork/policy.rego, OK policies/k8s/ban_hostnetwork/policy_test.rego; k8s.block_hostpath: OK addons/kyverno/policies/block-hostpath.yaml, OK policies/k8s/block_hostpath/policy.rego, OK policies/k8s/block_hostpath/policy_test.rego <code>Image &amp; supply chain</code> Avoid mutable tags and ensure fresh images k8s.disallow_latest, k8s.require_imagepullpolicy_always OK k8s.disallow_latest: OK addons/kyverno/policies/disallow-latest.yaml, OK policies/k8s/disallow_latest/policy.rego, OK policies/k8s/disallow_latest/policy_test.rego; k8s.require_imagepullpolicy_always: OK addons/k8s-gatekeeper/templates/require-imagepullpolicy-always.yaml, OK policies/k8s/require_imagepullpolicy_always/policy.rego, OK policies/k8s/require_imagepullpolicy_always/policy_test.rego <code>Resource governance</code> Enforce resource requests and limits k8s.require_resources OK k8s.require_resources: OK addons/kyverno/policies/require-resources.yaml, OK policies/k8s/require_resources/policy.rego, OK policies/k8s/require_resources/policy_test.rego <p>Coverage: 8/8 (100%)</p>"},{"location":"coverage/#legaltech-multi-jurisdiction-current","title":"LegalTech (multi-jurisdiction) current","text":"Section Title Policies Coverage Paths <code>GDPR Core</code> GDPR principles and data subject rights legaltech.gdpr_breach_72h, legaltech.gdpr_consent_valid, legaltech.gdpr_cookie_consent_eprivacy, legaltech.gdpr_data_minimization, legaltech.gdpr_dpia_required_high_risk, legaltech.gdpr_dsar_timeline_30d, legaltech.gdpr_lawful_basis_required, legaltech.gdpr_records_of_processing, legaltech.gdpr_retention_limit, legaltech.gdpr_transfer_scc OK legaltech.gdpr_breach_72h: OK policies/legaltech/gdpr_breach_72h/policy.rego, OK policies/legaltech/gdpr_breach_72h/policy_test.rego; legaltech.gdpr_consent_valid: OK policies/legaltech/gdpr_consent_valid/policy.rego, OK policies/legaltech/gdpr_consent_valid/policy_test.rego; legaltech.gdpr_cookie_consent_eprivacy: OK policies/legaltech/gdpr_cookie_consent_eprivacy/policy.rego, OK policies/legaltech/gdpr_cookie_consent_eprivacy/policy_test.rego; legaltech.gdpr_data_minimization: OK policies/legaltech/gdpr_data_minimization/policy.rego, OK policies/legaltech/gdpr_data_minimization/policy_test.rego; legaltech.gdpr_dpia_required_high_risk: OK policies/legaltech/gdpr_dpia_required_high_risk/policy.rego, OK policies/legaltech/gdpr_dpia_required_high_risk/policy_test.rego; legaltech.gdpr_dsar_timeline_30d: OK policies/legaltech/gdpr_dsar_timeline_30d/policy.rego, OK policies/legaltech/gdpr_dsar_timeline_30d/policy_test.rego; legaltech.gdpr_lawful_basis_required: OK policies/legaltech/gdpr_lawful_basis_required/policy.rego, OK policies/legaltech/gdpr_lawful_basis_required/policy_test.rego; legaltech.gdpr_records_of_processing: OK policies/legaltech/gdpr_records_of_processing/policy.rego, OK policies/legaltech/gdpr_records_of_processing/policy_test.rego; legaltech.gdpr_retention_limit: OK policies/legaltech/gdpr_retention_limit/policy.rego, OK policies/legaltech/gdpr_retention_limit/policy_test.rego; legaltech.gdpr_transfer_scc: OK policies/legaltech/gdpr_transfer_scc/policy.rego, OK policies/legaltech/gdpr_transfer_scc/policy_test.rego <code>US (CCPA/CPRA)</code> California privacy (CCPA/CPRA) legaltech.ccpa_notice_at_collection, legaltech.ccpa_opt_out_enabled, legaltech.ccpa_verification_of_requests, legaltech.cpra_sensitive_data_limited_use OK legaltech.ccpa_notice_at_collection: OK policies/legaltech/ccpa_notice_at_collection/policy.rego, OK policies/legaltech/ccpa_notice_at_collection/policy_test.rego; legaltech.ccpa_opt_out_enabled: OK policies/legaltech/ccpa_opt_out_enabled/policy.rego, OK policies/legaltech/ccpa_opt_out_enabled/policy_test.rego; legaltech.ccpa_verification_of_requests: OK policies/legaltech/ccpa_verification_of_requests/policy.rego, OK policies/legaltech/ccpa_verification_of_requests/policy_test.rego; legaltech.cpra_sensitive_data_limited_use: OK policies/legaltech/cpra_sensitive_data_limited_use/policy.rego, OK policies/legaltech/cpra_sensitive_data_limited_use/policy_test.rego <code>Security Controls</code> Technical and organizational measures legaltech.data_residency_requirements_enforced, legaltech.encryption_at_rest_enabled, legaltech.encryption_in_transit_enabled, legaltech.popia_za_security_measures OK legaltech.data_residency_requirements_enforced: OK policies/legaltech/data_residency_requirements_enforced/policy.rego, OK policies/legaltech/data_residency_requirements_enforced/policy_test.rego; legaltech.encryption_at_rest_enabled: OK policies/legaltech/encryption_at_rest_enabled/policy.rego, OK policies/legaltech/encryption_at_rest_enabled/policy_test.rego; legaltech.encryption_in_transit_enabled: OK policies/legaltech/encryption_in_transit_enabled/policy.rego, OK policies/legaltech/encryption_in_transit_enabled/policy_test.rego; legaltech.popia_za_security_measures: OK policies/legaltech/popia_za_security_measures/policy.rego, OK policies/legaltech/popia_za_security_measures/policy_test.rego <code>Records &amp; eDiscovery</code> Records governance and eDiscovery legaltech.ch_fadp_records_of_processing, legaltech.ediscovery_frcp_26_34_37, legaltech.legal_hold_no_delete_enforced, legaltech.records_classification_scheme_applied OK legaltech.ch_fadp_records_of_processing: OK policies/legaltech/ch_fadp_records_of_processing/policy.rego, OK policies/legaltech/ch_fadp_records_of_processing/policy_test.rego; legaltech.ediscovery_frcp_26_34_37: OK policies/legaltech/ediscovery_frcp_26_34_37/policy.rego, OK policies/legaltech/ediscovery_frcp_26_34_37/policy_test.rego; legaltech.legal_hold_no_delete_enforced: OK policies/legaltech/legal_hold_no_delete_enforced/policy.rego, OK policies/legaltech/legal_hold_no_delete_enforced/policy_test.rego; legaltech.records_classification_scheme_applied: OK policies/legaltech/records_classification_scheme_applied/policy.rego, OK policies/legaltech/records_classification_scheme_applied/policy_test.rego <code>Cross-border Transfers</code> International data transfers legaltech.id_pdp_cross_border_transfer, legaltech.pipl_cn_cross_border_assessment OK legaltech.id_pdp_cross_border_transfer: OK policies/legaltech/id_pdp_cross_border_transfer/policy.rego, OK policies/legaltech/id_pdp_cross_border_transfer/policy_test.rego; legaltech.pipl_cn_cross_border_assessment: OK policies/legaltech/pipl_cn_cross_border_assessment/policy.rego, OK policies/legaltech/pipl_cn_cross_border_assessment/policy_test.rego <code>Children &amp; Minors</code> Child-specific consent and protections legaltech.uk_gdpr_minor_consent OK legaltech.uk_gdpr_minor_consent: OK policies/legaltech/uk_gdpr_minor_consent/policy.rego, OK policies/legaltech/uk_gdpr_minor_consent/policy_test.rego <code>Country-specific</code> National privacy laws legaltech.ca_qc_law25_privacy_governance, legaltech.au_app_notice_at_collection, legaltech.ae_pdpl_consent_notice, legaltech.kr_pipa_breach_notification, legaltech.lgpd_brazil_compliance, legaltech.mx_lfpdppp_notice_at_collection, legaltech.my_pdpa_retention_principle, legaltech.nz_breach_notification, legaltech.pdpa_sg_consent_purposes, legaltech.pipeda_ca_consent, legaltech.sa_pdpl_breach_notify, legaltech.th_pdpa_breach_notify, legaltech.tr_kvkk_verbis_registration, legaltech.vn_pdpd_notice_and_consent OK legaltech.ca_qc_law25_privacy_governance: OK policies/legaltech/ca_qc_law25_privacy_governance/policy.rego, OK policies/legaltech/ca_qc_law25_privacy_governance/policy_test.rego; legaltech.au_app_notice_at_collection: OK policies/legaltech/au_app_notice_at_collection/policy.rego, OK policies/legaltech/au_app_notice_at_collection/policy_test.rego; legaltech.ae_pdpl_consent_notice: OK policies/legaltech/ae_pdpl_consent_notice/policy.rego, OK policies/legaltech/ae_pdpl_consent_notice/policy_test.rego; legaltech.kr_pipa_breach_notification: OK policies/legaltech/kr_pipa_breach_notification/policy.rego, OK policies/legaltech/kr_pipa_breach_notification/policy_test.rego; legaltech.lgpd_brazil_compliance: OK policies/legaltech/lgpd_brazil_compliance/policy.rego, OK policies/legaltech/lgpd_brazil_compliance/policy_test.rego; legaltech.mx_lfpdppp_notice_at_collection: OK policies/legaltech/mx_lfpdppp_notice_at_collection/policy.rego, OK policies/legaltech/mx_lfpdppp_notice_at_collection/policy_test.rego; legaltech.my_pdpa_retention_principle: OK policies/legaltech/my_pdpa_retention_principle/policy.rego, OK policies/legaltech/my_pdpa_retention_principle/policy_test.rego; legaltech.nz_breach_notification: OK policies/legaltech/nz_breach_notification/policy.rego, OK policies/legaltech/nz_breach_notification/policy_test.rego; legaltech.pdpa_sg_consent_purposes: OK policies/legaltech/pdpa_sg_consent_purposes/policy.rego, OK policies/legaltech/pdpa_sg_consent_purposes/policy_test.rego; legaltech.pipeda_ca_consent: OK policies/legaltech/pipeda_ca_consent/policy.rego, OK policies/legaltech/pipeda_ca_consent/policy_test.rego; legaltech.sa_pdpl_breach_notify: OK policies/legaltech/sa_pdpl_breach_notify/policy.rego, OK policies/legaltech/sa_pdpl_breach_notify/policy_test.rego; legaltech.th_pdpa_breach_notify: OK policies/legaltech/th_pdpa_breach_notify/policy.rego, OK policies/legaltech/th_pdpa_breach_notify/policy_test.rego; legaltech.tr_kvkk_verbis_registration: OK policies/legaltech/tr_kvkk_verbis_registration/policy.rego, OK policies/legaltech/tr_kvkk_verbis_registration/policy_test.rego; legaltech.vn_pdpd_notice_and_consent: OK policies/legaltech/vn_pdpd_notice_and_consent/policy.rego, OK policies/legaltech/vn_pdpd_notice_and_consent/policy_test.rego <code>Professional Conduct</code> Legal ethics and confidentiality legaltech.aba_model_rule_1_6_confidentiality OK legaltech.aba_model_rule_1_6_confidentiality: OK policies/legaltech/aba_model_rule_1_6_confidentiality/policy.rego, OK policies/legaltech/aba_model_rule_1_6_confidentiality/policy_test.rego <p>Coverage: 40/40 (100%)</p>"},{"location":"coverage/#medtech-multi-jurisdiction-current","title":"MedTech (multi-jurisdiction) current","text":"Section Title Policies Coverage Paths <code>HIPAA (US)</code> HIPAA Security, Privacy, and Administrative Safeguards medtech.hipaa_access_audit_logging, medtech.hipaa_baa_with_vendors, medtech.hipaa_mfa_privileged_access, medtech.hipaa_minimum_necessary, medtech.hipaa_security_admin_safeguards, medtech.hipaa_security_tech_encryption OK medtech.hipaa_access_audit_logging: OK policies/medtech/hipaa_access_audit_logging/policy.rego, OK policies/medtech/hipaa_access_audit_logging/policy_test.rego; medtech.hipaa_baa_with_vendors: OK policies/medtech/hipaa_baa_with_vendors/policy.rego, OK policies/medtech/hipaa_baa_with_vendors/policy_test.rego; medtech.hipaa_mfa_privileged_access: OK policies/medtech/hipaa_mfa_privileged_access/policy.rego, OK policies/medtech/hipaa_mfa_privileged_access/policy_test.rego; medtech.hipaa_minimum_necessary: OK policies/medtech/hipaa_minimum_necessary/policy.rego, OK policies/medtech/hipaa_minimum_necessary/policy_test.rego; medtech.hipaa_security_admin_safeguards: OK policies/medtech/hipaa_security_admin_safeguards/policy.rego, OK policies/medtech/hipaa_security_admin_safeguards/policy_test.rego; medtech.hipaa_security_tech_encryption: OK policies/medtech/hipaa_security_tech_encryption/policy.rego, OK policies/medtech/hipaa_security_tech_encryption/policy_test.rego <code>HITECH (US)</code> HITECH Act Requirements medtech.hitech_breach_notification_60d OK medtech.hitech_breach_notification_60d: OK policies/medtech/hitech_breach_notification_60d/policy.rego, OK policies/medtech/hitech_breach_notification_60d/policy_test.rego <code>FDA (US) \u2014 Part 11 and MDR</code> FDA 21 CFR Part 11 and Medical Device Reporting (MDR) medtech.fda_cybersecurity_524b_sbom, medtech.fda_mdr_event_reporting, medtech.fda_part11_audit_trail, medtech.fda_part11_esign_linkage, medtech.fda_part11_system_validation OK medtech.fda_cybersecurity_524b_sbom: OK policies/medtech/fda_cybersecurity_524b_sbom/policy.rego, OK policies/medtech/fda_cybersecurity_524b_sbom/policy_test.rego; medtech.fda_mdr_event_reporting: OK policies/medtech/fda_mdr_event_reporting/policy.rego, OK policies/medtech/fda_mdr_event_reporting/policy_test.rego; medtech.fda_part11_audit_trail: OK policies/medtech/fda_part11_audit_trail/policy.rego, OK policies/medtech/fda_part11_audit_trail/policy_test.rego; medtech.fda_part11_esign_linkage: OK policies/medtech/fda_part11_esign_linkage/policy.rego, OK policies/medtech/fda_part11_esign_linkage/policy_test.rego; medtech.fda_part11_system_validation: OK policies/medtech/fda_part11_system_validation/policy.rego, OK policies/medtech/fda_part11_system_validation/policy_test.rego <code>EU MDR/IVDR (EU)</code> EU Medical Device and IVD Regulations medtech.eu_ivdr_clinical_performance, medtech.eu_mdr_ce_marking_and_udi, medtech.eu_mdr_clinical_evaluation, medtech.eu_mdr_eudamed_registration, medtech.eu_mdr_pms_psur, medtech.eu_vigilance_incident_reporting OK medtech.eu_ivdr_clinical_performance: OK policies/medtech/eu_ivdr_clinical_performance/policy.rego, OK policies/medtech/eu_ivdr_clinical_performance/policy_test.rego; medtech.eu_mdr_ce_marking_and_udi: OK policies/medtech/eu_mdr_ce_marking_and_udi/policy.rego, OK policies/medtech/eu_mdr_ce_marking_and_udi/policy_test.rego; medtech.eu_mdr_clinical_evaluation: OK policies/medtech/eu_mdr_clinical_evaluation/policy.rego, OK policies/medtech/eu_mdr_clinical_evaluation/policy_test.rego; medtech.eu_mdr_eudamed_registration: OK policies/medtech/eu_mdr_eudamed_registration/policy.rego, OK policies/medtech/eu_mdr_eudamed_registration/policy_test.rego; medtech.eu_mdr_pms_psur: OK policies/medtech/eu_mdr_pms_psur/policy.rego, OK policies/medtech/eu_mdr_pms_psur/policy_test.rego; medtech.eu_vigilance_incident_reporting: OK policies/medtech/eu_vigilance_incident_reporting/policy.rego, OK policies/medtech/eu_vigilance_incident_reporting/policy_test.rego <code>ONC (US)</code> 21st Century Cures (ONC) and Information Blocking medtech.onc_cures_api_fhir_r4, medtech.onc_information_blocking_prohibited OK medtech.onc_cures_api_fhir_r4: OK policies/medtech/onc_cures_api_fhir_r4/policy.rego, OK policies/medtech/onc_cures_api_fhir_r4/policy_test.rego; medtech.onc_information_blocking_prohibited: OK policies/medtech/onc_information_blocking_prohibited/policy.rego, OK policies/medtech/onc_information_blocking_prohibited/policy_test.rego <code>Data Protection &amp; Cross-border</code> GDPR Article 9 and Cross-border Transfers medtech.gdpr_art9_special_category_safeguards, medtech.health_data_cross_border_controls OK medtech.gdpr_art9_special_category_safeguards: OK policies/medtech/gdpr_art9_special_category_safeguards/policy.rego, OK policies/medtech/gdpr_art9_special_category_safeguards/policy_test.rego; medtech.health_data_cross_border_controls: OK policies/medtech/health_data_cross_border_controls/policy.rego, OK policies/medtech/health_data_cross_border_controls/policy_test.rego <code>Standards (ISO/IEC)</code> ISO/IEC QMS, Risk, Software Lifecycle, Usability, ISMS medtech.iec_62304_scm_prp_processes, medtech.iec_62304_software_safety_class, medtech.iec_62366_usability_summative_eval, medtech.iso_13485_document_control, medtech.iso_14971_risk_management_file, medtech.iso_27001_isms_scope_and_controls OK medtech.iec_62304_scm_prp_processes: OK policies/medtech/iec_62304_scm_prp_processes/policy.rego, OK policies/medtech/iec_62304_scm_prp_processes/policy_test.rego; medtech.iec_62304_software_safety_class: OK policies/medtech/iec_62304_software_safety_class/policy.rego, OK policies/medtech/iec_62304_software_safety_class/policy_test.rego; medtech.iec_62366_usability_summative_eval: OK policies/medtech/iec_62366_usability_summative_eval/policy.rego, OK policies/medtech/iec_62366_usability_summative_eval/policy_test.rego; medtech.iso_13485_document_control: OK policies/medtech/iso_13485_document_control/policy.rego, OK policies/medtech/iso_13485_document_control/policy_test.rego; medtech.iso_14971_risk_management_file: OK policies/medtech/iso_14971_risk_management_file/policy.rego, OK policies/medtech/iso_14971_risk_management_file/policy_test.rego; medtech.iso_27001_isms_scope_and_controls: OK policies/medtech/iso_27001_isms_scope_and_controls/policy.rego, OK policies/medtech/iso_27001_isms_scope_and_controls/policy_test.rego <code>Technical &amp; Operational Controls</code> Operational and Technical Controls medtech.backup_and_recovery_rto_rpo, medtech.device_data_integrity_hashing, medtech.dicom_network_security_basic, medtech.fhir_smart_app_authz, medtech.log_retention_for_clinical_events OK medtech.backup_and_recovery_rto_rpo: OK policies/medtech/backup_and_recovery_rto_rpo/policy.rego, OK policies/medtech/backup_and_recovery_rto_rpo/policy_test.rego; medtech.device_data_integrity_hashing: OK policies/medtech/device_data_integrity_hashing/policy.rego, OK policies/medtech/device_data_integrity_hashing/policy_test.rego; medtech.dicom_network_security_basic: OK policies/medtech/dicom_network_security_basic/policy.rego, OK policies/medtech/dicom_network_security_basic/policy_test.rego; medtech.fhir_smart_app_authz: OK policies/medtech/fhir_smart_app_authz/policy.rego, OK policies/medtech/fhir_smart_app_authz/policy_test.rego; medtech.log_retention_for_clinical_events: OK policies/medtech/log_retention_for_clinical_events/policy.rego, OK policies/medtech/log_retention_for_clinical_events/policy_test.rego <code>Country/Region-specific</code> National and Regional Healthcare Regulations medtech.au_myr_health_privacy, medtech.ca_phipa_health_data, medtech.sg_hcsa_pdpa_health_data, medtech.uk_dtac_compliance, medtech.uk_mhra_post_market_surveillance OK medtech.au_myr_health_privacy: OK policies/medtech/au_myr_health_privacy/policy.rego, OK policies/medtech/au_myr_health_privacy/policy_test.rego; medtech.ca_phipa_health_data: OK policies/medtech/ca_phipa_health_data/policy.rego, OK policies/medtech/ca_phipa_health_data/policy_test.rego; medtech.sg_hcsa_pdpa_health_data: OK policies/medtech/sg_hcsa_pdpa_health_data/policy.rego, OK policies/medtech/sg_hcsa_pdpa_health_data/policy_test.rego; medtech.uk_dtac_compliance: OK policies/medtech/uk_dtac_compliance/policy.rego, OK policies/medtech/uk_dtac_compliance/policy_test.rego; medtech.uk_mhra_post_market_surveillance: OK policies/medtech/uk_mhra_post_market_surveillance/policy.rego, OK policies/medtech/uk_mhra_post_market_surveillance/policy_test.rego <p>Coverage: 38/38 (100%)</p>"},{"location":"coverage/#pci-dss-40","title":"PCI DSS 4.0","text":"Section Title Policies Coverage Paths <code>3.4</code> Protect stored cardholder data pci.ebs_encryption, pci.storage_encryption OK pci.ebs_encryption: OK policies/pci/ebs_encryption/policy.rego, OK policies/pci/ebs_encryption/policy_test.rego; pci.storage_encryption: OK policies/pci/storage_encryption/policy.rego, OK policies/pci/storage_encryption/policy_test.rego <code>4.2</code> Use strong cryptography for transmission pci.https_only OK pci.https_only: OK policies/pci/https_only/policy.rego, OK policies/pci/https_only/policy_test.rego <code>8.2</code> Strong authentication pci.iam_password_policy OK pci.iam_password_policy: OK policies/pci/iam_password_policy/policy.rego, OK policies/pci/iam_password_policy/policy_test.rego <code>10.2</code> Logging &amp; monitoring pci.logging_enabled OK pci.logging_enabled: OK policies/pci/logging_enabled/policy.rego, OK policies/pci/logging_enabled/policy_test.rego <code>12.10</code> Incident response monitoring WARN <p>Coverage: 5/5 (100%)</p>"},{"location":"coverage/#au-igaming-hosting-placeholder","title":"AU iGaming Hosting placeholder","text":"Section Title Policies Coverage Paths <code>Audit</code> Audit trails &amp; secure hosting rg.au_audit_trails OK rg.au_audit_trails: OK policies/rg/au_audit_trails/policy.rego, OK policies/rg/au_audit_trails/policy_test.rego <p>Coverage: 1/1 (100%)</p>"},{"location":"coverage/#ukgcmga-placeholder","title":"UKGC/MGA placeholder","text":"Section Title Policies Coverage Paths <code>RG-1</code> Self-exclusion controls rg.self_exclusion_enforced OK rg.self_exclusion_enforced: OK policies/rg/self_exclusion_enforced/policy.rego, OK policies/rg/self_exclusion_enforced/policy_test.rego <p>Coverage: 1/1 (100%)</p>"},{"location":"coverage/#uigea-31-usc-5361","title":"UIGEA 31 USC 5361","text":"Section Title Policies Coverage Paths <code>Payments</code> Payment blocks for unlawful internet gambling rg.uigea_payment_blocks OK rg.uigea_payment_blocks: OK policies/rg/uigea_payment_blocks/policy.rego, OK policies/rg/uigea_payment_blocks/policy_test.rego <p>Coverage: 1/1 (100%)</p>"},{"location":"coverage/#policy-test-coverage-gatekeeper-rego","title":"Policy Test Coverage (Gatekeeper Rego)","text":"<p>Policies with tests: 283/283 (100.0%)</p>"},{"location":"documentation-index/","title":"Documentation index","text":"<p>This page is a lightweight entrypoint for the docs site (kept in <code>docs/</code> to avoid conflicts with the repository root <code>README.md</code>).</p> <p>Key guides</p> <ul> <li>Getting started: <code>getting-started.md</code></li> <li>Policy architecture: <code>policy-architecture.md</code></li> <li>Compliance maps: <code>compliance-maps.md</code></li> <li>Kubernetes policies: <code>k8s-policies.md</code></li> <li>Coverage report (generated): <code>coverage.md</code></li> <li>Security &amp; provenance: <code>security-provenance.md</code></li> </ul> <p>Developer &amp; contribution links</p> <ul> <li>Contribution guide: <code>../CONTRIBUTING.md</code></li> <li>Code of Conduct: <code>../CODE_OF_CONDUCT.md</code></li> <li>Security: <code>../SECURITY.md</code></li> </ul> <p>How this page is used</p> <ul> <li>Placed under <code>Extras</code> in the site navigation so it is discoverable from the docs site without conflicting with <code>index.md</code>.</li> <li>If you want this content to replace the repo root <code>README.md</code>, move or copy it to the repository root.</li> </ul> <p>For more detailed instructions and references, use the main navigation on the left of the site.</p>"},{"location":"editorial-checklist/","title":"Editorial Documentation Review Checklist","text":"<p>Purpose: provide a consistent, lightweight manual review pass before merging or releasing documentation changes. Use this list as a gate in PRs touching files under <code>docs/</code>, top-level Markdown, or policy metadata notes.</p> <p>Tip: Mark each item PASS / FAIL (and fix) in the PR review comment. Automatable items should migrate into tooling (lint, tests, guards) over time.</p>"},{"location":"editorial-checklist/#quick-summary-10-core-checks","title":"Quick Summary (10 Core Checks)","text":"<ol> <li>Grammar &amp; Clarity OK</li> <li>Terminology Consistent (canonical terms)</li> <li>Heading Style &amp; Hierarchy Valid</li> <li>Links Valid / Secure (https) &amp; Descriptive</li> <li>Make Target Names Accurate &amp; Current</li> <li>Includes Verification / Repro Steps (where procedural)</li> <li>Code / Command Blocks Tested or Example\u2011Tagged</li> <li>Consistent Formatting (lists, tables, admonitions)</li> <li>Security / Integrity Notes Present (when referencing artifacts)</li> <li>No Stale References (removed files, old versions, placeholder titles)</li> </ol>"},{"location":"editorial-checklist/#detailed-checklist-table","title":"Detailed Checklist (Table)","text":"Category Check How to Verify Fail Criteria Notes / Aids Grammar &amp; Style Concise; no typos Read aloud / tool Run\u2011ons; untranslated text Active voice; &lt;=25 words Terminology Canonical names used Search variants Mixed casing / synonyms Add terms to cspell Heading Hierarchy Single H1; no jumps Inspect TOC Skipped levels / duplicate Action nouns Titles &amp; Slugs Title matches nav entry Compare nav Duplicate / mismatch Use front\u2011matter override Links External links are https Grep <code>http://</code> Insecure / \"here\" text Prefer relative internal links Link Freshness Internal targets exist Click locally 404 / removed Avoid deep GitHub blob URLs Make Targets Referenced targets exist Grep Makefile Typos / obsolete Backticks around targets Verification Steps Cmds + expected output Scan fenced blocks Missing reproducible steps Tag <code># example-test</code> Integrity / Security Mention verification steps Search keywords No verify/hash guidance Link integrity doc Code &amp; Examples Shell blocks safe (no destructive ops) Review blocks Unsafe commands Add caution comments Example Testability Runnable examples tagged Look for tag Eligible block untagged Exclude network heavy examples Formatting Consistency Uniform list markers / fences Visual scan Mixed markers / fence styles Use ```bash Admonitions Use Material admonitions Look for <code>!!!</code> Plain NOTE text Convert gradually Placeholders No <code>&lt;Policy Title&gt;</code> or TBD Search repo Placeholder remains Replace or remove Localization Non\u2011English only where intentional Grep Cyrillic Untranslated stray text Provide English primary Accessibility Images alt text; table headers Inspect Missing alt/header Add concise alt text Length &amp; Focus Not overly long without sections Check lines Huge monolith Split page Metadata Alignment Claims match actual features Cross\u2011check scripts Outdated claims Future: mark Planned Version References Use vX.Y.Z placeholders Scan examples Stale fixed version Update during release Release Guidance Link audit &amp; integrity steps present Skim release docs Missing step Insert before publish Risk Statements External download risk noted Scan for downloads Missing risk note Reference supply chain verify"},{"location":"editorial-checklist/#review-flow-suggested","title":"Review Flow (Suggested)","text":"<ol> <li>Run automated guardrails: <code>make guardrails docs-lint link-audit</code>.</li> <li>Open <code>mkdocs.yml</code>; confirm any new file is added intentionally (or intentionally excluded).</li> <li>Apply Quick Summary checks (10 items). Fix blocking issues immediately.</li> <li>Perform Detailed Checklist pass; record FAIL items in PR review comment.</li> <li>For any FAIL that is automatable, open a follow-up issue to codify (reduce manual burden).</li> <li>Re-run <code>make docs-build</code> to ensure site builds successfully and search index updates.</li> </ol>"},{"location":"editorial-checklist/#pass-fail-template-copy-into-pr-review","title":"PASS / FAIL Template (Copy into PR Review)","text":"<pre><code>Editorial Review Summary\nDate: &lt;YYYY-MM-DD&gt;\nReviewer: &lt;name&gt;\n\nQuick Core Checks: [ ] Grammar [ ] Terminology [ ] Headings [ ] Links [ ] Targets [ ] Verification Steps [ ] Examples [ ] Formatting [ ] Integrity Notes [ ] No Stale Refs\n\nDetailed Fails (category -&gt; issue -&gt; action):\n- &lt;Category&gt;: &lt;Issue&gt; -&gt; &lt;Action&gt;\n\nAutomation Opportunities:\n- &lt;Proposed lint or guardrail&gt;\n\nOverall Status: PASS / FAIL (needs fixes)\n</code></pre>"},{"location":"editorial-checklist/#future-automation-candidates","title":"Future Automation Candidates","text":"<ul> <li>Heading level jump detection (markdownlint rule customization).</li> <li>Internal link existence checker (relative path resolution) integrated into <code>docs-lint</code>.</li> <li>Placeholder / TBD scanner integrated into guardrails.</li> <li>Example harness index (<code>docs/examples.index</code>) to selectively execute code snippets.</li> <li>Accessibility scan (alt text &amp; heading uniqueness) script.</li> </ul> <p>Maintained: update when new guardrails or doc conventions are introduced.</p>"},{"location":"getting-started/","title":"Getting Started","text":"<p>This guide shows how to install dependencies, generate coverage, run tests, and optionally publish artifacts.</p>"},{"location":"getting-started/#requirements","title":"Requirements","text":"<ul> <li>Optional: Helm 3.10+ and kubectl (chart now lives in external repo)</li> <li>Kyverno and/or Gatekeeper pre\u2011installed in the cluster (enable only what you need)</li> <li>Python 3.11+ and pip (for coverage and index generation)</li> <li>Node.js 18+ (for building the Backstage plugin, if used)</li> <li>OPA 1.7+ (to run Rego v1 tests) - optional</li> <li>ORAS CLI - optional (to publish the OPA bundle to an OCI registry)</li> </ul>"},{"location":"getting-started/#steps","title":"Steps","text":"<ol> <li>Install dependencies</li> </ol> <pre><code>make setup-dev\nmake deps\n</code></pre> <ol> <li>Validate metadata/maps and generate coverage</li> </ol> <pre><code>make validate\nmake validate-maps  # validate compliance maps schema\nmake coverage\n</code></pre> <p>Open <code>docs/coverage.md</code> or <code>dist/coverage.html</code>.</p> <ol> <li>Run Rego tests (Rego v1 syntax)</li> </ol> <pre><code>opa test policies -v\n</code></pre> <ol> <li>(Optional) Build and publish an OPA bundle to OCI</li> </ol> <pre><code>make opa-bundle\nmake oras-publish IMAGE=ghcr.io/rulehub/rulehub-bundle TAG=0.1.0\n</code></pre>"},{"location":"getting-started/#optional-local-developer-checks-parity-with-ci","title":"Optional: Local developer checks (parity with CI)","text":"<ul> <li>Tools unit tests (pytest):</li> </ul> <pre><code>make test-tools\n</code></pre>"},{"location":"getting-started/#repository-structure-short","title":"Repository structure (short)","text":"<ul> <li><code>addons/**</code> - Kyverno &amp; Gatekeeper policy YAML (authoring source)</li> <li>(Helm chart moved to external repo: rulehub/rulehub-charts)</li> <li><code>policies/**</code> - Rego policies (compliance/metadata/tests)</li> <li><code>compliance/maps/*.yml</code> - compliance maps for regions/regulations</li> <li><code>tools/**</code> - generators, validators (sync helpers removed)</li> <li><code>docs/**</code> - documentation and reports</li> </ul> <p>See also: <code>docs/k8s-policies.md</code>, <code>docs/policy-architecture.md</code>, <code>docs/README.md</code>.</p>"},{"location":"k8s-policies/","title":"Gatekeeper &amp; Kyverno: guide","text":"<p>This project uses a flat layout (no nested folders). Domain and geo are encoded in the file name and labels.</p>"},{"location":"k8s-policies/#where-policies-live","title":"Where policies live","text":"<ul> <li>Kyverno: <code>addons/kyverno/policies/*.yaml</code></li> <li>Gatekeeper templates: <code>addons/k8s-gatekeeper/templates/*.yaml</code></li> <li>Gatekeeper constraints: <code>addons/k8s-gatekeeper/constraints/*.yaml</code></li> </ul> <p>Helm chart mirrors are maintained externally (repository: <code>rulehub/rulehub-charts</code>).</p>"},{"location":"k8s-policies/#file-naming","title":"File naming","text":"<p>Pattern: <code>&lt;domain&gt;.&lt;geo&gt;.&lt;policy-slug&gt;.yaml</code></p> <p>Rules (short):</p> Segment Format Allowed values / notes Example domain lowercase k8s, fintech, aml, gdpr, pci, rg, ... (see <code>policies/</code>) k8s geo lowercase us, eu, uk, au, in, global eu policy-slug kebab-case short rule identifier no-run-as-root <p>Conventions:</p> <ul> <li>Only ASCII letters, digits and <code>-</code> for <code>policy-slug</code>; dots separate filename segments.</li> <li>One file = one logical policy (Kyverno/ConstraintTemplate/Constraint may embed multiple underlying rules but they constitute one RuleHub policy).</li> <li>Engine is not encoded in the filename - it is inferred from file location (see \"Where policies live\") and duplicated in labels.</li> </ul> <p>Examples:</p> <ul> <li><code>fintech.eu.psd2-sca.yaml</code></li> <li><code>rg.us.uigea-payment-blocks.yaml</code></li> <li><code>k8s.global.no-run-as-root.yaml</code></li> </ul>"},{"location":"k8s-policies/#labels-required-recommended","title":"Labels (required / recommended)","text":"<p>Add labels under <code>metadata.labels</code> for filtering and cataloging. Key labels and value rules:</p> <p>| Label key           | Required    | Value format    | Source                                           | Example                                                                | | ------------------- | ----------- | --------------- | ------------------------------------------------ | ---------------------------------------------------------------------- | ------- | -------- | ------------------------------------------------------------------ | ---- | | rulehub.io/engine   | yes         | kyverno         | gatekeeper                                       | From file location (<code>addons/kyverno/**</code> or <code>addons/k8s-gatekeeper/**</code>) | kyverno | | rulehub.io/domain   | yes         | lowercase       | First filename segment                           | k8s                                                                    | | rulehub.io/geo      | yes         | lowercase       | Second filename segment                          | global                                                                 | | rulehub.io/id       | yes         | snake_case      | <code>policy-slug</code> from filename -&gt; convert <code>-</code> to <code>_</code> | no_run_as_root                                                         | | rulehub.io/severity | recommended | info            | low                                              | medium                                                                 | high    | critical | If known; for Kyverno may correlate with <code>validationFailureAction</code> | high | | rulehub.io/owner    | optional    | free text       | Owning team                                      | platform-security                                                      | | rulehub.io/tags     | optional    | comma-separated | Thematic tags                                    | security,run-as-non-root                                               |</p> <p>Note:</p> <ul> <li><code>rulehub.io/id</code> aligns with <code>id</code> in <code>policies/**/metadata.yaml</code> (see <code>docs/metadata.md</code>): snake_case inside the identifier; kebab-case in filename.</li> <li>File location determines the engine and resource kind:</li> <li>Kyverno: <code>addons/kyverno/policies/*.yaml</code> -&gt; <code>rulehub.io/engine=kyverno</code></li> <li>Gatekeeper ConstraintTemplate: <code>addons/k8s-gatekeeper/templates/*.yaml</code> -&gt; <code>rulehub.io/engine=gatekeeper</code></li> <li>Gatekeeper Constraint: <code>addons/k8s-gatekeeper/constraints/*.yaml</code> -&gt; <code>rulehub.io/engine=gatekeeper</code></li> </ul>"},{"location":"k8s-policies/#label-examples","title":"Label examples","text":"<p>Kyverno (<code>addons/kyverno/policies/k8s.global.no-run-as-root.yaml</code>):</p> <pre><code>apiVersion: kyverno.io/v1\nkind: ClusterPolicy\nmetadata:\n  name: no-run-as-root\n  labels:\n    rulehub.io/engine: kyverno\n    rulehub.io/domain: k8s\n    rulehub.io/geo: global\n    rulehub.io/id: no_run_as_root\n    rulehub.io/severity: high\n</code></pre> <p>Gatekeeper ConstraintTemplate (<code>addons/k8s-gatekeeper/templates/k8s.global.no-run-as-root.yaml</code>):</p> <pre><code>apiVersion: templates.gatekeeper.sh/v1beta1\nkind: ConstraintTemplate\nmetadata:\n  name: k8srunasnonroot\n  labels:\n    rulehub.io/engine: gatekeeper\n    rulehub.io/domain: k8s\n    rulehub.io/geo: global\n    rulehub.io/id: no_run_as_root\n</code></pre> <p>Gatekeeper Constraint (<code>addons/k8s-gatekeeper/constraints/k8s.global.no-run-as-root.yaml</code>):</p> <pre><code>apiVersion: constraints.gatekeeper.sh/v1beta1\nkind: K8sRunAsNonRoot\nmetadata:\n  name: disallow-root-users\n  labels:\n    rulehub.io/engine: gatekeeper\n    rulehub.io/domain: k8s\n    rulehub.io/geo: global\n    rulehub.io/id: no_run_as_root\n</code></pre>"},{"location":"k8s-policies/#sync-packaging","title":"Sync / packaging","text":"<p>Author in <code>addons/**</code>; external automation ingests these sources for chart packaging.</p>"},{"location":"k8s-policies/#install-the-chart","title":"Install the chart","text":"<p>Refer to <code>rulehub/rulehub-charts</code> README for installation and configuration (enabling/disabling policy sets, values.yaml options).</p>"},{"location":"k8s-policies/#testing-and-validation","title":"Testing and validation","text":"<ul> <li>Rego (OPA v1):</li> </ul> <pre><code>opa test policies -v\n</code></pre> <ul> <li>Metadata validation and coverage:</li> </ul> <pre><code>make validate &amp;&amp; make coverage\n</code></pre>"},{"location":"link-quality/","title":"Link Quality Pipeline","text":"<p>This document describes how RuleHub ensures that URL references in policy metadata remain high quality, consistent, and trustworthy over time.</p>"},{"location":"link-quality/#overview","title":"Overview","text":"<p>Policies include a <code>links</code> array in their <code>metadata.yaml</code> with authoritative references (laws, regulator guidance, standards, technical docs). Low\u2011quality or marketing links can accumulate and reduce signal; the link quality pipeline detects and curates these issues.</p> <p>Core goals:</p> <ul> <li>Detect patterns that correlate with link rot, low signal, or vendor marketing bias.</li> <li>Highlight discrepancies between curated metadata links and an optional exported list (<code>links_export.json</code>).</li> <li>Provide guardrails in local dev, CI, and release workflows without creating excessive friction.</li> <li>Track drift over time via baselining and (future) historical metrics.</li> </ul>"},{"location":"link-quality/#normalization","title":"Normalization","text":"<p>Before audit heuristics run, links may be normalized (separate script(s)) to ensure consistent string forms:</p> <ul> <li>Trim surrounding whitespace.</li> <li>Optionally lowercase the scheme + host (path/query preserved case).</li> <li>Remove obvious duplicate trailing slashes.</li> <li>De\u2011duplicate within a single policy while preserving original order (first occurrence kept).</li> <li>Future: strip benign tracking params (<code>utm_*</code>, <code>gclid</code>) during normalization rather than only flagging.</li> </ul> <p>Normalization scripts (see <code>tools/normalize_links.py</code> and related helpers) are idempotent and can be run safely multiple times.</p>"},{"location":"link-quality/#audit-categories","title":"Audit Categories","text":"<p><code>tools/analyze_links.py</code> performs a read\u2011only heuristic audit combining all metadata links (and optionally those from an export file). Suspicious categories:</p> Category Heuristic Rationale non_https URL starts with <code>http://</code> Enforce transport security / modern sources vendor Host matches configured vendor/marketing domains (sportradar.com, emvco.com, styra.com, upguard.com) Avoid biased / promotional sources unless intentionally allowed tracking_query Query contains tracking params (<code>utm_*</code>, <code>gclid</code>) Reduce analytics noise / privacy concerns celex_pdf Contains <code>TXT/PDF</code> (EU law CELEX printable PDF indicator) Printed/PDF citations often less stable than HTML canonical forms long Length &gt; 180 characters Very long URLs are brittle / may include session or tracking tokens external_source_code Host is raw.githubusercontent.com / gist.github.com or URL ends with archive extension (.zip, .tar.gz, .tgz, .tar, .tar.bz2, .tar.xz) Elevated supply chain / integrity risk; prefer stable documentation pages over raw source blobs highly_shared Same exact URL referenced by &gt;50 policies Potential over\u2011reliance; maybe consolidate description or cite canonical root <p>Each suspicious list is unique + sorted. \"Highly shared\" is emitted as a top list (capped at 50 entries) with counts.</p>"},{"location":"link-quality/#baseline-comparison","title":"Baseline Comparison","text":"<p>A baseline file <code>links_audit_baseline.json</code> (if present) captures an accepted snapshot of suspicious findings + discrepancies at a point in time. The flow:</p> <ol> <li>Run <code>make link-audit</code> (invokes <code>analyze_links.py</code>).</li> <li>Generate <code>links_audit_report.json</code> (using <code>--json</code>).</li> <li>Run <code>make link-audit-diff</code> (script <code>tools/compare_links_baseline.py</code>) to diff current report vs baseline.</li> <li>Output per-category Added / Removed counts and overall drift summary (always exit 0 unless <code>FAIL_LINK_AUDIT=1</code>).</li> </ol> <p>Purpose: protect against silent growth of low-quality links while allowing intentional improvements to shrink the set.</p> <p>To refresh baseline deliberately: replace <code>links_audit_baseline.json</code> after review in a dedicated PR.</p>"},{"location":"link-quality/#link-metrics-history","title":"Link Metrics &amp; History","text":"<p>Historical drift is tracked via build artifacts instead of committing volatile CSV updates to git. This keeps the repository noise\u2011free while still enabling time\u2011series analysis.</p>"},{"location":"link-quality/#daily-capture-artifact-not-git","title":"Daily Capture (Artifact, Not Git)","text":"<p>The daily link audit workflow (see CI) performs:</p> <ol> <li>Run <code>make link-audit</code> to (re)generate <code>links_audit_report.json</code> (suspicious categories + discrepancies).</li> <li>Extract a single CSV line of summary counts (date plus category counts) and append/update an in\u2011memory    <code>links_audit_history.csv</code> (idempotent - if a row for <code>YYYY-MM-DD</code> already exists it is not duplicated).</li> <li>Upload the resulting <code>links_audit_history.csv</code> as an artifact named <code>links-audit-history</code> (retention ~30 days;    adjust retention in workflow settings as needed). No commit is made to the repo.</li> </ol> <p>CSV schema (daily raw history):</p> <pre><code>date,non_https,vendor,tracking_query,celex_pdf,long,highly_shared,external_source_code\n2025-08-20,0,3,5,1,2,10,0\n...\n</code></pre> <p>Rationale for \"artifact not git\":</p> <ul> <li>Avoid noisy churn in PRs (one line per day commit pollution).</li> <li>Allow automatic pruning via artifact retention instead of manual VCS hygiene.</li> <li>Keep repository focused on source truth (policies + maps) while metrics remain derived/ephemeral.</li> </ul>"},{"location":"link-quality/#weekly-aggregation","title":"Weekly Aggregation","text":"<p>On demand (locally or in a scheduled job) the script <code>tools/aggregate_link_history.py</code> consumes one or more downloaded daily CSV artifacts (<code>links_audit_history*.csv</code>) and produces <code>links_audit_weekly.csv</code> summarizing by ISO week:</p> <ul> <li><code>week_start</code> (Monday, ISO week anchor)</li> <li><code>iso_year_week</code> (e.g., <code>2025-W34</code>)</li> <li>For each category: <code>sum_&lt;cat&gt;</code> and <code>avg_&lt;cat&gt;</code></li> </ul> <p>Example (abbreviated):</p> <pre><code>iso_year_week,week_start,sum_non_https,avg_non_https,sum_vendor,avg_vendor,...\n2025-W34,2025-08-18,0,0.0,21,3.0,...\n</code></pre> <p>The weekly file can be used to drive charts or embedded tables in documentation (future enhancement: automated chart generation).</p>"},{"location":"link-quality/#reconstructing-history-locally","title":"Reconstructing History Locally","text":"<ol> <li>(Optional) List artifacts: <code>gh run list --workflow link-audit</code> then locate recent successful runs.</li> <li>Download artifacts (repeat or use a small script):    <code>gh run download &lt;run-id&gt; -n links-audit-history -D artifacts/&lt;run-id&gt;/</code>.</li> <li>Collect all <code>artifacts/*/links_audit_history.csv</code> into one directory.</li> <li>Run <code>python tools/aggregate_link_history.py --input-dir artifacts --output dist/links_audit_weekly.csv</code> (or <code>make link-audit-weekly</code>).</li> <li>Inspect <code>dist/links_audit_weekly.csv</code> or import it into analysis/visualization tooling.</li> </ol>"},{"location":"link-quality/#retention-gaps","title":"Retention &amp; Gaps","text":"<ul> <li>Default artifact retention (30 days) creates a rolling window; to preserve long\u2011term trends periodically export   weekly aggregates (or snapshot a baseline) into a permanent location (could be a dedicated <code>metrics/</code> branch or external storage).</li> <li>If a daily artifact is missing (workflow skipped/failing) aggregation naturally yields a lower <code>sum_*</code> for that week;   gaps can be detected by missing calendar dates compared to expected range.</li> <li>Baseline + weekly trends together allow answering: \"Did vendor links spike this month?\" without storing every raw event.</li> </ul>"},{"location":"link-quality/#integrity-reproducibility","title":"Integrity &amp; Reproducibility","text":"<ul> <li>All metrics are derivable from underlying link sets at any commit; artifacts are convenience accelerators, not a source of truth.</li> <li>The daily CSV values should strictly equal counts in <code>links_audit_report.json</code> for that day (guardrail: optional future validation step comparing the two before artifact upload).</li> </ul>"},{"location":"link-quality/#security-considerations","title":"Security Considerations","text":"<ul> <li>No external network calls are made in the metrics pipeline - counts are computed solely from repository metadata.</li> <li>Artifact tampering risk is low; for higher assurance, a future workflow could sign weekly aggregates and publish detached signatures.</li> </ul>"},{"location":"link-quality/#summary","title":"Summary","text":"<p>Use artifacts for ephemeral, append\u2011only daily metrics; aggregate when needed; keep git history clean; retain ability to recreate metrics from source at any point.</p>"},{"location":"link-quality/#failure-modes-env-flags","title":"Failure Modes &amp; Env Flags","text":"<p>Environment flags influence guardrail strictness:</p> Env Var Effect <code>FAIL_LINK_AUDIT=1</code> Causes <code>analyze_links.py</code> (and diff script) to exit non\u2011zero (5) if any suspicious links or discrepancies are present. Without this flag audits are informational. <code>STRICT_EMPTY_PATHS=1</code> (Metadata path guardrail) Fails validation if any policy still has <code>path: []</code> placeholder. Related but not specific to links; included here for full pipeline context. <p>Default <code>make guardrails</code> run integrates a non\u2011failing link audit; CI or release flows can enable strict mode via <code>FAIL_LINK_AUDIT=1</code> to block unexpected drift.</p>"},{"location":"link-quality/#remediation-workflow","title":"Remediation Workflow","text":"<ol> <li>Run local audit: <code>make link-audit</code> (inspect summary &amp; JSON report).</li> <li>If new suspicious entries appear, triage:</li> <li>Replace vendor / marketing pages with regulator or standard body primary sources.</li> <li>Swap <code>http://</code> with <code>https://</code> if canonical resource supports HTTPS.</li> <li>Remove tracking parameters or locate a clean canonical URL.</li> <li>Replace CELEX PDF variant with stable HTML EUR-Lex page.</li> <li>For long URLs, search for a shorter stable root document.</li> <li>Update affected <code>metadata.yaml</code> <code>links</code> arrays.</li> <li>Re-run audit until categories shrink / stabilize.</li> <li>If intended residual findings remain (e.g., only available PDF), accept and update baseline in a controlled PR.</li> </ol>"},{"location":"link-quality/#future-enhancements","title":"Future Enhancements","text":"<p>Planned or potential improvements:</p> <ul> <li>Vendor allowlist / denylist file (<code>links_vendor_policies.json</code>) to explicitly permit certain vendor documentation when necessary, suppressing noise.</li> </ul> <ul> <li>Historical metrics file (<code>links_audit_history.csv</code>) appended daily to support trend charts in docs.</li> <li>Automatic normalization of benign tracking params instead of merely flagging.</li> <li>Severity scoring per URL aggregating multiple heuristic hits.</li> <li>Integration with release checklist (drift summary gate before tagging).</li> </ul> <p>Contributions welcome: extend heuristics conservatively, keeping false positives low and reproducible (no network calls).</p>"},{"location":"metadata/","title":"Policy metadata schema","text":"<p>This repository stores metadata for policies in <code>policies/&lt;standard&gt;/&lt;id&gt;/metadata.yaml</code>.</p> <p>Required fields:</p> <ul> <li>id: <code>&lt;namespace&gt;.&lt;id&gt;</code> (e.g. <code>pci.storage_encryption</code>, <code>k8s.no_privileged</code>)</li> <li>name: human-readable policy name</li> <li>standard: either a string (e.g. <code>pci</code>) with a separate <code>version</code>, or an object <code>{ name, version }</code> (e.g. <code>{ name: \"PCI DSS\", version: \"4.0\" }</code>)</li> <li>version: version of the standard/domain (required for flat form; omitted if using nested <code>standard</code>)</li> <li>path: string or list of strings with relative paths to actual policy files</li> <li>geo: geographic scoping (now mandatory)</li> </ul> <p>Optional fields:</p> <ul> <li>description: short description</li> <li>framework: kyverno | gatekeeper | k8s | other</li> <li>severity: info | low | medium | high | critical</li> <li>tags: string array</li> <li>owner: team or owner identifier</li> <li>links: array of URLs</li> </ul> <p>Geo block (required):</p> <ul> <li>regions: [string] (&gt;=1)</li> <li>countries: [string] (&gt;=1; may include \"*\" for global applicability)</li> <li>subregions: [string] (optional)</li> <li>scope: string (summary of applicability, e.g. Global, EU, Multi-region)</li> </ul> <p>Validation:</p> <ul> <li>JSON Schema: <code>tools/schemas/policy-metadata.schema.json</code></li> <li>Local: pre-commit hook <code>metadata validate</code> checks schema and that paths exist</li> <li>CI: workflow <code>metadata-validate.yml</code> runs the same checks on PRs/pushes</li> <li>Uniqueness &amp; referential integrity:</li> <li>IDs must be unique across the repository; the validator fails on duplicates.</li> <li>Compliance maps (<code>compliance/maps/*.yml</code>) must only reference known policy IDs in their <code>sections.*.policies</code> lists; unknown IDs cause the maps validator to fail.</li> </ul> <p>Conventions:</p> <ul> <li>IDs use lowercase and underscores, <code>&lt;namespace&gt;.&lt;short_id&gt;</code></li> <li><code>path</code> should reference files under <code>addons/**</code> (Helm chart mirrors are now maintained externally)</li> <li>For Kyverno policies, severity is inferred from <code>spec.validationFailureAction</code> if not set</li> <li>For Gatekeeper, severity defaults to medium; if corresponding <code>constraints/</code> exist, treated as high</li> </ul>"},{"location":"metadata/#referencing-policy-files-in-path","title":"Referencing policy files in <code>path</code>","text":"<ul> <li>Use one or more concrete, existing file paths (no globs). The validator checks <code>os.path.exists</code> for each entry.</li> <li>Typical locations by framework:</li> <li>Kyverno: <code>addons/kyverno/policies/&lt;policy&gt;.yaml</code></li> <li>Gatekeeper templates: <code>addons/k8s-gatekeeper/templates/&lt;policy&gt;.yaml</code></li> <li>Gatekeeper constraints: <code>addons/k8s-gatekeeper/constraints/&lt;policy&gt;.yaml</code></li> <li>Other/custom domains: define a clear convention under <code>addons/&lt;domain&gt;/&lt;area&gt;/&lt;policy&gt;.yaml</code>.</li> </ul> <p>Examples</p> <p>Flat standard/version form:</p> <pre><code>id: pci.storage_encryption\nname: Storage Encryption\nstandard: pci\nversion: \"4.0\"\npath:\n  - addons/kyverno/policies/storage-encryption.yaml\n</code></pre> <p>Nested standard with geo:</p> <pre><code>id: fintech.pci_mfa_required\nname: PCI DSS \u2014 MFA Required\nstandard:\n  name: PCI DSS\n  version: \"4.0\"\ngeo:\n  regions: [Global]\n  countries: [\"*\"]\n  scope: Global\npath: [] # placeholder until implementation exists\n</code></pre> <p>Example (single authoritative source path):</p> <pre><code>path:\n  - addons/kyverno/policies/no-privileged.yaml\n</code></pre>"},{"location":"metadata/#empty-path-placeholders-and-strict-mode","title":"Empty <code>path</code> placeholders and strict mode","text":"<ul> <li>While a policy is only planned and has no implementation files, keep <code>path: []</code> as a placeholder. This yields a warning in the validator.</li> <li>To enforce fail-fast on empty paths, enable strict mode:</li> <li>Environment variable: <code>STRICT_EMPTY_PATHS=1</code></li> <li>Make target: <code>make validate-strict</code></li> </ul> <p>Notes:</p> <ul> <li>Do not set future/globbed paths (e.g., <code>addons/**</code>) - they will fail validation until real files exist and globs are not expanded by the validator.</li> <li>Prefer adding only the <code>addons/**</code> source path; external chart repo handles mirroring.</li> </ul>"},{"location":"metadata/#severity-and-tags-conventions-adjust-after-implementation","title":"Severity and tags conventions (adjust after implementation)","text":"<p>Until a concrete implementation exists, non-framework policies may use:</p> <ul> <li><code>framework: other</code></li> <li><code>severity: medium</code></li> <li><code>tags: [\"pci\"|\"gdpr\"|\"amld\"]</code></li> <li><code>owner: compliance</code></li> </ul> <p>When adding a real policy, adjust <code>severity</code> and extend <code>tags</code> by topic. Examples:</p> <ul> <li>Encryption at rest (e.g., storage/volume encryption): <code>high</code> or <code>critical</code>; tags: <code>encryption</code>, <code>data-at-rest</code>, <code>storage</code></li> <li>Encryption in transit / HTTPS-only: <code>high</code>; tags: <code>tls</code>, <code>https</code>, <code>network</code></li> <li>IAM password policy / strong auth: <code>high</code>; tags: <code>iam</code>, <code>auth</code>, <code>password-policy</code></li> <li>Logging &amp; monitoring: <code>medium</code>-<code>high</code>; tags: <code>logging</code>, <code>monitoring</code>, <code>audit</code></li> <li>GDPR data retention: <code>high</code>; tags: <code>privacy</code>, <code>retention</code>, <code>storage-limitation</code></li> <li>GDPR data minimization: <code>medium</code>-<code>high</code>; tags: <code>privacy</code>, <code>data-minimization</code></li> <li>AML sanctions/PEP screening, EDD: <code>high</code>; tags: <code>sanctions</code>, <code>pep</code>, <code>screening</code>, <code>edd</code></li> </ul>"},{"location":"opa-bundle-format/","title":"OPA Bundle Artifact Format &amp; Verification","text":"<p>This document details the structure of the RuleHub OPA bundle (<code>dist/opa-bundle.tar.gz</code>) and how to verify its integrity and authenticity using the external manifest and <code>cosign</code>.</p>"},{"location":"opa-bundle-format/#artifact-set","title":"Artifact Set","text":"File Purpose Producer <code>dist/opa-bundle.tar.gz</code> OPA bundle (Rego modules + OPA internal .manifest) <code>make opa-bundle</code> (<code>opa build -b policies</code>) <code>dist/opa-bundle.manifest.json</code> External manifest: file inventory + hashes + build metadata <code>make opa-bundle-manifest</code> <code>dist/opa-bundle.&lt;format&gt;.json</code> SBOM (spdx-json, cyclonedx-json, etc.) <code>make sbom-opa-bundle</code> <code>dist/opa-bundle.tar.gz.sig</code> Cosign signature (blob) <code>make sign-opa-bundle</code> <code>dist/opa-bundle.tar.gz.pem</code> Cosign certificate (Fulcio, keyless) <code>make sign-opa-bundle</code> <p>Optional (future / OCI): provenance &amp; SBOM attestations attached to the OCI artifact.</p>"},{"location":"opa-bundle-format/#external-manifest-schema-v1","title":"External Manifest Schema (v1)","text":"<pre><code>schema_version: 1\nbuild_commit: &lt;git sha&gt;\nbuild_time: &lt;RFC3339 UTC&gt;\npolicies: [ { path, sha256, bytes }, ... ]\naggregate_hash: sha256( join('\\n', '&lt;sha256&gt;  &lt;path&gt;' sorted by path) )\n</code></pre> <p>Semantics:</p> <ul> <li><code>policies[]</code> lists every source file included (policy <code>.rego</code> + <code>metadata.yaml</code>, tests excluded when <code>--exclude-tests</code>).</li> <li>Individual file integrity: per-entry <code>sha256</code> + <code>bytes</code>.</li> <li><code>aggregate_hash</code> is a deterministic roll-up (sensitive to order, content, and membership) providing tamper evidence with a single digest.</li> <li><code>build_commit</code> ties the manifest to a repository state for traceability.</li> </ul>"},{"location":"opa-bundle-format/#verification-layers","title":"Verification Layers","text":"<ol> <li>File-level hashing (per policy source file) - detects modification.</li> <li>Aggregate hash - detects insertion, deletion, reordering, or hash substitution.</li> <li>Cosign signature over the bundle tarball (<code>sign-blob</code>) - cryptographic integrity + origin (GitHub OIDC / Fulcio cert) of the packaged result.</li> <li>Optional: cosign signature (or future attestation) over the manifest itself.</li> <li>SBOM - transparency of included components, enabling vulnerability &amp; license workflows.</li> </ol>"},{"location":"opa-bundle-format/#build-verify-workflow","title":"Build &amp; Verify Workflow","text":"<p>Build:</p> <pre><code>make opa-bundle\nmake opa-bundle-manifest\nmake sbom-opa-bundle   # optional\n</code></pre> <p>Sign (keyless default):</p> <pre><code>make sign-opa-bundle   # produces .sig and .pem\n</code></pre> <p>Cryptographic verification (signature only):</p> <pre><code>make verify-opa-bundle  # wraps cosign verify-blob\n</code></pre> <p>Structural + hash verification:</p> <pre><code>make verify-bundle  # wraps tools/verify_bundle.py\n</code></pre> <p>Manual invocation example:</p> <pre><code>python tools/verify_bundle.py \\\n  --manifest dist/opa-bundle.manifest.json \\\n  --bundle dist/opa-bundle.tar.gz \\\n  --policies-root policies \\\n  --bundle-sig dist/opa-bundle.tar.gz.sig \\\n  --bundle-cert dist/opa-bundle.tar.gz.pem\n</code></pre> <p>Expected output includes INFO lines for successful cosign checks and a final <code>OK: bundle integrity verified</code>.</p>"},{"location":"opa-bundle-format/#failure-modes-interpretation","title":"Failure Modes &amp; Interpretation","text":"Failure Likely Cause Action Missing manifest keys Corrupt / wrong file Regenerate manifest Hash mismatch (file) Local tampering / stale manifest Rebuild &amp; regenerate manifest Size mismatch Partial write or corruption Rebuild bundle Aggregate mismatch Added/removed/reordered file or altered hash list Regenerate manifest &amp; investigate diffs Git HEAD mismatch Manifest from different commit Rebuild or pin commit Cosign verify fail Wrong signature, tampering, missing Fulcio trust root Re-sign or validate environment Missing bundle member Packaging issue (<code>opa build</code>) or manual edit Rebuild bundle"},{"location":"opa-bundle-format/#oci-distribution","title":"OCI Distribution","text":"<p>Publishing (example):</p> <pre><code>make oras-publish IMAGE=ghcr.io/rulehub/rulehub-bundle TAG=vX.Y.Z\n</code></pre> <p>Adds OCI annotations including <code>io.rulehub.manifest.sha256</code>. Optional signing:</p> <pre><code>make oras-publish IMAGE=ghcr.io/rulehub/rulehub-bundle TAG=vX.Y.Z SIGN=1\n</code></pre> <p>Later verification (OCI):</p> <pre><code>COSIGN_EXPERIMENTAL=1 cosign verify ghcr.io/rulehub/rulehub-bundle:vX.Y.Z\noras pull ghcr.io/rulehub/rulehub-bundle:vX.Y.Z -o dist/\n</code></pre>"},{"location":"opa-bundle-format/#local-evaluation-example","title":"Local Evaluation Example","text":"<pre><code>opa eval -b dist/opa-bundle.tar.gz -i input.json \\\n  \"data.rulehub.k8s.no_run_as_root.deny\"\n</code></pre>"},{"location":"opa-bundle-format/#future-enhancements","title":"Future Enhancements","text":"<ul> <li>Sign / attest manifest directly.</li> <li>Add <code>bundle_sha256</code> to manifest for explicit cross-reference.</li> <li>Generate SLSA provenance and in-toto attestations automatically.</li> <li>Policy-level sub-bundle segmentation (domain-scoped bundles) for selective consumption.</li> </ul>"},{"location":"opa-bundle-usage/","title":"Using the OPA Bundle in a Kubernetes Admission Controller","text":"<p>The RuleHub OPA bundle (<code>dist/opa-bundle.tar.gz</code>) packages all Rego policies for cluster or CI evaluation. You can consume it directly in an admission controller deployment (standalone OPA or OPA + kube-mgmt) or via an OCI registry.</p>"},{"location":"opa-bundle-usage/#1-obtain-verify","title":"1. Obtain &amp; Verify","text":"<p>Option A (Release assets): download <code>opa-bundle.tar.gz</code> plus its <code>.sig</code>, <code>.pem</code>, and <code>opa-bundle.manifest.json</code>.</p> <pre><code>COSIGN_EXPERIMENTAL=1 cosign verify-blob \\\n  --signature dist/opa-bundle.tar.gz.sig \\\n  --certificate dist/opa-bundle.tar.gz.pem \\\n  dist/opa-bundle.tar.gz\n\npython tools/verify_bundle.py \\\n  --manifest dist/opa-bundle.manifest.json \\\n  --bundle dist/opa-bundle.tar.gz \\\n  --policies-root policies \\\n  --bundle-sig dist/opa-bundle.tar.gz.sig \\\n  --bundle-cert dist/opa-bundle.tar.gz.pem\n</code></pre> <p>Option B (OCI):</p> <pre><code>oras pull ghcr.io/rulehub/rulehub-bundle:vX.Y.Z -o dist/\nCOSIGN_EXPERIMENTAL=1 cosign verify ghcr.io/rulehub/rulehub-bundle:vX.Y.Z\n</code></pre>"},{"location":"opa-bundle-usage/#2-deploy-opa","title":"2. Deploy OPA","text":"<p>ConfigMap referencing bundle over HTTPS (release URL or internal proxy):</p> <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: opa-config\n  namespace: opa\ndata:\n  config.yaml: |\n    services:\n      rulehub:\n  url: https://github.com/rulehub/rulehub/releases/download/vX.Y.Z\n    bundles:\n      rulehub:\n        service: rulehub\n        resource: opa-bundle.tar.gz\n        polling:\n          min_delay_seconds: 60\n          max_delay_seconds: 120\n</code></pre> <p>Deployment (excerpt):</p> <pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: opa\n  namespace: opa\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: opa\n  template:\n    metadata:\n      labels:\n        app: opa\n    spec:\n      serviceAccountName: opa\n      volumes:\n        - name: opa-config\n          configMap:\n            name: opa-config\n      containers:\n        - name: opa\n          image: openpolicyagent/opa:latest\n          args:\n            [\n              'run',\n              '--server',\n              '--config-file=/config/config.yaml',\n              '--addr=0.0.0.0:8181',\n              '--diagnostic-addr=0.0.0.0:8282',\n            ]\n          volumeMounts:\n            - name: opa-config\n              mountPath: /config\n          readinessProbe:\n            httpGet:\n              path: /health?bundles\n              port: 8181\n          livenessProbe:\n            httpGet:\n              path: /health\n              port: 8181\n</code></pre> <p>Admission webhooks call OPA with the AdmissionReview as input; deny reasons surface from <code>data.rulehub.&lt;domain&gt;.&lt;policy&gt;.deny</code> arrays.</p>"},{"location":"opa-bundle-usage/#3-local-evaluation-example","title":"3. Local Evaluation Example","text":"<pre><code>opa eval -b dist/opa-bundle.tar.gz -i input.json \\\n  \"data.rulehub.k8s.no_run_as_root.deny\"\n</code></pre>"},{"location":"opa-bundle-usage/#4-security-practices","title":"4. Security Practices","text":"<ul> <li>Always verify cosign signature before promotion.</li> <li>Pin OCI by digest (tag@sha256) in production.</li> <li>Keep manifest + SBOM alongside the bundle for offline re-check.</li> </ul> <p>More detail: <code>docs/opa-bundle-format.md</code>, <code>docs/security-integrity.md</code>, <code>docs/security-provenance.md</code>.</p>"},{"location":"performance/","title":"Performance &amp; Scaling","text":""},{"location":"performance/#baseline-current-repository","title":"Baseline (Current Repository)","text":"<p>Measured via <code>python tools/coverage_map.py --profile</code>:</p> Stage Duration (s) Notes load_metadata_index ~0.456 YAML parsing + disk I/O (283 policies) load_mappings ~0.028 Few compliance map YAML files compute_policy_test_coverage ~0.039 Filesystem glob + existence checks build_markdown ~0.003 String assembly only build_mermaid ~0.001 Minimal graph text write_json_outputs ~0.066 JSON + CSV serialization + path existence caching total ~0.594 End-to-end generation <p>Per-policy cost (dominant stage): ~0.456 s / 283 \u2248 1.61 ms per policy metadata file.</p>"},{"location":"performance/#projection-5-policies-1415","title":"Projection: \u00d75 Policies (~1415)","text":"<p>Assuming near-linear scaling for metadata loading and negligible growth in constant stages:</p> <pre><code>Projected metadata load \u2248 0.456 * 5 \u2248 2.28 s\nProjected total \u2248 (total - metadata) + projected_metadata \u2248 (0.594 - 0.456) + 2.28 \u2248 2.42 s\nAdd 25% CI variance buffer \u21d2 \u2248 3.0 s expected ceiling\n</code></pre>"},{"location":"performance/#ci-metrics-thresholds","title":"CI Metrics &amp; Thresholds","text":"<p>A lightweight guard ensures performance regression detection:</p> <ol> <li>Run <code>make perf-coverage</code> (invokes <code>tools/perf_check_coverage.py</code>).</li> <li>Script parses <code>--profile</code> output; compares <code>total</code> against thresholds.</li> <li>Environment variables:</li> <li><code>COVERAGE_MAX_SECONDS</code> (default 5.0) - hard fail (exit 5) if exceeded.</li> <li><code>COVERAGE_WARN_SECONDS</code> (default 75% of max) - soft warning (exit 3) if exceeded.</li> <li>CI job marks build unstable (treat exit 3 as warn); blocks merge on exit 5.</li> </ol> <p>Initial recommended settings:</p> <ul> <li>WARN: 3.75 s (default 0.75 * 5.0)</li> <li>FAIL: 5.00 s</li> </ul> <p>These accommodate \u00d75 growth plus additional headroom for variance. Revisit once policy count approaches 1400 or if refactors reduce baseline substantially.</p>"},{"location":"performance/#future-optimizations-if-needed","title":"Future Optimizations (If Needed)","text":"<ul> <li>Pre-load &amp; cache YAML parse results to a serialized artifact keyed by file mtimes (incremental build).</li> <li>Batch file existence checks (already mitigated by <code>_path_exists</code> caching; could pre-stat via <code>os.scandir</code>).</li> <li>Parallel metadata parsing (multiprocessing) if single-core bottlenecks emerge (&gt;5k policies).</li> <li>Optional skip of Mermaid / markdown for performance runs via a <code>--no-markdown</code> flag (not yet necessary).</li> </ul>"},{"location":"performance/#interpreting-failures","title":"Interpreting Failures","text":"<p>If <code>perf-coverage</code> fails:</p> <ol> <li>Inspect stage percentages; if a single stage &gt;50% examine recent changes in that logic.</li> <li>Confirm runner class (GitHub hosted vs local) to rule out environmental slowdown.</li> <li>Consider raising thresholds only after justifying why optimization is impractical.</li> </ol> <p>Generated &amp; maintained manually; update when thresholds or architecture evolve.</p>"},{"location":"performance/#index-pagination-plan-distindexjson-chunking","title":"Index Pagination Plan (dist/index.json Chunking)","text":"<p>Goal: Prepare for future scale where <code>dist/index.json</code> (currently a single JSON with all <code>packages</code>) becomes large (memory &amp; latency impact in Backstage plugin). Provide a backward compatible paging design requiring no immediate plugin changes, while enabling an opt\u2011in multi-file consumption path.</p>"},{"location":"performance/#drivers","title":"Drivers","text":"<ul> <li>JSON size growth: O(policy_count); at several thousand policies &gt;1-2 MB may affect initial page load &amp; caching.</li> <li>Differential fetch: allow clients to only pull needed segment(s) (e.g., lazy search index construction).</li> <li>Integrity: enable per-page hashing so partial corruption is detectable.</li> </ul>"},{"location":"performance/#design-overview","title":"Design Overview","text":"<p>Artifacts (new optional files alongside existing single file):</p> <ol> <li><code>dist/index.json</code> (UNCHANGED for compatibility) - still contains full <code>{\"packages\": [...]}</code> list.</li> <li><code>dist/index-pages.json</code> (manifest) - metadata describing paging set.</li> <li><code>dist/index-page-&lt;n&gt;.json</code> - individual page files containing a slice of packages array.</li> </ol> <p>The paging artifacts are additive; existing consumers continue reading monolithic <code>index.json</code> until upgraded.</p>"},{"location":"performance/#manifest-schema-index-pagesjson","title":"Manifest Schema (index-pages.json)","text":"<pre><code>{\n   \"schema\": \"rulehub.index.pages/1\",\n   \"generated\": \"2025-08-27T12:34:56Z\",        // ISO8601\n   \"total_packages\": 1234,\n   \"page_size\": 200,                            // target (last page may be smaller)\n   \"pages\": [\n      {\n         \"number\": 1,\n         \"file\": \"index-page-1.json\",\n         \"offset\": 0,\n         \"count\": 200,\n         \"sha256\": \"&lt;hex&gt;\",\n         \"first_id\": \"aml.customer_due_diligence\",\n         \"last_id\":  \"betting.underage_block\"\n      },\n      { \"number\": 2, \"file\": \"index-page-2.json\", \"offset\": 200, \"count\": 200 }\n   ],\n   \"aggregate\": {\n      \"sha256_all\": \"&lt;sha256(concatenated page sha256s or canonical re-serialization)&gt;\"\n   },\n   \"monolith\": {                                 // backlink + integrity for monolithic fallback file\n      \"file\": \"index.json\",\n      \"sha256\": \"&lt;hex&gt;\",\n      \"packages\": 1234\n   }\n}\n</code></pre>"},{"location":"performance/#page-file-schema-index-page-njson","title":"Page File Schema (index-page-N.json)","text":"<pre><code>{\n   \"schema\": \"rulehub.index.page/1\",\n   \"page\": 1,\n   \"page_size\": 200,\n   \"total_pages\": 7,\n   \"total_packages\": 1234,\n   \"packages\": [ { /* same package objects as monolith */ } ]\n}\n</code></pre> <p>Package object remains unchanged to preserve plugin data contract.</p>"},{"location":"performance/#ordering-determinism","title":"Ordering &amp; Determinism","text":"<ul> <li>Page ordering uses a stable sort by <code>id</code> (case-insensitive) to ensure consistent diffing and caching.</li> <li>Monolithic file may retain historical insertion order for now; future: optionally also sorted once consumers updated.</li> </ul>"},{"location":"performance/#backward-compatibility-strategy","title":"Backward Compatibility Strategy","text":"<p>Phase 0 (Current): Only <code>index.json</code> produced.</p> <p>Phase 1 (Additive - Proposed): Produce both monolith and paged set (flag <code>PAGED_INDEX=1</code> or auto when <code>len(packages) &gt; PAGE_THRESHOLD</code>). Plugin continues to read monolith; experimental plugin reads manifest first if present.</p> <p>Phase 2 (Opt-In Consumption): Document plugin upgrade path: try manifest -&gt; fall back to monolith. Provide feature flag <code>USE_PAGED_INDEX</code> in plugin config.</p> <p>Phase 3 (Future Optional): If size exceeds hard threshold (e.g., 5 MB), monolith may contain only:</p> <pre><code>{ \"schema\": \"rulehub.index.redirect/1\", \"manifest\": \"index-pages.json\" }\n</code></pre> <p>Only after broad adoption; not planned yet.</p>"},{"location":"performance/#integrity-caching","title":"Integrity &amp; Caching","text":"<ul> <li>Each page individually hashable; CDN / HTTP caches can validate per-page ETag / checksum.</li> <li>Manifest records per-page hash enabling full set verification without loading all pages simultaneously (stream verify).</li> <li>Optional aggregated hash provides a single fingerprint for entire logical index (can be reproducible build target).</li> </ul>"},{"location":"performance/#page-size-selection","title":"Page Size Selection","text":"<ul> <li>Default target: 200 packages per page (env <code>INDEX_PAGE_SIZE</code>). Balances ~50-150 KB compressed per    page (estimate) vs request overhead.</li> <li>Hard minimum: 50 (avoid too many small requests). Hard maximum: 1000 (avoid large transfers defeating purpose).</li> </ul>"},{"location":"performance/#generation-algorithm-pseudo","title":"Generation Algorithm (Pseudo)","text":"<ol> <li>Build full list <code>packages</code> (existing logic) in memory.</li> <li>If paging enabled (flag OR len &gt; threshold):     a. <code>sorted_packages = sorted(packages, key=lambda p: p['id'].lower())</code>.     b. Chunk: for i in range(0, len(sorted_packages), page_size): write <code>index-page-{page}.json</code> with slice.     c. Compute sha256 for each written page (streaming to avoid double memory use).     d. Write manifest <code>index-pages.json</code>.</li> <li>Always write monolithic <code>index.json</code> (fallback) unless Phase 3 redirect mode engaged.</li> </ol>"},{"location":"performance/#client-consumption-flow-plugin-upgrade","title":"Client Consumption Flow (Plugin Upgrade)","text":"<ol> <li>Attempt fetch <code>index-pages.json</code>.</li> <li>If 404 -&gt; load fallback monolithic <code>index.json</code>.</li> <li>Else parse manifest, optionally validate <code>monolith.sha256</code> (defense-in-depth), then lazily fetch    pages (e.g., first page for summary; others for search / detail view).</li> <li>Optionally verify each page hash after download.</li> </ol>"},{"location":"performance/#failure-edge-cases","title":"Failure / Edge Cases","text":"<ul> <li>Missing or corrupt page (hash mismatch): client can retry or fall back to monolith.</li> <li>Partial publish (manifest present but page absent): treat as error; display degraded mode using monolith if available.</li> <li>Page size change between runs: manifest <code>generated</code> timestamp + aggregate hash distinguish    generations; clients should discard cached pages when manifest hash changes.</li> </ul>"},{"location":"performance/#tooling-changes-deferred-not-implemented-yet","title":"Tooling Changes (Deferred / Not Implemented Yet)","text":"<ul> <li>Extend <code>coverage_map.py</code> with new flags:</li> <li><code>--paged-index</code> (bool)</li> <li><code>--index-page-size N</code></li> <li><code>--index-page-threshold N</code> (auto-enable if total &gt; threshold)</li> <li>Helper function <code>write_paged_index(packages, out_dir) -&gt; None</code> encapsulating logic.    (Implementation intentionally deferred until a real size pressure occurs.)</li> </ul>"},{"location":"performance/#migration-checklist","title":"Migration Checklist","text":"Step Action Owner Status 1 Add plan (this document) docs DONE 2 Implement generator flags tooling TODO 3 Publish both formats CI TODO 4 Update Backstage plugin to prefer paged plugin TODO 5 Monitor size; decide Phase 3 maintainers FUTURE"},{"location":"performance/#rationale-summary","title":"Rationale Summary","text":"<p>This phased approach avoids breaking consumers, needs minimal code (one manifest writer + chunk loop), and provides clear upgrade semantics with cryptographic integrity for each page.</p>"},{"location":"plugin-index/","title":"Backstage Plugin Index (Option A)","text":"<p>This page documents the JSON index (<code>dist/index.json</code>) generated by RuleHub for the Backstage UI plugin. The plugin displays data as-is from this index without synthesizing extra metadata.</p> <ul> <li>Producer: <code>tools/coverage_map.py</code></li> <li>Validator: <code>tools/plugin_index_validate.py</code> against <code>tools/schemas/plugin-index.schema.json</code></li> <li><code>schemaVersion</code>: default is <code>1</code>; optional fields are emitted when available.</li> </ul>"},{"location":"plugin-index/#structure","title":"Structure","text":"<p>Top-level object:</p> <ul> <li><code>schemaVersion</code> (integer, optional; default 1)</li> <li><code>packages</code> (array, required)</li> </ul> <p>Package (required): <code>id</code>, <code>name</code>, <code>standard</code>, <code>version</code>, <code>coverage[]</code></p> <p>Optional: <code>jurisdiction</code> (string|string[]), <code>description</code>, <code>framework</code>, <code>severity</code>, <code>geo</code>, <code>paths[]</code> (<code>{path, exists}</code>), <code>owner</code>, <code>tags[]</code>, <code>links</code>.</p>"},{"location":"plugin-index/#generate","title":"Generate","text":"<pre><code>python3 -m venv .venv\n. .venv/bin/activate\npip install -U pip\npip install -r requirements.txt\npython tools/coverage_map.py\n</code></pre> <p>Outputs: <code>docs/coverage.md</code>, <code>dist/coverage.html</code>, <code>dist/policies-index.json</code>, <code>dist/coverage.json</code>, <code>dist/index.json</code>, <code>dist/policies.csv</code>.</p>"},{"location":"plugin-index/#validate","title":"Validate","text":"<pre><code>python tools/plugin_index_validate.py \\\n  --schema tools/schemas/plugin-index.schema.json \\\n  --index dist/index.json\n</code></pre> <p>Reports to <code>dist/integrity/</code> (markdown + JSON). Exit codes: 0 valid, 2 validation errors, 3 IO/parse/schema issues.</p>"},{"location":"plugin-index/#notes","title":"Notes","text":"<ul> <li>The Backstage plugin shows optional fields when present; otherwise cells remain empty.</li> <li>Links in the UI are built from a configurable repo base (default: <code>https://github.com/rulehub/rulehub/tree/main/</code>).</li> </ul>"},{"location":"policy-architecture/","title":"Policy-as-Code Architecture (OPA Bundles, OCI, Gatekeeper, Kyverno)","text":"<p>This document specifies how to add, package, publish, and use RuleHub policies as OPA bundles in OCI registries, in Kubernetes (Gatekeeper, Kyverno), and in CI pipelines.</p>"},{"location":"policy-architecture/#end-to-end-flow-author-test-bundle-publish-consume","title":"End-to-end Flow (author -&gt; test -&gt; bundle -&gt; publish -&gt; consume)","text":"<p>Figure (text alternative for the following mermaid diagram, for screen readers): The lifecycle proceeds linearly: Author policy (create Rego, metadata, and tests) -&gt; Validate (format, schema) -&gt; Unit tests (opa / kyverno / gatekeeper) -&gt; Build OPA bundle (tar artifact) -&gt; Publish to OCI registry -&gt; Two parallel consumption paths: (a) CI pipelines (conftest / opa eval) and (b) Kubernetes admission controllers (Gatekeeper / Kyverno). This describes how authored policies become consumable artifacts.</p> <pre><code>flowchart LR\n  A[Author policy\\n- Rego module(s)\\n- metadata.yaml\\n- tests] --&gt; B[Validate\\n- opa fmt/regal\\n- metadata schema]\n  B --&gt; C[Unit tests\\n- opa test\\n- kyverno test\\n- conftest (if applicable)]\n  C --&gt; D[Build OPA bundle\\n- opa build -b policies\\n- dist/opa-bundle.tar.gz]\n  D --&gt; E[Publish to OCI\\n- ORAS push to GHCR\\n- mediaType: application/vnd.opa.bundle.layer.v1+tar]\n  E --&gt; F[Consume in CI\\n- conftest / opa eval\\n- IaC checks]\n  E --&gt; G[Consume in K8s\\n- Gatekeeper (ConstraintTemplate/Constraint)\\n- Kyverno (Policy/ClusterPolicy)\\n- Optional: OPA sidecar loads bundle]\n</code></pre>"},{"location":"policy-architecture/#repository-structure-and-naming","title":"Repository structure and naming","text":"<ul> <li>Policies live under <code>policies/&lt;domain&gt;/&lt;policy_id&gt;/</code></li> <li><code>policy.rego</code> - Rego module(s)</li> <li><code>policy_test.rego</code> - unit tests for rules</li> <li><code>metadata.yaml</code> - id, title, description, references to standards (PCI/GDPR/etc.), coverage, paths</li> <li>Metadata schema under <code>tools/schemas/policy-metadata.schema.json</code> (already present)</li> <li>K8s integration examples under <code>addons/</code>:</li> <li>Gatekeeper ConstraintTemplates and Constraints: <code>addons/k8s-gatekeeper/{templates,constraints}/*.yaml</code></li> <li>Kyverno policies: <code>addons/kyverno/policies/*.yaml</code></li> <li>Helm chart for policy sets: external repository (<code>rulehub/rulehub-charts</code>)</li> <li>Docs: <code>docs/</code> (this page, coverage, metadata docs)</li> <li>CI workflows: <code>.github/workflows/**</code></li> </ul> <p>Naming conventions:</p> <ul> <li>Rego package: <code>package rulehub.&lt;domain&gt;.&lt;policy_id&gt;</code></li> <li>Policy ID: <code>&lt;domain&gt;.&lt;slug&gt;</code>; do not mix kebab/underscore inside the same identifier. Prefer dot-separated package path and snake_case rule names if needed.</li> <li>Versioning:</li> <li>Record standard versions (e.g., PCI DSS 4.0) in <code>metadata.yaml</code> under <code>references</code>.</li> <li>OPA bundle tag: semantic version or a short SHA label. OCI reference example: <code>oci://ghcr.io/rulehub/rulehub-bundle:&lt;tag&gt;</code></li> </ul>"},{"location":"policy-architecture/#minimal-file-scaffolds","title":"Minimal file scaffolds","text":"<p><code>policies/&lt;domain&gt;/&lt;policy_id&gt;/policy.rego</code></p> <ul> <li>Contract:</li> <li>Input: depends on use case (e.g., Kubernetes object for admission, or IaC document for CI)</li> <li>Output: decision rules with boolean/objects</li> </ul> <p>Example skeleton:</p> <pre><code>package rulehub.k8s.no_run_as_root\n\ndefault deny := false\n\ndeny[msg] {\n  input.kind == \"Pod\"\n  some c\n  c := input.spec.containers[_]\n  not c.securityContext.runAsNonRoot\n  msg := \"Containers must set securityContext.runAsNonRoot=true\"\n}\n</code></pre> <p><code>policies/&lt;domain&gt;/&lt;policy_id&gt;/policy_test.rego</code></p> <pre><code>package rulehub.k8s.no_run_as_root\n\nimport data.rulehub.k8s.no_run_as_root as pol\n\n# happy path\ntest_all_containers_run_as_non_root {\n  input := {\n    \"kind\": \"Pod\",\n    \"spec\": {\"containers\": [{\"securityContext\": {\"runAsNonRoot\": true}}]}\n  }\n  not pol.deny[_]\n}\n\n# violation\ntest_violation_when_missing_flag {\n  input := {\n    \"kind\": \"Pod\",\n    \"spec\": {\"containers\": [{\"name\": \"c1\"}]}\n  }\n  count(pol.deny) == 1\n}\n</code></pre> <p><code>policies/&lt;domain&gt;/&lt;policy_id&gt;/metadata.yaml</code> (fields per existing schema; example):</p> <pre><code>id: k8s.no_run_as_root\nname: 'K8s: Disallow root user'\nversion: 1.0.0\nowner: platform-security\npath:\n  - policies/k8s/no_run_as_root/policy.rego\n  - policies/k8s/no_run_as_root/policy_test.rego\nreferences:\n  - standard: Kubernetes\n    section: SecurityContext\n  - standard: GDPR\n    section: Art. 5(1)(f)\n  - standard: PCI DSS\n    version: '4.0'\n    section: 2.2\n</code></pre>"},{"location":"policy-architecture/#contributor-path-add-a-policy-step-by-step","title":"Contributor path: Add a policy (step-by-step)","text":"<ul> <li>Create a directory: <code>policies/&lt;domain&gt;/&lt;policy_id&gt;/</code></li> <li>Add <code>policy.rego</code> following Styra Rego Style Guide (packages, rule naming, comments)</li> <li>Add <code>policy_test.rego</code> with unit tests (<code>opa test</code>)</li> <li>Add <code>metadata.yaml</code> valid per <code>tools/schemas/policy-metadata.schema.json</code></li> <li>Run local checks:</li> <li>Format: <code>opa fmt -w policies/&lt;domain&gt;/&lt;policy_id&gt;/policy.rego</code></li> <li>Validate metadata: <code>make validate</code></li> <li>Unit tests: <code>opa test -v policies</code></li> <li>If applicable, add K8s examples in <code>addons/</code>; external chart repo manages packaging.</li> <li>Update compliance maps in <code>compliance/maps/*.yml</code> if this policy contributes to coverage</li> <li>Submit PR; CI runs validate -&gt; test -&gt; bundle (if Rego present) -&gt; optionally publish on main</li> </ul>"},{"location":"policy-architecture/#consumer-path-use-a-policy","title":"Consumer path: Use a policy","text":"<p>In CI (IaC validation):</p> <ul> <li> <p>Pull the bundle from OCI and evaluate against files using Conftest or OPA:</p> </li> <li> <p>Conftest example:</p> <ul> <li>Fetch bundle artifact (e.g., using <code>oras pull</code> to <code>dist/opa-bundle.tar.gz</code>)</li> <li>Run: <code>conftest test -p dist/opa-bundle.tar.gz path/to/manifests/</code></li> </ul> </li> <li> <p>OPA example:</p> <ul> <li><code>opa eval -b dist/opa-bundle.tar.gz -i input.json \"data.rulehub.k8s.no_run_as_root.deny\"</code></li> </ul> </li> </ul> <p>In Kubernetes:</p> <ul> <li>Gatekeeper</li> <li>Apply ConstraintTemplate with embedded Rego, then create Constraint targeting resources</li> <li>Example ConstraintTemplate (excerpt):</li> </ul> <pre><code>apiVersion: templates.gatekeeper.sh/v1beta1\nkind: ConstraintTemplate\nmetadata:\n  name: k8srunasnonroot\nspec:\n  crd:\n    spec:\n      names:\n        kind: K8sRunAsNonRoot\n  targets:\n    - target: admission.k8s.gatekeeper.sh\n      rego: |\n        package k8srunasnonroot\n        violation[{\"msg\": msg}] {\n          some c\n          c := input.review.object.spec.containers[_]\n          not c.securityContext.runAsNonRoot\n          msg := \"Containers must set securityContext.runAsNonRoot=true\"\n        }\n</code></pre> <ul> <li>Example Constraint:</li> </ul> <pre><code>apiVersion: constraints.gatekeeper.sh/v1beta1\nkind: K8sRunAsNonRoot\nmetadata:\n  name: disallow-root-users\nspec:\n  match:\n    kinds:\n      - apiGroups: ['']\n        kinds: ['Pod']\n</code></pre> <ul> <li>Kyverno</li> </ul> <pre><code>apiVersion: kyverno.io/v1\nkind: ClusterPolicy\nmetadata:\n  name: disallow-root-users\nspec:\n  validationFailureAction: enforce\n  rules:\n    - name: disallow-root\n      match:\n        any:\n          - resources:\n              kinds: [Pod]\n      validate:\n        message: 'Containers must set securityContext.runAsNonRoot=true'\n        pattern:\n          spec:\n            containers:\n              - securityContext:\n                  runAsNonRoot: true\n</code></pre> <p>Optional runtime OPA: configure OPA sidecar to pull bundles from OCI registry as a bundle source (see OPA docs) and evaluate decisions through its API.</p>"},{"location":"policy-architecture/#makeci-steps-validate-test-bundle-publish","title":"Make/CI steps (validate -&gt; test -&gt; bundle -&gt; publish)","text":"<p>Make targets (see repo <code>Makefile</code>):</p> <ul> <li><code>make validate</code> - validate metadata against JSON Schema</li> <li><code>make test</code> - run Kyverno and Gatekeeper tests</li> <li><code>make opa-bundle</code> - build <code>dist/opa-bundle.tar.gz</code> from <code>policies/</code> (if <code>.rego</code> files exist)</li> <li><code>make oras-publish IMAGE=ghcr.io/rulehub/rulehub-bundle TAG=&lt;tag&gt;</code> - publish the bundle to OCI with correct mediaType</li> </ul> <p>GitHub Actions workflow <code>.github/workflows/opa-bundle-publish.yml</code> publishes on pushes to <code>main</code> and releases.</p>"},{"location":"policy-architecture/#rego-style-guide-repository-conventions","title":"Rego Style Guide (Repository Conventions)","text":"<p>This repository locks in a subset of the Styra / community style plus additional safety constraints aligned with Rego v1 parsing rules enforced by our current OPA version.</p> <p>Goals:</p> <ul> <li>Deterministic parsing across OPA minor upgrades</li> <li>Readable, uniform violation structure</li> <li>Early surfacing of logic errors (parse/type) before bundle build</li> </ul>"},{"location":"policy-architecture/#mandatory-patterns","title":"Mandatory Patterns","text":"<ol> <li>Atomic deny rules</li> </ol> <p>Prefer multiple small <code>deny[\"&lt;id&gt;\"]</code> or <code>deny[msg]</code> (fixed message form) rules over one large rule with boolean chains.</p> <ol> <li>Control (allow) rule</li> </ol> <p>Pattern for policies using an <code>allow</code> decision:</p> <pre><code>package rulehub.&lt;domain&gt;.&lt;policy_id&gt;\n\ndeny[\"&lt;short_reason&gt;\"] { &lt;atomic condition 1&gt; }\ndeny[\"&lt;other_reason&gt;\"] { &lt;atomic condition 2&gt; }\n\n# Allow when nothing denied\nallow if count(deny) == 0\n</code></pre> <p>Alternative boolean default (<code>default allow := true</code> then set <code>allow := false</code>) is discouraged for consistency.</p> <ol> <li>Formatting</li> </ol> <p>All Rego sources must pass <code>opa fmt</code> (pre-commit <code>opa-fmt</code>, CI quick check).</p> <ol> <li>Package naming</li> </ol> <p><code>package rulehub.&lt;domain&gt;.&lt;policy_id&gt;</code> (lowercase, dotted). No hyphens inside segments.</p> <ol> <li>Tests colocated</li> </ol> <p><code>policy_test.rego</code> MUST use same package (and may alias: <code>import data.rulehub.&lt;domain&gt;.&lt;policy_id&gt; as pol</code>).</p>"},{"location":"policy-architecture/#prohibited-constructs-auto-scanned","title":"Prohibited constructs (auto-scanned)","text":"<p>The quick check (<code>make opa-quick-check</code> and workflow <code>opa-quick-check.yml</code>) fails on these textual patterns:</p> <ul> <li><code>(not</code> - Parenthesized negation grouping inside composite boolean expressions.</li> <li><code>and not</code> - Inline conjunction + negation; expand to separate rule or explicit equality lines.</li> <li><code>not (</code> - Leading <code>not</code> applied to grouped expression containing <code>and</code> / <code>or</code>.</li> <li><code>not in {</code> - Negated membership; rewrite as chained inequalities or explicit whitelist set.</li> </ul> <p>Rationale: Older / stricter Rego parser modes and future optimizations reject or mis-handle certain parenthesized negations; splitting conditions keeps each violation predicate simple and avoids hidden precedence errors.</p>"},{"location":"policy-architecture/#rewrite-examples-violation-deny","title":"Rewrite examples (<code>violation[...]</code> -&gt; <code>deny[...]</code>)","text":"<p>Anti-pattern:</p> <pre><code>violation[msg] { (not input.enabled) or (not input.flag); msg := \"...\" } # example\n</code></pre> <p>Preferred:</p> <pre><code>deny[\"feature_disabled\"] { input.enabled == false }\ndeny[\"flag_missing\"] { input.flag == false }\n</code></pre> <p>Anti-pattern:</p> <pre><code>deny { input.a and not input.b }\n</code></pre> <p>Preferred:</p> <pre><code>deny[\"b_missing_when_a\"] { input.a == true; input.b == false }\n</code></pre> <p>Anti-pattern:</p> <pre><code>violation { not (input.x and input.y) }\n</code></pre> <p>Preferred: separate violations (one per missing predicate) or explicit positive checks then count(violation)==0 for allow.</p> <p>Anti-pattern:</p> <pre><code>input.status not in {\"A\",\"B\"}\n</code></pre> <p>Preferred:</p> <pre><code>input.status != \"A\"\ninput.status != \"B\"\n</code></pre> <p>or</p> <pre><code>allowed := {\"A\",\"B\"}\nnot allowed[input.status]\n</code></pre>"},{"location":"policy-architecture/#test-style","title":"Test style","text":"<p>Each test case should:</p> <ul> <li>Create a self-contained <code>input := {...}</code> object (no reliance on global state)</li> <li>Assert absence/presence of denies explicitly (<code>not pol.deny[_]</code> or <code>count(pol.deny) == N</code>)</li> <li>Cover at least one happy path and one failing path per policy</li> </ul>"},{"location":"policy-architecture/#deny-rule-normalization-patterns","title":"Deny rule normalization patterns","text":"<ol> <li>Split disjunctions (OR) across separate <code>deny[...]</code> rules.</li> <li>Convert <code>A and not B</code> into a single deny block listing both atomic lines (<code>A == true</code> and <code>B == false</code>).</li> <li>Replace negated group <code>not (A and B and C)</code> with multiple atomic deny rules (one per missing/false predicate) unless semantic meaning differs.</li> <li>Replace <code>X not in { ... }</code> with either explicit inequalities or a positive membership check plus <code>not</code> on the set (<code>allowed[X]</code> pattern) - but avoid negative set membership in a single expression.</li> </ol>"},{"location":"policy-architecture/#tooling-enforcement","title":"Tooling enforcement","text":"Check Mechanism Invocation Formatting <code>opa fmt -l</code> via pre-commit <code>opa-fmt</code> <code>pre-commit run opa-fmt</code> Forbidden patterns grep scan (see Makefile) <code>make opa-quick-check</code> Parse/type errors <code>opa check policies</code> <code>make opa-quick-check</code> deny[] rule usage scan <code>tools/deny_usage_scan.py</code> (add to CI before bundle) Unit tests <code>opa test</code> / <code>make test-gatekeeper</code> CI &amp; local <p>Violations of style should be fixed in-place rather than waived.</p>"},{"location":"policy-architecture/#quality-checklists","title":"Quality checklists","text":"<p>Rego</p> <ul> <li>Formatted (<code>opa fmt</code>), optional <code>regal</code> lint</li> <li>Clear package names: <code>rulehub.&lt;domain&gt;.&lt;policy_id&gt;</code></li> <li>Tests cover happy path and violations; no magic constants without context</li> </ul> <p>Metadata</p> <ul> <li>Valid per schema; <code>path</code> includes all relevant files</li> <li>References to standards include version/section where possible</li> </ul> <p>Bundle</p> <ul> <li>Built via <code>opa build -b policies -o dist/opa-bundle.tar.gz</code></li> <li>Contents verified with <code>tar tzf dist/opa-bundle.tar.gz</code></li> <li>Media type used for OCI: <code>application/vnd.opa.bundle.layer.v1+tar</code></li> </ul> <p>Publication</p> <ul> <li>ORAS push uses semantic or SHA tags</li> <li>Artifact annotated with repository and commit information</li> </ul> <p>Kubernetes</p> <ul> <li>Gatekeeper: provide <code>ConstraintTemplate</code> and <code>Constraint</code> examples with parameter schema where needed (use <code>deny[msg]</code>; avoid <code>violation[...]</code>)</li> <li>Kyverno: <code>validationFailureAction</code> set appropriately; include test fixtures if applicable</li> </ul>"},{"location":"policy-architecture/#references-primary-sources","title":"References (primary sources)","text":"<ul> <li>OPA Bundles &amp; distribution</li> <li>OPA Bundles</li> <li>ORAS CLI (ORAS CLI)</li> <li>Rego Style Guide</li> <li>Styra Rego Style Guide</li> <li>Gatekeeper</li> <li>Gatekeeper</li> <li>Kyverno</li> <li>Kyverno</li> <li>Conftest</li> <li>Conftest</li> </ul>"},{"location":"policy-test-quality/","title":"Policy Test Quality","text":"<p>Gatekeeper policy tests must satisfy:</p> <ul> <li>100% dual-direction (each policy has at least one failing deny assertion and one passing scenario)</li> <li>0 multi-rule inadequacies (multi-rule policies have &gt;= one deny assertion per deny rule)</li> </ul> <p>Enforced in CI via <code>make policy-test-threshold</code> (see workflow <code>policy-tests</code>). Artifacts:</p> <ul> <li><code>dist/policy-test-coverage.json</code> - machine-readable metrics</li> <li><code>dist/policy-test-priorities.md</code> - human improvement summary</li> </ul> <p>Local run:</p> <pre><code>make policy-test-coverage\nmake policy-test-threshold   # runs coverage then enforces thresholds\n</code></pre> <p>Environment overrides (integer): <code>REQUIRED_DUAL_PCT</code> (default 100), <code>ALLOW_MULTI_INADEQUATE</code> (default 0).</p>"},{"location":"policy-test-quality/#guardrails-maintenance-pipeline","title":"Guardrails &amp; Maintenance Pipeline","text":"<p>Additional automated quality gates now exist to keep tests meaningful and avoid regressions:</p> <ul> <li><code>make guardrail-generic-only</code> - fails if a policy with evidence-based deny logic has only generic control-flag deny tests.</li> <li><code>make policy-test-pairs</code> - ensures every <code>policy.rego</code> has a <code>policy_test.rego</code> and both are listed in metadata <code>path</code>.</li> <li><code>make guardrail-metadata-paths</code> - forbids bare <code>path:</code> lines (requires <code>path: []</code> placeholder or concrete list).</li> <li><code>make link-normalize-check</code> - asserts link formatting/idempotent normalization.</li> </ul> <p>Aggregate guardrail run (invoked in <code>release-check</code>):</p> <pre><code>make guardrails\n</code></pre>"},{"location":"policy-test-quality/#refactor-repair-helpers","title":"Refactor &amp; Repair Helpers","text":"<p>For large-scale policy evolution there is an end-to-end maintenance target:</p> <pre><code># Dry run refactors + repairs + pruning + normalization\nmake policy-maintenance\n\n# Apply rewriting/refactors (set APPLY=1)\nmake policy-maintenance APPLY=1\n</code></pre> <p>What it does (in order):</p> <ol> <li><code>refactor-policies</code> - convert disallowed <code>not input.foo</code> patterns to explicit     <code>input.foo == false</code> and (when APPLY=1) regenerate standardized tests.</li> <li><code>repair-tests</code> - fixes corrupted or outdated test formats.</li> <li><code>prune-generic-tests</code> - removes redundant generic-only deny tests when     evidence-specific ones exist.</li> <li><code>normalize-metadata-paths</code> - ensures empty placeholders are <code>path: []</code>.</li> <li><code>link-normalize</code> - (idempotent) link formatting &amp; CELEX canonicalization.</li> </ol> <p>Use these helpers to keep consistency after bulk additions or migrations.</p>"},{"location":"policy-title-sync-plan/","title":"Policy title sync plan","text":""},{"location":"policy-title-sync-plan/#policy-title-synchronization-plan","title":"Policy Title Synchronization Plan","text":"<p>Purpose: Replace placeholder string <code>&lt;Policy Title&gt;</code> in metadata and addon policy annotations with human\u2011readable, canonical titles. This plan lists every file still containing the placeholder, the policy id, and a proposed real title. No files are modified yet; this is a preparation step for a subsequent batch change + review.</p> <p>Conventions / Rules Applied: 1. Preserve regulatory/acronym capitalization (HIPAA, ISO, IEC, GDPR, MDR, IVDR, MHRA, DTAC, ONC, FHIR, SBOM, PMS, PSUR, EUDAMED). 2. Expand obvious context where helpful (e.g., \"21 CFR Part 11\"). 3. Use spaces and slashes for paired abbreviations (\"PMS / PSUR\"). 4. Keep wording concise; avoid trailing words like \"Requirement\" unless clarity requires. 5. Country codes (AU, CA, EU, UK, SG) retained as uppercase prefixes. 6. Where underlying abbreviation meaning could vary (e.g., MYR), chose common interpretation \"My Health Records\" (note below) - flag for reviewer confirmation.</p> <p>Legend Notes column markers: - (VERIFY) = Please confirm phrasing / expansion correctness. - (ACRONYM) = Intentional acronym kept as-is.</p> Policy ID File Path Proposed Title Notes medtech.uk_mhra_post_market_surveillance policies/medtech/uk_mhra_post_market_surveillance/metadata.yaml UK MHRA Post-Market Surveillance ACRONYM medtech.sg_hcsa_pdpa_health_data policies/medtech/sg_hcsa_pdpa_health_data/metadata.yaml SG HCSA PDPA Health Data ACRONYM medtech.uk_dtac_compliance policies/medtech/uk_dtac_compliance/metadata.yaml UK DTAC Compliance ACRONYM medtech.iso_27001_isms_scope_and_controls policies/medtech/iso_27001_isms_scope_and_controls/metadata.yaml ISO 27001 ISMS Scope and Controls ACRONYM medtech.iso_13485_document_control policies/medtech/iso_13485_document_control/metadata.yaml ISO 13485 Document Control ACRONYM medtech.log_retention_for_clinical_events policies/medtech/log_retention_for_clinical_events/metadata.yaml Log Retention for Clinical Events medtech.iso_14971_risk_management_file policies/medtech/iso_14971_risk_management_file/metadata.yaml ISO 14971 Risk Management File ACRONYM medtech.gdpr_art9_special_category_safeguards policies/medtech/gdpr_art9_special_category_safeguards/metadata.yaml GDPR Article 9 Special Category Safeguards ACRONYM medtech.onc_cures_api_fhir_r4 policies/medtech/onc_cures_api_fhir_r4/metadata.yaml ONC Cures API FHIR R4 ACRONYM medtech.onc_information_blocking_prohibited policies/medtech/onc_information_blocking_prohibited/metadata.yaml ONC Information Blocking Prohibited ACRONYM medtech.hipaa_security_tech_encryption policies/medtech/hipaa_security_tech_encryption/metadata.yaml HIPAA Security Technical Encryption ACRONYM medtech.hipaa_security_admin_safeguards policies/medtech/hipaa_security_admin_safeguards/metadata.yaml HIPAA Security Administrative Safeguards ACRONYM medtech.hitech_breach_notification_60d policies/medtech/hitech_breach_notification_60d/metadata.yaml HITECH Breach Notification (60d) ACRONYM medtech.iec_62304_scm_prp_processes policies/medtech/iec_62304_scm_prp_processes/metadata.yaml IEC 62304 SCM PRP Processes ACRONYM (VERIFY PRP) medtech.iec_62366_usability_summative_eval policies/medtech/iec_62366_usability_summative_eval/metadata.yaml IEC 62366 Usability Summative Evaluation ACRONYM medtech.iec_62304_software_safety_class policies/medtech/iec_62304_software_safety_class/metadata.yaml IEC 62304 Software Safety Class ACRONYM medtech.hipaa_access_audit_logging policies/medtech/hipaa_access_audit_logging/metadata.yaml HIPAA Access Audit Logging ACRONYM medtech.hipaa_baa_with_vendors policies/medtech/hipaa_baa_with_vendors/metadata.yaml HIPAA BAA with Vendors ACRONYM medtech.hipaa_mfa_privileged_access policies/medtech/hipaa_mfa_privileged_access/metadata.yaml HIPAA MFA Privileged Access ACRONYM medtech.fhir_smart_app_authz policies/medtech/fhir_smart_app_authz/metadata.yaml FHIR SMART App Authorization ACRONYM medtech.backup_and_recovery_rto_rpo policies/medtech/backup_and_recovery_rto_rpo/metadata.yaml Backup and Recovery RTO/RPO medtech.device_data_integrity_hashing policies/medtech/device_data_integrity_hashing/metadata.yaml Device Data Integrity Hashing medtech.dicom_network_security_basic policies/medtech/dicom_network_security_basic/metadata.yaml DICOM Network Security (Basic) ACRONYM medtech.eu_ivdr_clinical_performance policies/medtech/eu_ivdr_clinical_performance/metadata.yaml EU IVDR Clinical Performance ACRONYM medtech.eu_mdr_ce_marking_and_udi policies/medtech/eu_mdr_ce_marking_and_udi/metadata.yaml EU MDR CE Marking and UDI ACRONYM medtech.eu_mdr_clinical_evaluation policies/medtech/eu_mdr_clinical_evaluation/metadata.yaml EU MDR Clinical Evaluation ACRONYM medtech.eu_mdr_eudamed_registration policies/medtech/eu_mdr_eudamed_registration/metadata.yaml EU MDR EUDAMED Registration ACRONYM medtech.eu_mdr_pms_psur policies/medtech/eu_mdr_pms_psur/metadata.yaml EU MDR PMS / PSUR ACRONYM medtech.eu_vigilance_incident_reporting policies/medtech/eu_vigilance_incident_reporting/metadata.yaml EU Vigilance Incident Reporting medtech.fda_cybersecurity_524b_sbom policies/medtech/fda_cybersecurity_524b_sbom/metadata.yaml FDA Cybersecurity 524B SBOM ACRONYM medtech.fda_mdr_event_reporting policies/medtech/fda_mdr_event_reporting/metadata.yaml FDA MDR Event Reporting ACRONYM medtech.fda_part11_audit_trail policies/medtech/fda_part11_audit_trail/metadata.yaml FDA 21 CFR Part 11 Audit Trail ACRONYM medtech.fda_part11_esign_linkage policies/medtech/fda_part11_esign_linkage/metadata.yaml FDA 21 CFR Part 11 e-Sign Linkage ACRONYM medtech.fda_part11_system_validation policies/medtech/fda_part11_system_validation/metadata.yaml FDA 21 CFR Part 11 System Validation ACRONYM medtech.health_data_cross_border_controls policies/medtech/health_data_cross_border_controls/metadata.yaml Health Data Cross-Border Controls medtech.au_myr_health_privacy policies/medtech/au_myr_health_privacy/metadata.yaml AU My Health Records Privacy VERIFY (MyHR?) medtech.ca_phipa_health_data policies/medtech/ca_phipa_health_data/metadata.yaml CA PHIPA Health Data ACRONYM <p>Addon Kyverno Policies (annotation rulehub.title): same title mapping applies - update <code>addons/kyverno/policies/*-policy.yaml</code> entries where <code>rulehub.title: &lt;Policy Title&gt;</code> using the Proposed Title derived above (replace <code>medtech-&lt;rest&gt;</code> hyphenated id segments with the matching metadata id's Proposed Title).</p> <p>Next Steps (Implementation Outline): 1. Approve / adjust any titles flagged (VERIFY). 2. Batch update metadata.yaml <code>name:</code> fields and Kyverno annotation <code>rulehub.title</code>. 3. Run <code>make validate-metadata-schema</code> and any index/build steps (<code>make catalog</code>) to ensure no regressions. 4. Commit with message: \"feat: sync policy titles (replace  placeholders)\". <p>Review Checklist Before Applying Changes: - [ ] All placeholders enumerated (search <code>&lt;Policy Title&gt;</code> now returns 0 after change except in templates). - [ ] Acronyms retain intended capitalization. - [ ] No unintended semantic drift (e.g., regulatory scope changes). - [ ] Template placeholders in <code>templates/policy/</code> remain untouched.</p> <p>Prepared: automated assist plan (no modifications yet).</p>"},{"location":"references-index/","title":"References Index (Generated)","text":"<p>This file is auto-generated from policy metadata. Do not edit manually.</p> Policy ID Regions Countries Scope Sources <code>aml.address_verification</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026www.eba.europa.eu/sites/default/files/document_library/Publications/G\u2026www.legislation.gov.uk/eudr/2015/849/article/13 <code>aml.high_risk_country_edd</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026www.legislation.gov.uk/eudr/2015/849/article/18a <code>aml.kyc_basic_cdd</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026www.legislation.gov.uk/eudr/2015/849/article/13eur-lex.europa.eu/legal-content/EN/TXT/ <code>aml.minimum_age</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026www.legislation.gov.uk/eudr/2015/849/article/13 <code>aml.pep_screening_required</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026www.legislation.gov.uk/eudr/2015/849/article/20 <code>aml.sanctions_check</code> Global * Global data.europa.eu/data/datasets/consolidated-list-of-persons-groups-and-\u2026main.un.org/securitycouncil/en/content/un-sc-consolidated-listwww.fatf-gafi.org/en/publications/Fatf-recommendations/Bpp-finsanctio\u2026 <code>aml.txn_monitoring_thresholds</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026www.legislation.gov.uk/eudr/2015/849/article/33 <code>aml.ubo_identification</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026www.legislation.gov.uk/eudr/2015/849/article/13www.legislation.gov.uk/eudr/2015/849/article/3 <code>betting.adr_provider_listed_uk</code> Global * Global www.gamblingcommission.gov.uk/for-gambling-businesses/for-gambling-bu\u2026 <code>betting.ads_bonus_terms_fair_clear</code> Global * Global www.gov.uk/government/organisations/competition-and-markets-authoritywww.gamblingcommission.gov.uk/ <code>betting.ads_no_minors_targeting</code> Global * Global www.asa.org.uk/codes-and-rulings/advertising-codes.html <code>betting.affordability_checks_uk</code> Europe UK National www.gamblingcommission.gov.uk/ <code>betting.age_verification_before_gambling_uk</code> Global * Global www.gamblingcommission.gov.uk/ <code>betting.aml_high_risk_country_restrictions</code> Global * Global www.fatf-gafi.org/ <code>betting.aml_sar_reporting_uk</code> Global * Global www.nationalcrimeagency.gov.uk/what-we-do/crime-threats/money-launder\u2026 <code>betting.au_iga_no_prohibited_services</code> Global AU AU www.legislation.gov.au/Series/C2004A00771www.acma.gov.au/interactive-gambling <code>betting.complaints_process_published</code> Global * Global www.gamblingcommission.gov.uk/ <code>betting.credit_card_gambling_ban_uk</code> Global * Global www.gamblingcommission.gov.uk/ <code>betting.data_integrity_audits</code> Global * Global ibia.bet/ <code>betting.deposit_limit_controls</code> Global * Global www.gamblingcommission.gov.uk/anj.fr/ <code>betting.game_rules_visible_before_play</code> Global * Global www.gamblingcommission.gov.uk/ <code>betting.geofencing_regulated_markets</code> Global * Global www.gamblingcommission.gov.uk/ <code>betting.in_play_delay_controls</code> Europe EU, EEA, UK, MT Regional www.gamblingcommission.gov.uk/www.mga.org.mt/ <code>betting.kyc_on_withdrawal</code> Global * Global www.mga.org.mt/www.gamblingcommission.gov.uk/ <code>betting.kyc_onboarding</code> Europe EU, EEA, UK Regional eur-lex.europa.eu/legal-content/EN/TXT/ <code>betting.license_check_adm_it</code> Global * Global www.adm.gov.it/portale/ <code>betting.license_check_agco_on</code> Global * Global www.agco.ca/igamingigamingontario.ca/ <code>betting.license_check_anj_fr</code> Global * Global anj.fr/ <code>betting.license_check_au_nt</code> APAC AU-NT State nt.gov.au/ <code>betting.license_check_brazil_14790</code> LatAm BR National www.planalto.gov.br/ccivil_03/_ato2023-2026/2023/lei/L14790.htm <code>betting.license_check_ca_on_igaming</code> North America CA-ON Province www.agco.ca/igaming <code>betting.license_check_coljuegos_co</code> LatAm CO National www.coljuegos.gov.co/ <code>betting.license_check_dgoj_es</code> Global * Global www.ordenacionjuego.es/en <code>betting.license_check_ggl_de</code> Global * Global www.gluecksspiel-behoerde.de/ <code>betting.license_check_gra_sg</code> APAC SG National www.gra.gov.sg/ <code>betting.license_check_ksa_nl</code> Global * Global kansspelautoriteit.nl/ <code>betting.license_check_mga</code> Global * Global www.mga.org.mt/ <code>betting.license_check_spelinspektionen_se</code> Global * Global www.spelinspektionen.se/ <code>betting.license_check_spillemyndigheden_dk</code> Global * Global www.spillemyndigheden.dk/ <code>betting.license_check_ukgc</code> Global * Global www.gamblingcommission.gov.uk/ <code>betting.license_check_us_co_division</code> North America US-CO State sbg.colorado.gov/ <code>betting.license_check_us_nj_dge</code> Global * Global www.nj.gov/oag/ge/ <code>betting.license_check_us_nv_ngcb</code> Global * Global gaming.nv.gov/ <code>betting.license_check_us_pa_pgcb</code> Global * Global gamingcontrolboard.pa.gov/ <code>betting.loss_limit_controls</code> Global * Global www.spelinspektionen.se/www.spillemyndigheden.dk/ <code>betting.market_restrictions_youth</code> Europe EU, EEA, FR Regional anj.fr/ <code>betting.match_fixing_monitoring</code> Global * Global ibia.bet/sportradar.com/ <code>betting.no_bets_by_participants</code> Global * Global www.gamblingcommission.gov.uk/ <code>betting.official_data_only</code> Global * Global www.gamblingcommission.gov.uk/ <code>betting.ongoing_aml_monitoring</code> Global * Global eur-lex.europa.eu/www.gamblingcommission.gov.uk/ <code>betting.player_funds_segregation</code> Global * Global www.gamblingcommission.gov.uk/kansspelautoriteit.nl/ <code>betting.reality_checks_elapsed_time</code> Global * Global www.gamblingcommission.gov.uk/ <code>betting.reverse_withdrawal_ban_uk</code> Global * Global www.gamblingcommission.gov.uk/ <code>betting.rng_certification_gli11</code> Global * Global gaminglabs.com/gli-standards/ <code>betting.rtp_disclosure_to_players</code> Global * Global www.gamblingcommission.gov.uk/ <code>betting.safer_gambling_interactions</code> Global * Global www.gamblingcommission.gov.uk/ <code>betting.sanctions_screening_global</code> Global * Global sanctionssearch.ofac.treas.gov/www.eeas.europa.eu/_en <code>betting.self_exclusion_de_oasis</code> Global * Global www.gluecksspiel-behoerde.de/www.gluecksspiel-behoerde.de/de/aufsicht/oasis <code>betting.self_exclusion_dk_rofus</code> Europe DK National www.spillemyndigheden.dk/www.spillemyndigheden.dk/en/rofus <code>betting.self_exclusion_es_rgiaj</code> Global * Global www.ordenacionjuego.es/enwww.ordenacionjuego.es/en/rgiaj <code>betting.self_exclusion_nl_cruks</code> Global * Global kansspelautoriteit.nl/cruksregister.nl/ <code>betting.self_exclusion_on_igaming</code> Global * Global www.agco.ca/igamingigamingontario.ca/en <code>betting.self_exclusion_se_spelpaus</code> Global * Global www.spelinspektionen.se/www.spelpaus.se/ <code>betting.self_exclusion_uk_gamstop</code> Global * Global www.gamstop.co.uk/for-operatorswww.gamblingcommission.gov.uk/ <code>betting.session_time_limits_controls</code> Global * Global www.anj.fr/www.gamblingcommission.gov.uk/ <code>betting.slots_min_spin_speed_uk</code> Global * Global www.gamblingcommission.gov.uk/ <code>betting.slots_no_autoplay_uk</code> Global * Global www.gamblingcommission.gov.uk/ <code>betting.slots_no_losses_disguised_as_wins</code> Global * Global www.gamblingcommission.gov.uk/ <code>betting.source_of_funds_checks</code> Global * Global www.gamblingcommission.gov.uk/ <code>betting.source_of_funds_thresholds</code> Europe UK National www.gamblingcommission.gov.uk/ <code>betting.suspicious_betting_reporting_uk</code> Europe UK National www.gamblingcommission.gov.uk/ <code>betting.txn_monitoring_anomalies</code> Global * Global www.fatf-gafi.org/ <code>edtech.au_app_11_security_edtech</code> Global * Global www.oaic.gov.au/privacy/australian-privacy-principles <code>edtech.au_app_5_notice_edtech</code> Global * Global www.oaic.gov.au/privacy/australian-privacy-principles <code>edtech.au_ndb_breach_notification_edtech</code> Global * Global www.oaic.gov.au/privacy/notifiable-data-breaches <code>edtech.br_lgpd_children_consent_best_interest</code> Global * Global www.planalto.gov.br/ccivil_03/_ato2019-2022/2018/lei/L13709.htm <code>edtech.ca_pipeda_consent_edtech</code> Global * Global laws-lois.justice.gc.ca/eng/acts/P-8.6/ <code>edtech.ca_sopipa_no_sale_of_student_data</code> Global * Global leginfo.legislature.ca.gov/faces/codes_displayText.xhtml <code>edtech.ca_sopipa_no_targeted_advertising</code> Global * Global leginfo.legislature.ca.gov/faces/codes_displayText.xhtml <code>edtech.co_student_data_transparency</code> Global * Global coag.gov/office-sections/consumer-protection/student-data-privacy/ <code>edtech.coppa_data_minimization</code> Global * Global www.ftc.gov/legal-library/browse/rules/childrens-online-privacy-prote\u2026 <code>edtech.coppa_delete_on_parent_request</code> Global * Global www.ftc.gov/legal-library/browse/rules/childrens-online-privacy-prote\u2026 <code>edtech.coppa_parental_consent_under_13</code> Global * Global www.ftc.gov/legal-library/browse/rules/childrens-online-privacy-prote\u2026 <code>edtech.ct_student_data_privacy</code> Global * Global portal.ct.gov/AG/Childrens-Issues/Children-Privacy/Student-Privacy <code>edtech.edtech_access_least_privilege</code> Global * Global csrc.nist.gov/publications/detail/sp/800-53/rev-5/final <code>edtech.edtech_audit_logs_student_record_access</code> Global * Global csrc.nist.gov/publications/detail/sp/800-92/final <code>edtech.edtech_encryption_at_rest</code> Global * Global csrc.nist.gov/pubs/sp/800/53/r5/upd1/final <code>edtech.edtech_encryption_in_transit</code> Global * Global csrc.nist.gov/pubs/sp/800/52/r2/final <code>edtech.edtech_retention_after_course_completion</code> Global * Global www.iso.org/standard/62542.html <code>edtech.eu_dpia_high_risk_edtech</code> Global * Global eur-lex.europa.eu/eli/reg/2016/679/oj <code>edtech.eu_eprivacy_cookie_consent_edtech</code> Global * Global eur-lex.europa.eu/eli/dir/2002/58/oj <code>edtech.eu_gdpr_minors_consent_education</code> Global * Global eur-lex.europa.eu/eli/reg/2016/679/oj <code>edtech.eu_scc_transfers_edplatform</code> Global * Global eur-lex.europa.eu/eli/dec_impl/2021/914/oj <code>edtech.ferpa_consent_or_exception_for_disclosure</code> Global * Global studentprivacy.ed.gov/www.ecfr.gov/current/title-34/part-99/subpart-D <code>edtech.ferpa_directory_info_optout_respected</code> Global * Global studentprivacy.ed.gov/ <code>edtech.ferpa_parent_access_rights</code> Global * Global studentprivacy.ed.gov/www.ecfr.gov/current/title-34/subtitle-A/part-99 <code>edtech.il_soppa_breach_notification</code> Global * Global www.ilga.gov/legislation/ilcs/ilcs3.asp <code>edtech.in_dpdpa_children_verifiable_consent</code> Global * Global egazette.nic.in/WriteReadData/2023/248775.pdf <code>edtech.kr_pipa_guardian_consent_under_14</code> Global * Global www.pipc.go.kr/eng/ <code>edtech.ny_edlaw2d_encryption_and_contracts</code> Global * Global www.nysed.gov/common/nysed/files/programs/student-data-privacy/2d-law\u2026www.nysed.gov/data-privacy-security/laws-regulations <code>edtech.nz_notice_at_collection_edtech</code> Global * Global www.privacy.org.nz/your-rights/privacy-principles/ <code>edtech.ppra_parental_consent_sensitive_surveys</code> Global * Global studentprivacy.ed.gov/resources/ppra-general-guidance <code>edtech.uk_aadc_privacy_by_default</code> Global * Global ico.org.uk/for-organisations/childrens-code-design-guidance/ <code>edtech.uk_aadc_profiling_and_geolocation_off</code> Global * Global ico.org.uk/for-organisations/childrens-code-design-guidance/ <code>fintech.aml_account_freeze_on_hit</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026eur-lex.europa.eu/legal-content/EN/TXT/ <code>fintech.aml_adverse_media_screening</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026eur-lex.europa.eu/legal-content/EN/TXT/ <code>fintech.aml_customer_risk_tiering</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026eur-lex.europa.eu/legal-content/EN/TXT/ <code>fintech.aml_duplicate_account_detection</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026eur-lex.europa.eu/legal-content/EN/TXT/ <code>fintech.aml_geolocation_restrictions</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026eur-lex.europa.eu/legal-content/EN/TXT/ <code>fintech.aml_manual_review_queue</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026eur-lex.europa.eu/legal-content/EN/TXT/ <code>fintech.aml_ongoing_monitoring</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026eur-lex.europa.eu/legal-content/EN/TXT/ <code>fintech.aml_pep_periodic_review</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026eur-lex.europa.eu/legal-content/EN/TXT/ <code>fintech.aml_pep_screening</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026eur-lex.europa.eu/legal-content/EN/TXT/ <code>fintech.aml_risk_scoring_model</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026eur-lex.europa.eu/legal-content/EN/TXT/ <code>fintech.aml_sanctions_rescreening_frequency</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026eur-lex.europa.eu/legal-content/EN/TXT/ <code>fintech.aml_sanctions_screening</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026eur-lex.europa.eu/legal-content/EN/TXT/ofac.treasury.gov/sanctions-programs-and-country-information <code>fintech.aml_transaction_velocity_limits</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026eur-lex.europa.eu/legal-content/EN/TXT/ <code>fintech.aml_unusual_activity_alerting</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026eur-lex.europa.eu/legal-content/EN/TXT/ <code>fintech.aml_watchlist_management</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026eur-lex.europa.eu/legal-content/EN/TXT/ <code>fintech.bitlicense_compliance</code> North America US-NY State www.dfs.ny.gov/industry_guidance/virtual_currency_businesses <code>fintech.card_tokenization_required</code> Global * Global www.pcisecuritystandards.org/document_librarywww.emvco.com/emv-technologies/3d-secure/ <code>fintech.chain_analysis_risk_controls</code> Global * Global eur-lex.europa.eu/eli/reg/2023/1114/ojwww.fatf-gafi.org/en/publications/Fatf-recommendations/Guidance-R16-t\u2026 <code>fintech.chargeback_monitoring</code> Global * Global www.pcisecuritystandards.org/document_librarywww.emvco.com/emv-technologies/3d-secure/ <code>fintech.cold_storage_ratio</code> Global * Global eur-lex.europa.eu/eli/reg/2023/1114/ojwww.fatf-gafi.org/en/publications/Fatf-recommendations/Guidance-R16-t\u2026 <code>fintech.custody_asset_segregation</code> Global * Global eur-lex.europa.eu/eli/reg/2023/1114/ojwww.fatf-gafi.org/en/publications/Fatf-recommendations/Guidance-R16-t\u2026 <code>fintech.device_fingerprinting</code> Global * Global www.pcisecuritystandards.org/document_librarywww.emvco.com/emv-technologies/3-d-secure/ <code>fintech.fapi_compliance</code> Global * Global openid.net/specs/ <code>fintech.fraud_velocity_checks</code> Global * Global www.pcisecuritystandards.org/document_librarywww.emvco.com/emv-technologies/3d-secure/ <code>fintech.geofencing_restricted_markets</code> Global * Global www.pcisecuritystandards.org/document_librarywww.emvco.com/emv-technologies/3d-secure/ <code>fintech.hot_wallet_limits</code> Global * Global eur-lex.europa.eu/eli/reg/2023/1114/ojwww.fatf-gafi.org/en/publications/Fatf-recommendations/Guidance-R16-t\u2026 <code>fintech.ip_geolocation_consistency</code> Global * Global www.pcisecuritystandards.org/document_librarywww.emvco.com/emv-technologies/3d-secure/ <code>fintech.jwt_expiry_policy</code> Global * Global datatracker.ietf.org/doc/html/rfc7519 <code>fintech.kyc_biometric_liveness</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026eur-lex.europa.eu/legal-content/EN/TXT/ <code>fintech.kyc_document_verification</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026eur-lex.europa.eu/legal-content/EN/TXT/ <code>fintech.kyc_reverification_schedule</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026eur-lex.europa.eu/legal-content/EN/TXT/ <code>fintech.kyc_source_of_funds</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026eur-lex.europa.eu/legal-content/EN/TXT/ <code>fintech.kyc_source_of_wealth</code> Global * Global www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommend\u2026eur-lex.europa.eu/legal-content/EN/TXT/ <code>fintech.mcc_whitelisting</code> Global * Global www.pcisecuritystandards.org/document_librarywww.emvco.com/emv-technologies/3-d-secure/ <code>fintech.mtls_required</code> Global * Global datatracker.ietf.org/doc/html/rfc8705 <code>fintech.oauth2_pkce_required</code> Global * Global datatracker.ietf.org/doc/html/rfc7636 <code>fintech.ob_audit_logging</code> Global * Global www.openbanking.org.uk/openid.net/specs/openid-connect-core-1_0.html <code>fintech.ob_consent_expiry_90d</code> Europe UK National www.openbanking.org.uk/openid.net/specs/openid-connect-core-1_0.html <code>fintech.ob_consent_revocation</code> Global * Global www.openbanking.org.uk/openid.net/specs/openid-connect-core-1_0.html <code>fintech.ob_data_minimization</code> Global * Global www.openbanking.org.uk/openid.net/specs/openid-connect-core-1_0.html <code>fintech.ob_rate_limits</code> Global * Global www.openbanking.org.uk/openid.net/specs/openid-connect-core-1_0.html <code>fintech.ob_tpp_eidas_cert_validation</code> Europe EU, EEA Regional eur-lex.europa.eu/eli/reg/2014/910/oj <code>fintech.pan_masking_in_logs</code> Global * Global www.pcisecuritystandards.org/document_librarywww.emvco.com/emv-technologies/3-d-secure/ <code>fintech.pci_account_lockout</code> Global * Global www.pcisecuritystandards.org/document_library <code>fintech.pci_default_passwords_changed</code> Global * Global www.pcisecuritystandards.org/document_library <code>fintech.pci_file_integrity_monitoring</code> Global * Global www.pcisecuritystandards.org/document_library <code>fintech.pci_https_only</code> Global * Global www.pcisecuritystandards.org/document_library <code>fintech.pci_key_management</code> Global * Global www.pcisecuritystandards.org/document_library <code>fintech.pci_log_retention</code> Global * Global www.pcisecuritystandards.org/document_library <code>fintech.pci_malware_protection</code> Global * Global www.pcisecuritystandards.org/document_library <code>fintech.pci_mfa_required</code> Global * Global www.pcisecuritystandards.org/document_library <code>fintech.pci_network_segmentation</code> Global * Global www.pcisecuritystandards.org/document_library <code>fintech.pci_pan_masking_in_logs</code> Global * Global www.pcisecuritystandards.org/document_library <code>fintech.pci_secure_coding_practices</code> Global * Global www.pcisecuritystandards.org/document_library <code>fintech.pci_session_timeout</code> Global * Global www.pcisecuritystandards.org/document_library <code>fintech.pci_storage_encryption</code> Global * Global www.pcisecuritystandards.org/document_library <code>fintech.pci_tls_min_version</code> Global * Global www.pcisecuritystandards.org/document_library <code>fintech.pci_vulnerability_scanning</code> Global * Global www.pcisecuritystandards.org/document_library <code>fintech.proof_of_reserves_reporting</code> Global * Global eur-lex.europa.eu/eli/reg/2023/1114/ojwww.fatf-gafi.org/en/publications/Fatf-recommendations/Guidance-R16-t\u2026 <code>fintech.psd2_sca</code> Europe EU EU eur-lex.europa.eu/legal-content/EN/TXT/www.styra.com/opa-rego-style-guide/ <code>fintech.psd2_sca_enforced</code> Europe EU, EEA Regional eur-lex.europa.eu/legal-content/EN/TXT/eur-lex.europa.eu/eli/reg_del/2018/389/oj <code>fintech.psd2_sca_exemptions_controls</code> Europe EU, EEA Regional eur-lex.europa.eu/legal-content/EN/TXT/eur-lex.europa.eu/eli/reg_del/2018/389/oj <code>fintech.psd2_transaction_risk_analysis</code> Europe EU, EEA Regional eur-lex.europa.eu/legal-content/EN/TXT/eur-lex.europa.eu/eli/reg_del/2018/389/oj <code>fintech.rbi_ekyc_risk</code> APAC IN IN www.rbi.org.in/ <code>fintech.stablecoin_reserve_ratio</code> Europe EU, EEA Regional eur-lex.europa.eu/eli/reg/2023/1114/ojwww.fatf-gafi.org/en/publications/Fatf-recommendations/Guidance-R16-t\u2026 <code>fintech.three_ds_required</code> Global * Global www.pcisecuritystandards.org/document_librarywww.emvco.com/emv-technologies/3-d-secure/ <code>fintech.transaction_limits_per_risk</code> Global * Global www.pcisecuritystandards.org/document_librarywww.emvco.com/emv-technologies/3-d-secure/ <code>fintech.travel_rule_compliance</code> Global * Global eur-lex.europa.eu/eli/reg/2023/1114/ojwww.fatf-gafi.org/en/publications/Fatf-recommendations/Guidance-R16-t\u2026 <code>fintech.us_mtl_license</code> North America US US www.upguard.com/blog/cybersecurity-regulations-financial-industrywww.fincen.gov/msb-state-law-regulatory-framework <code>fintech.vasp_license_required</code> Global * Global eur-lex.europa.eu/eli/reg/2023/1114/ojwww.fatf-gafi.org/en/publications/Fatf-recommendations/Guidance-R16-t\u2026 <code>fintech.withdrawal_address_whitelist</code> Global * Global eur-lex.europa.eu/eli/reg/2023/1114/ojwww.fatf-gafi.org/en/publications/Fatf-recommendations/Guidance-R16-t\u2026 <code>fintech.xs2a_api_security</code> Global * Global www.openbanking.org.uk/openid.net/specs/openid-connect-core-1_0.html <code>gdpr.consent_required</code> Europe EU EU eur-lex.europa.eu/eli/reg/2016/679/ojwww.legislation.gov.uk/eudr/2016/679/article/6www.legislation.gov.uk/eudr/2016/679/article/7 <code>gdpr.data_minimization</code> Europe EU EU eur-lex.europa.eu/eli/reg/2016/679/ojwww.legislation.gov.uk/eudr/2016/679/article/5 <code>gdpr.data_retention</code> Europe EU EU eur-lex.europa.eu/eli/reg/2016/679/ojwww.legislation.gov.uk/eudr/2016/679/article/5 <code>igaming.deposit_limit_controls</code> Europe EU, EEA, UK Regional www.gamblingcommission.gov.uk/ <code>igaming.geofencing_regulated_markets</code> Global * Global www.gamblingcommission.gov.uk/ <code>igaming.license_check_adm_it</code> Europe IT National www.adm.gov.it/portale/ <code>igaming.license_check_anj_fr</code> Europe FR National anj.fr/ <code>igaming.license_check_dgoj_es</code> Europe ES National www.ordenacionjuego.es/en <code>igaming.license_check_ukgc</code> Europe UK National www.gamblingcommission.gov.uk/ <code>igaming.license_check_us_nj_dge</code> North America US-NJ State www.nj.gov/oag/ge/ <code>igaming.license_check_us_nv_ngcb</code> North America US-NV State www.gaming.nv.gov/ <code>igaming.license_check_us_pa_pgcb</code> North America US-PA State gamingcontrolboard.pa.gov/ <code>igaming.self_exclusion_uk_gamstop</code> Europe UK National www.gamstop.co.uk/for-operators <code>k8s.ban_hostnetwork</code> Global * Global kubernetes.io/docs/concepts/security/pod-security-standards/ <code>k8s.block_hostpath</code> Global * Global kubernetes.io/docs/concepts/security/pod-security-standards/kubernetes.io/docs/concepts/storage/volumes/ <code>k8s.disallow_latest</code> Global * Global kubernetes.io/docs/concepts/containers/images/kubernetes.io/docs/concepts/security/security-checklist/ <code>k8s.limit_capabilities</code> Global * Global kubernetes.io/docs/concepts/security/pod-security-standards/kubernetes.io/docs/tasks/configure-pod-container/security-context/ <code>k8s.no_privileged</code> Global * Global kubernetes.io/docs/concepts/security/pod-security-standards/kubernetes.io/docs/tasks/configure-pod-container/security-context/ <code>k8s.no_run_as_root</code> Global * Global kubernetes.io/docs/concepts/security/pod-security-standards/kubernetes.io/docs/tasks/configure-pod-container/security-context/ <code>k8s.require_imagepullpolicy_always</code> Global * Global kubernetes.io/docs/concepts/containers/images/kubernetes.io/docs/reference/generated/kubernetes-api/v1.32/ <code>k8s.require_resources</code> Global * Global kubernetes.io/docs/concepts/configuration/manage-resources-containers/kubernetes.io/docs/tasks/administer-cluster/manage-resources/memory-d\u2026 <code>legaltech.aba_model_rule_1_6_confidentiality</code> North America US Federal www.americanbar.org/groups/professional_responsibility/publications/m\u2026 <code>legaltech.ae_pdpl_consent_notice</code> Global * Global u.ae/en/about-the-uae/digital-uae/data/data-protection-law <code>legaltech.au_app_notice_at_collection</code> Global * Global www.oaic.gov.au/privacy/australian-privacy-principles <code>legaltech.ca_qc_law25_privacy_governance</code> Global * Global www.legisquebec.gouv.qc.ca/en/document/cs/p-39.1 <code>legaltech.ccpa_notice_at_collection</code> Global * Global oag.ca.gov/privacy/ccpa <code>legaltech.ccpa_opt_out_enabled</code> Global * Global cppa.ca.gov/oag.ca.gov/privacy/ccpa <code>legaltech.ccpa_verification_of_requests</code> Global * Global oag.ca.gov/privacy/ccpa <code>legaltech.ch_fadp_records_of_processing</code> Global * Global www.fedlex.admin.ch/eli/cc/2022/491/en <code>legaltech.cpra_sensitive_data_limited_use</code> Global * Global cppa.ca.gov/ <code>legaltech.data_residency_requirements_enforced</code> Global * Global www.iso.org/standard/27001.html <code>legaltech.ediscovery_frcp_26_34_37</code> North America US Federal www.law.cornell.edu/rules/frcp/rule_26 <code>legaltech.encryption_at_rest_enabled</code> Global * Global csrc.nist.gov/publications/detail/sp/800-53/rev-5/final <code>legaltech.encryption_in_transit_enabled</code> Global * Global csrc.nist.gov/pubs/sp/800/52/r2/final <code>legaltech.gdpr_breach_72h</code> Global * Global eur-lex.europa.eu/eli/reg/2016/679/oj <code>legaltech.gdpr_consent_valid</code> Global * Global eur-lex.europa.eu/eli/reg/2016/679/oj <code>legaltech.gdpr_cookie_consent_eprivacy</code> Global * Global eur-lex.europa.eu/eli/dir/2002/58/oj <code>legaltech.gdpr_data_minimization</code> Global * Global eur-lex.europa.eu/eli/reg/2016/679/oj <code>legaltech.gdpr_dpia_required_high_risk</code> Global * Global eur-lex.europa.eu/eli/reg/2016/679/oj <code>legaltech.gdpr_dsar_timeline_30d</code> Global * Global eur-lex.europa.eu/eli/reg/2016/679/oj <code>legaltech.gdpr_lawful_basis_required</code> Global * Global eur-lex.europa.eu/eli/reg/2016/679/oj <code>legaltech.gdpr_records_of_processing</code> Global * Global eur-lex.europa.eu/eli/reg/2016/679/oj <code>legaltech.gdpr_retention_limit</code> Global * Global eur-lex.europa.eu/eli/reg/2016/679/oj <code>legaltech.gdpr_transfer_scc</code> Global * Global eur-lex.europa.eu/eli/dec_impl/2021/914/oj <code>legaltech.id_pdp_cross_border_transfer</code> Global * Global jdih.setneg.go.id/ <code>legaltech.kr_pipa_breach_notification</code> Global * Global www.pipc.go.kr/eng/ <code>legaltech.legal_hold_no_delete_enforced</code> Global * Global www.law.cornell.edu/rules/frcp/rule_37 <code>legaltech.lgpd_brazil_compliance</code> Global * Global www.planalto.gov.br/ccivil_03/_ato2019-2022/2018/lei/L13709.htm <code>legaltech.mx_lfpdppp_notice_at_collection</code> Global * Global www.diputados.gob.mx/LeyesBiblio/pdf/LFPDPPP.pdf <code>legaltech.my_pdpa_retention_principle</code> Global * Global www.malaysia.gov.my/portal/content/654 <code>legaltech.nz_breach_notification</code> Global * Global www.privacy.org.nz/for-organisations/privacy-breaches/ <code>legaltech.pdpa_sg_consent_purposes</code> Global * Global sso.agc.gov.sg/Act/PDPA2012 <code>legaltech.pipeda_ca_consent</code> Global * Global laws-lois.justice.gc.ca/eng/acts/P-8.6/ <code>legaltech.pipl_cn_cross_border_assessment</code> Global * Global www.npc.gov.cn/englishnpc/ <code>legaltech.popia_za_security_measures</code> Global * Global www.justice.gov.za/inforeg/ <code>legaltech.records_classification_scheme_applied</code> Global * Global www.iso.org/standard/62542.html <code>legaltech.sa_pdpl_breach_notify</code> Global * Global sdaia.gov.sa/ <code>legaltech.th_pdpa_breach_notify</code> Global * Global www.pdpc.or.th/en/home/ <code>legaltech.tr_kvkk_verbis_registration</code> Global * Global verbis.kvkk.gov.tr/ <code>legaltech.uk_gdpr_minor_consent</code> Global * Global ico.org.uk/ <code>legaltech.vn_pdpd_notice_and_consent</code> Global * Global www.mps.gov.vn/ <code>medtech.au_myr_health_privacy</code> Global * Global www.health.gov.au/initiatives-and-programs/my-health-recordwww.legislation.gov.au/Series/C2012A00063 <code>medtech.backup_and_recovery_rto_rpo</code> Global * Global www.iso.org/standard/44379.html <code>medtech.ca_phipa_health_data</code> Global * Global www.ontario.ca/laws/statute/04p03 <code>medtech.device_data_integrity_hashing</code> Global * Global www.fda.gov/medical-devices/digital-health-center-excellence/cybersec\u2026 <code>medtech.dicom_network_security_basic</code> Global * Global www.dicomstandard.org/ <code>medtech.eu_ivdr_clinical_performance</code> Global * Global eur-lex.europa.eu/eli/reg/2017/746/oj <code>medtech.eu_mdr_ce_marking_and_udi</code> Global * Global eur-lex.europa.eu/eli/reg/2017/745/oj <code>medtech.eu_mdr_clinical_evaluation</code> Global * Global eur-lex.europa.eu/eli/reg/2017/745/oj <code>medtech.eu_mdr_eudamed_registration</code> Global * Global ec.europa.eu/health/medical-devices-eudamed/overview_en <code>medtech.eu_mdr_pms_psur</code> Global * Global eur-lex.europa.eu/eli/reg/2017/745/oj <code>medtech.eu_vigilance_incident_reporting</code> Global * Global health.ec.europa.eu/medical-devices-sector/new-regulations/guidance-a\u2026 <code>medtech.fda_cybersecurity_524b_sbom</code> Global * Global www.fda.gov/medical-devices/digital-health-center-excellence/cybersec\u2026 <code>medtech.fda_mdr_event_reporting</code> Global * Global www.ecfr.gov/current/title-21/chapter-I/subchapter-H/part-803 <code>medtech.fda_part11_audit_trail</code> Global * Global www.ecfr.gov/current/title-21/chapter-I/subchapter-A/part-11 <code>medtech.fda_part11_esign_linkage</code> Global * Global www.ecfr.gov/current/title-21/chapter-I/subchapter-A/part-11 <code>medtech.fda_part11_system_validation</code> Global * Global www.ecfr.gov/current/title-21/chapter-I/subchapter-A/part-11 <code>medtech.fhir_smart_app_authz</code> Global * Global hl7.org/fhir/smart-app-launch/ <code>medtech.gdpr_art9_special_category_safeguards</code> Global * Global eur-lex.europa.eu/eli/reg/2016/679/ojeur-lex.europa.eu/eli/reg/2016/679/oj <code>medtech.health_data_cross_border_controls</code> Global * Global eur-lex.europa.eu/eli/dec_impl/2021/914/ojwww.hhs.gov/hipaa/ <code>medtech.hipaa_access_audit_logging</code> Global * Global www.hhs.gov/hipaa/for-professionals/security/index.html <code>medtech.hipaa_baa_with_vendors</code> Global * Global www.hhs.gov/hipaa/for-professionals/covered-entities/sample-business-\u2026 <code>medtech.hipaa_mfa_privileged_access</code> Global * Global www.hhs.gov/hipaa/for-professionals/security/index.html <code>medtech.hipaa_minimum_necessary</code> Global * Global www.hhs.gov/hipaa/for-professionals/privacy/guidance/minimum-necessar\u2026 <code>medtech.hipaa_security_admin_safeguards</code> Global * Global www.hhs.gov/hipaa/for-professionals/security/index.html <code>medtech.hipaa_security_tech_encryption</code> Global * Global www.hhs.gov/hipaa/for-professionals/security/index.html <code>medtech.hitech_breach_notification_60d</code> Global * Global www.hhs.gov/hipaa/for-professionals/breach-notification/index.html <code>medtech.iec_62304_scm_prp_processes</code> Global * Global webstore.iec.ch/en/publication/24950 <code>medtech.iec_62304_software_safety_class</code> Global * Global webstore.iec.ch/en/publication/24950 <code>medtech.iec_62366_usability_summative_eval</code> Global * Global webstore.iec.ch/en/publication/26023 <code>medtech.iso_13485_document_control</code> Global * Global www.iso.org/standard/59752.html <code>medtech.iso_14971_risk_management_file</code> Global * Global www.iso.org/standard/72704.html <code>medtech.iso_27001_isms_scope_and_controls</code> Global * Global www.iso.org/standard/27001.html <code>medtech.log_retention_for_clinical_events</code> Global * Global csrc.nist.gov/pubs/sp/800/92/final <code>medtech.onc_cures_api_fhir_r4</code> Global * Global www.healthit.gov/curesrule/www.healthit.gov/isa/united-states-core-data-interoperability-uscdi <code>medtech.onc_information_blocking_prohibited</code> Global * Global www.healthit.gov/curesrule/ <code>medtech.sg_hcsa_pdpa_health_data</code> Global * Global sso.agc.gov.sg/Act/HCSA2020sso.agc.gov.sg/Act/PDPA2012 <code>medtech.uk_dtac_compliance</code> Global * Global www.nhsx.nhs.uk/standards-and-guidance/digital-technology-assessment-\u2026 <code>medtech.uk_mhra_post_market_surveillance</code> Global * Global www.gov.uk/guidance/medical-devices-post-market-surveillance-requirem\u2026 <code>pci.ebs_encryption</code> Global * Global www.pcisecuritystandards.org/document_librarywww.pcisecuritystandards.org/document_library <code>pci.https_only</code> Global * Global www.pcisecuritystandards.org/document_librarywww.pcisecuritystandards.org/faq/articles/Frequently_Asked_Question/d\u2026www.pcisecuritystandards.org/document_library <code>pci.iam_password_policy</code> Global * Global www.pcisecuritystandards.org/document_librarywww.pcisecuritystandards.org/pdfs/Multi-Factor-Authentication-Guidanc\u2026www.pcisecuritystandards.org/document_library <code>pci.logging_enabled</code> Global * Global www.pcisecuritystandards.org/document_librarywww.pcisecuritystandards.org/documents/Effective-Daily-Log-Monitoring\u2026 <code>pci.storage_encryption</code> Global * Global www.pcisecuritystandards.org/document_librarywww.pcisecuritystandards.org/document_library <code>rg.au_audit_trails</code> APAC AU AU www.coe.int/en/web/conventions/full-list <code>rg.self_exclusion_enforced</code> Europe GB GB www.gamblingcommission.gov.uk/ <code>rg.uigea_payment_blocks</code> North America US US www.federalreserve.gov/newsevents/pressreleases/bcreg20081112a.htm"},{"location":"references-index/#summary","title":"Summary","text":"<p>Total policies: 283</p> <p>Policies with links: 283</p> <p>Unique source URLs: 165</p> <p>Frequent URLs (count &gt; 5):</p> <ul> <li>https://www.pcisecuritystandards.org/document_library (x34)</li> <li>https://www.gamblingcommission.gov.uk/ (x31)</li> <li>https://www.fatf-gafi.org/en/publications/Fatf-recommendations/Fatf-recommendations.html (x27)</li> <li>https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32018L0843 (x21)</li> <li>https://eur-lex.europa.eu/eli/reg/2016/679/oj (x15)</li> <li>https://eur-lex.europa.eu/eli/reg/2023/1114/oj (x9)</li> <li>https://www.fatf-gafi.org/en/publications/Fatf-recommendations/Guidance-R16-travel-rule.html (x9)</li> <li>https://openid.net/specs/openid-connect-core-1_0.html (x6)</li> <li>https://www.openbanking.org.uk/ (x6)</li> </ul>"},{"location":"release-guide/","title":"Release Guide (Practical Steps)","text":"<p>This guide complements <code>release-versioning.md</code> with hands-on commands.</p>"},{"location":"release-guide/#prerequisites","title":"Prerequisites","text":"<ul> <li>Write access (or fork + PR) to create/merge the release PR.</li> <li><code>gh</code> CLI (optional convenience) and <code>cosign</code> if verifying locally.</li> </ul>"},{"location":"release-guide/#standard-flow","title":"Standard Flow","text":"<ol> <li>Land conventional commits on <code>main</code>.</li> <li>Wait for or trigger the Release Please PR (title like <code>chore(main): release &lt;version&gt;</code>).</li> <li>Review generated CHANGELOG section &amp; version bump classification.</li> <li>Merge the PR (squash/merge). Tag + GitHub Release is created automatically.</li> <li>Bundle/sign workflows run and attach artifacts (bundle, manifest, SBOMs, provenance, signatures).</li> <li>(Optional) Deploy docs when publishing publicly.</li> </ol>"},{"location":"release-guide/#manual-trigger","title":"Manual Trigger","text":"<p>If urgent:</p> <ul> <li>Use GitHub Actions workflow dispatch for <code>release-please</code> with appropriate inputs (defaults usually fine).</li> </ul>"},{"location":"release-guide/#verifying-artifacts","title":"Verifying Artifacts","text":"<p>Example verification (digest + signature + provenance) once assets exist:</p> <pre><code>DIGEST=$(grep -E 'bundle_sha256' manifest.json | awk -F '\"' '{print $4}')\nCOSIGN_EXPERIMENTAL=1 cosign verify \\\n  --certificate-identity-regexp \".*github.com/rulehub/rulehub.*\" \\\n  --certificate-oidc-issuer https://token.actions.githubusercontent.com \\\n  ghcr.io/rulehub/rulehub-bundle@sha256:${DIGEST}\n</code></pre> <p>Provenance (SLSA generator) attestation fetch via GH API or <code>cosign verify-attestation</code> using the same identity flags.</p>"},{"location":"release-guide/#hotfixes","title":"Hotfixes","text":"<ul> <li>Commit <code>fix:</code> changes to a branch off the current release tag or <code>main</code> (preferred if clean).</li> <li>Ensure no unrelated pending <code>feat:</code> commits if you intend only a PATCH bump; otherwise accept a MINOR bump.</li> </ul>"},{"location":"release-guide/#when-to-use-major-vs-feature-flags","title":"When to Use MAJOR vs Feature Flags","text":"<p>Prefer feature flags (config inputs) if you can preserve old logic by default. Use a MAJOR bump only when keeping backward logic would cause risk or complexity.</p>"},{"location":"release-guide/#checklist-before-merging-release-pr","title":"Checklist Before Merging Release PR","text":"<ul> <li>[ ] CHANGELOG entry reads cleanly (no internal noise).</li> <li>[ ] Version bump matches intent (feat -&gt; MINOR, fix -&gt; PATCH, breaking -&gt; MAJOR).</li> <li>[ ] No leftover <code>TODO</code> markers in policy or metadata for this release scope.</li> <li>[ ] SBOM workflow succeeded in CI. // Deny rule usage scan present in CI; repository baseline already standardized on deny[]</li> </ul>"},{"location":"release-guide/#post-release","title":"Post-Release","text":"<ul> <li>Announce (issue discussion / social if desired).</li> <li>Collect feedback; open follow-up issues for any regressions quickly.</li> </ul> <p>For deeper semantic rules see <code>release-versioning.md</code>.</p>"},{"location":"release-runbook/","title":"Release Runbook","text":"<p>Authoritative, task\u2011oriented sequence for preparing and publishing a RuleHub release. This file supersedes the former root <code>RELEASE_CHECKLIST.md</code> (now removed) so the content is available in the published documentation site. Root compliance files (<code>SECURITY.md</code>, <code>SUPPORT.md</code>, <code>CODE_OF_CONDUCT.md</code>) remain at repository top level as required by GitHub.</p>"},{"location":"release-runbook/#preparation","title":"Preparation","text":"<ul> <li>[ ] Update dev environment: <code>make setup-dev</code> (or ensure virtualenv active)</li> <li>[ ] Quick hygiene:</li> <li>[ ] YAML: <code>make lint-yaml</code> (or <code>npx @stoplight/spectral lint --ruleset .spectral.yml .</code>)</li> <li>[ ] TS/TSX: (n/a - plugin in separate repo)</li> <li>[ ] Python: <code>ruff check .</code> (optionally <code>ruff format</code>)</li> </ul>"},{"location":"release-runbook/#versioning-changelog","title":"Versioning &amp; CHANGELOG","text":"<ul> <li>[ ] Pick release version (semver): <code>&lt;major.minor.patch&gt;</code></li> <li>[ ] Bump versions:</li> <li>[ ] Backstage plugin: version handled separately</li> <li>[ ] Update <code>CHANGELOG.md</code> (<code>[Unreleased]</code> -&gt; new version section)</li> </ul>"},{"location":"release-runbook/#validation-artifact-build","title":"Validation &amp; Artifact Build","text":"<ul> <li>[ ] Metadata validation: <code>make validate</code> (or <code>make validate-strict</code>)</li> <li>[ ] Coverage &amp; catalog:</li> <li>[ ] <code>make coverage</code> - refreshes <code>docs/coverage.md</code> &amp; <code>dist/*</code></li> <li>[ ] <code>make catalog</code> - generates <code>dist/index.json</code> for plugin (Policy         source sync now handled externally - skip here)</li> </ul>"},{"location":"release-runbook/#tests","title":"Tests","text":"<ul> <li>[ ] Kyverno CLI tests: <code>make test-kyverno</code></li> <li>[ ] Gatekeeper/OPA tests: <code>make test-gatekeeper</code></li> </ul>"},{"location":"release-runbook/#helm-external","title":"Helm (external)","text":"<p>See <code>rulehub/rulehub-charts</code> repository for chart lint/render/package/publish steps.</p>"},{"location":"release-runbook/#backstage-plugin-npm","title":"Backstage Plugin (NPM)","text":"<p>Released separately via <code>@rulehub/plugin-policy-catalog</code> repository (see its README/CI) - no steps here.</p>"},{"location":"release-runbook/#opa-bundle-oci-publishing","title":"OPA Bundle (OCI Publishing)","text":"<ul> <li>[ ] Build: <code>make opa-bundle</code> (produces <code>dist/opa-bundle.tar.gz</code>)</li> <li>[ ] (Optional shortcut) All-in-one: <code>make opa-bundle-all</code> (bundle + manifest + SBOM in one step)</li> <li>[ ] Link audit drift: <code>make link-audit &amp;&amp; make link-audit-diff</code> (ensure unexpected drift = 0 before tagging)</li> <li>[ ] Manifest: <code>make opa-bundle-manifest</code> (produces <code>dist/opa-bundle.manifest.json</code> - hashes &amp; aggregate integrity)</li> <li>[ ] SBOM (default SPDX): <code>make sbom-opa-bundle</code> (creates       <code>dist/opa-bundle.spdx-json.json</code> via Syft; override format with       <code>SBOM_FORMAT=</code>; default output path shown in Makefile variable       <code>SBOM_OUT</code>)</li> <li>[ ] (Alt) Combined CycloneDX + SPDX (CI): see workflow       <code>opa-bundle-publish.yml</code> (generates       <code>dist/opa-bundle.sbom.cdx.json</code> &amp; <code>dist/opa-bundle.sbom.spdx.json</code>)</li> <li>[ ] (Optional) Sign bundle + manifest + SBOM: <code>make sign-opa-bundle</code>       (blob signatures, produces <code>.sig</code> / <code>.pem</code>); for OCI artifact use       <code>make sign-oci IMAGE=... TAG=...</code></li> <li>[ ] (Optional) Verify signatures locally: <code>make verify-opa-bundle</code> (or manual <code>cosign verify-blob ...</code>)</li> <li>[ ] Integrity check (post-build): <code>make verify-bundle</code> (ensures manifest hashes match bundle contents)</li> <li>[ ] Determinism (spot check): <code>make bundle-deterministic</code> (two builds -&gt; identical SHA256)</li> <li>[ ] Push to OCI: <code>make oras-publish IMAGE=ghcr.io/rulehub/rulehub-bundle TAG=&lt;tag&gt;</code></li> <li>Requires ORAS CLI and authenticated login (<code>oras login ghcr.io</code>).</li> <li>After push (CI): provenance &amp; SBOM attestations generated/signature verification (see <code>opa-bundle-publish.yml</code>).</li> </ul>"},{"location":"release-runbook/#sbom-guidance","title":"SBOM Guidance","text":"<ul> <li>Local quick path: run <code>make opa-bundle-all</code> to produce bundle, manifest, and an SPDX SBOM in one step.</li> <li>For multi-format SBOMs (CycloneDX + SPDX) rely on CI workflow; locally you can invoke Syft twice:</li> <li><code>syft packages dist/opa-bundle.tar.gz -o cyclonedx-json &gt; dist/opa-bundle.sbom.cdx.json</code></li> <li><code>syft packages dist/opa-bundle.tar.gz -o spdx-json &gt; dist/opa-bundle.sbom.spdx.json</code></li> <li>Always archive SBOM(s) with the release; verify presence via <code>make artifacts-verify</code>.</li> <li>When signing, sign each SBOM and manifest so consumers can verify integrity prior to policy ingestion.</li> </ul>"},{"location":"release-runbook/#finalization","title":"Finalization","text":"<ul> <li>[ ] Update <code>CHANGELOG</code> / docs if needed</li> <li>[ ] (In plugin repo) bump npm package if API changed</li> <li>[ ] Create tag &amp; GitHub release:</li> <li>Tag: <code>v&lt;version&gt;</code> (e.g., <code>v0.1.0</code>), description from CHANGELOG</li> <li>Release: attach / reference artifacts (OCI links helm/opa, npm version)</li> </ul>"},{"location":"release-runbook/#pre-publish-sanity","title":"Pre-publish sanity","text":"<ul> <li>[ ] <code>Chart.yaml: version == &lt;version&gt;</code></li> <li>[ ] <code>package.json: version == &lt;version&gt;</code> (plugin repo)</li> <li>[ ] <code>CHANGELOG.md: section &lt;version&gt;</code></li> </ul> <p>History: migrated from root <code>RELEASE_CHECKLIST.md</code> to <code>docs/release-runbook.md</code> to be part of published documentation (MkDocs navigation). The original file has been removed to reduce duplication.</p>"},{"location":"release-versioning/","title":"Versioning &amp; Release Policy","text":"<p>This project follows Semantic Versioning (SemVer) for all published artifacts (OPA bundle OCI image + GitHub Release assets + documentation site).</p>"},{"location":"release-versioning/#semver-recap","title":"SemVer Recap","text":"<ul> <li>MAJOR (X): Incremented for backwards-incompatible changes to policy behavior, structure or removal/rename of policy packages, metadata fields or compliance map schemas.</li> <li>MINOR (Y): Backwards-compatible additions: new policies, new metadata fields (optional), new compliance maps, non-breaking rule logic enhancements, added annotations.</li> <li>PATCH (Z): Backwards-compatible fixes: bug fixes to policy logic that tighten correctness without expanding required inputs; documentation-only updates; build or CI adjustments with no policy effect.</li> </ul> <p>Example: <code>v1.4.2</code> means Major=1, Minor=4, Patch=2.</p>"},{"location":"release-versioning/#what-constitutes-a-breaking-change","title":"What Constitutes a Breaking Change?","text":"<p>Any change that could cause existing users integrating the bundle to fail evaluation or produce different DENY/ALLOW outcomes under the same inputs unless they opt-in. Examples:</p> <ol> <li>Removing or renaming a policy package or rule used by consumers.</li> <li>Changing required input document structure or field semantics.</li> <li>Tightening a rule to produce new DENY results by default (unless gated behind a feature flag / configuration parameter with default preserving old behavior).</li> <li>Renaming / removing top-level metadata keys (e.g., in compliance maps) or altering existing key meaning.</li> <li>Changing manifest schema_version.</li> </ol> <p>If unsure, treat the change as breaking and schedule it for the next MAJOR release with clear release notes.</p>"},{"location":"release-versioning/#non-breaking-enhancements-minor","title":"Non-Breaking Enhancements (Minor)","text":"<p>Examples of safe MINOR increments:</p> <ul> <li>Adding new independent policies.</li> <li>Adding optional metadata fields (defaulting to null / absent).</li> <li>Expanding coverage maps with new categories (without altering existing keys).</li> <li>Performance optimizations not affecting evaluation outcome.</li> <li>Adding new annotations, SBOM formats, attestations, or documentation pages.</li> <li>Logic corrections that only reduce false negatives or false positives without requiring new input fields and are unlikely to break pipelines.</li> <li>Documentation, examples, README, site content changes.</li> <li>CI/workflow improvements not altering published artifact contents (hash stable) - if the bundle bytes change due to a policy fix, it is at minimum a PATCH.</li> </ul>"},{"location":"release-versioning/#patch-changes","title":"Patch Changes","text":"<ul> <li>Logic corrections that only reduce false negatives or false positives without requiring new input fields and are unlikely to break pipelines.</li> <li>Documentation, examples, README, site content changes.</li> <li>CI/workflow improvements not altering published artifact contents (hash stable) - if the bundle bytes change due to a policy fix, it is at minimum a PATCH.</li> </ul>"},{"location":"release-versioning/#pre-100-policy","title":"Pre-1.0.0 Policy","text":"<p>Before <code>v1.0.0</code>, minor version bumps (0.Y.Z) may include changes that would otherwise be considered breaking. We still aim to minimize breakage and document any incompatible changes clearly in the CHANGELOG.</p>"},{"location":"release-versioning/#release-flow","title":"Release Flow","text":"<ol> <li>Merge changes to <code>main</code> - automated publish workflow builds snapshot bundle (<code>main-&lt;shortsha&gt;</code> tag in GHCR) with manifest + SBOM + signatures + provenance.</li> <li>Prepare a release PR using <code>release-please</code> (generates updated CHANGELOG and version bump proposal based on commit conventions).</li> <li>On tag push / GitHub Release publish (<code>vX.Y.Z</code>), the workflow rebuilds, signs, attests and attaches artifacts to the Release.</li> <li>Docs site (MkDocs) can be deployed separately (<code>make docs-deploy</code>) - ensure <code>site_url</code> matches GitHub Pages.</li> <li>Consumers pin exact tags or immutable digests (recommended: digest from provenance / manifest integrity verification).</li> </ol>"},{"location":"release-versioning/#commit-changelog-conventions","title":"Commit &amp; Changelog Conventions","text":"<p>Use conventional commit-like prefixes to aid automated tooling (not strictly enforced yet):</p> <ul> <li><code>feat(policy): ...</code> new policy or enhancement (likely MINOR)</li> <li><code>fix(policy): ...</code> logic correction (PATCH)</li> <li><code>refactor(policy): ...</code> internal change (PATCH unless behavior changes)</li> <li><code>break(policy)!: ...</code> denotes breaking change (MAJOR) - include migration notes.</li> <li><code>docs: ...</code> documentation only.</li> <li><code>build|ci|chore: ...</code> infra / tooling.</li> </ul> <p><code>release-please</code> interprets these to decide version bump. Add <code>!</code> to force a major bump if necessary.</p>"},{"location":"release-versioning/#manifest-integrity-versioning","title":"Manifest &amp; Integrity Versioning","text":"<ul> <li><code>schema_version</code> in manifest increments independently when manifest structure changes. Such a change is considered at least MINOR; if consumers depend on old structure without fallback, it may be MAJOR. Keep backward compatibility by adding fields rather than renaming/removing; prefer documenting recommended replacements and migration notes.</li> </ul>"},{"location":"release-versioning/#consumer-guidance","title":"Consumer Guidance","text":"<ul> <li>For stability: pin a digest + verify signature &amp; provenance.</li> <li>For faster updates: track a MAJOR version tag (<code>v1</code> style mutable tag) once established post-1.0.0 (not yet implemented pre-1.0.0).</li> </ul>"},{"location":"release-versioning/#future-automation","title":"Future Automation","text":"<p>Planned enhancements:</p> <ul> <li>Enforce commit message lint for version classification.</li> <li>Automated opening of breaking-change issue template when <code>!</code> detected.</li> <li>Mutable major stream tags (<code>v1</code>, <code>v2</code>) updated by release workflow.</li> </ul>"},{"location":"release-versioning/#feedback","title":"Feedback","text":"<p>Open an issue with proposals for additional versioning signals (e.g., policy maturity levels) or more granular compatibility guarantees.</p>"},{"location":"security-integrity/","title":"Release &amp; Integrity","text":"<p>This page describes the integrity metadata and verification flow for RuleHub bundles.</p> <p>Artifacts:</p> <ul> <li>OPA bundle: <code>dist/opa-bundle.tar.gz</code></li> <li>Manifest: <code>dist/opa-bundle.manifest.json</code></li> <li>SBOM: <code>dist/opa-bundle.&lt;format&gt;.json</code></li> <li>Signatures: <code>*.sig</code> / <code>*.pem</code> (cosign keyless by default)</li> <li>Provenance (planned): <code>dist/provenance.json</code> attested via <code>cosign attest</code></li> </ul> <p>Manifest schema (v1):</p> <pre><code>schema_version: 1\nbuild_commit: &lt;git sha&gt;\nbuild_time: &lt;RFC3339 UTC&gt;\npolicies: [ { path, sha256, bytes }, ... ]\naggregate_hash: sha256( join('\\n', '&lt;sha256&gt;  &lt;path&gt;' sorted by path) )\n</code></pre> <p>Verification steps:</p> <ol> <li>Recompute file hashes for each listed path.</li> <li>Recompute aggregate hash and compare.</li> <li>Validate git commit (optional offline).</li> <li>Verify cosign signatures (bundle + manifest).</li> <li>(Planned) Verify provenance predicate subject digest matches bundle + manifest hash.</li> </ol> <p>CLI helper: <code>make verify-bundle</code> (wraps <code>tools/verify_bundle.py</code>).</p> <p>Upcoming:</p> <ul> <li>Add provenance predicate generation target.</li> <li>Extend manifest with <code>policy_count</code> and <code>bundle_sha256</code> (hash of tarball) for cross-check.</li> </ul>"},{"location":"security-provenance/","title":"Security and Provenance Artifacts","text":"<p>This document describes the security, integrity, and transparency artifacts published with releases (and optionally main branch snapshots).</p>"},{"location":"security-provenance/#published-artifacts-per-release-tagged-build","title":"Published Artifacts (per release / tagged build)","text":"Artifact Location Purpose OPA bundle <code>dist/opa-bundle.tar.gz</code> + GH Release asset + GHCR (OCI layer) Policy distribution (Rego / constraints) Signature <code>dist/opa-bundle.tar.gz.sig</code> Integrity + origin (Sigstore keyless) Certificate <code>dist/opa-bundle.tar.gz.cert</code> Fulcio cert binding signature to GitHub workflow identity SBOM (CycloneDX) <code>dist/opa-bundle.sbom.cdx.json</code> Dependency / component inventory (CycloneDX tooling) SBOM (SPDX) <code>dist/opa-bundle.sbom.spdx.json</code> License / compliance workflows (SPDX tooling) SBOM attestations OCI attestations (<code>type=cyclonedx</code>, <code>type=spdx</code>) Bind SBOMs to the pushed OCI artifact SLSA v1 provenance attestation OCI attestation (<code>type=slsaprovenance</code>) Build provenance (SLSA Level 3 via official generator) Generator provenance artifact Release asset (name: <code>rulehub-opa-bundle.provenance.intoto.jsonl</code> or similar) Downloadable in-toto statement for offline verification <p>Artifacts are attached to GitHub Releases. The bundle is published to <code>ghcr.io/rulehub/rulehub-bundle:&lt;tag&gt;</code> (tag = release tag or main snapshot) along with attestations.</p>"},{"location":"security-provenance/#1-verifying-the-bundle-signature-blob","title":"1. Verifying the Bundle Signature (Blob)","text":"<p>Use cosign keyless verification:</p> <pre><code>cosign verify-blob \\\n  --certificate dist/opa-bundle.tar.gz.cert \\\n  --signature dist/opa-bundle.tar.gz.sig \\\n  dist/opa-bundle.tar.gz\n</code></pre> <p>Optional flags:</p> <ul> <li><code>--certificate-identity-regexp</code> to restrict the expected subject (e.g., your repository path)</li> <li><code>--certificate-oidc-issuer-regexp</code> to restrict the OIDC issuer (e.g., <code>https://token.actions.githubusercontent.com</code>)</li> </ul>"},{"location":"security-provenance/#2-sboms-cyclonedx-spdx","title":"2. SBOMs (CycloneDX &amp; SPDX)","text":"<p>Two SBOM formats are generated from the built bundle with Syft and:</p> <ul> <li>stored as release assets,</li> <li>uploaded as workflow artifacts,</li> <li>attested to the OCI artifact (so consumers can pull them via referrers / cosign).</li> </ul> <p>Presence (non-empty) is enforced in the <code>verify-bundle-artifacts</code> job.</p>"},{"location":"security-provenance/#3-provenance-slsa-level-3","title":"3. Provenance (SLSA Level 3)","text":"<p>Provenance is produced by the official reusable workflow <code>slsa-framework/slsa-github-generator</code> (generic SLSA3). This yields an in-toto statement attested to the OCI artifact (predicate type <code>slsaprovenance</code>) and uploaded as a release/downloadable artifact.</p> <p>Retrieve and verify the provenance attestation (public registry scenario):</p> <pre><code>cosign verify-attestation \\\n  --type slsaprovenance \\\n  ghcr.io/rulehub/rulehub-bundle:&lt;tag&gt; &gt; attestation.jsonl\n\ngrep sha256 attestation.jsonl\n</code></pre> <p>Add identity constraints (recommended):</p> <pre><code>cosign verify-attestation \\\n  --type slsaprovenance \\\n  --certificate-identity-regexp \"https://github.com/rulehub/&lt;repo&gt;/.*\" \\\n  --certificate-oidc-issuer-regexp '^https://token.actions.githubusercontent.com$' \\\n  ghcr.io/rulehub/rulehub-bundle:&lt;tag&gt;\n</code></pre> <p>The statement's <code>subject</code> digest must match the bundle SHA256 published in logs. The repository commit SHA should appear in materials. Consumers can further enforce policy (e.g., required builder ID / workflow path) with <code>cosign verify-attestation</code> flags.</p>"},{"location":"security-provenance/#4-analysis-tooling-suggestions","title":"4. Analysis &amp; Tooling Suggestions","text":"Format Typical Uses Notes CycloneDX Vulnerability &amp; dependency graph tools, BOM diffing Broad ecosystem support (Grype, Dependency-Track, etc.) SPDX License compliance, provenance ingestion in legal tooling SPDX JSON v2.3 generated directly (no conversion loss) <p>Conversion between formats is optional (Syft already emits both). Downstream systems can choose their preferred format.</p>"},{"location":"security-provenance/#5-future-enhancements","title":"5. Future Enhancements","text":"<p>Potential roadmap:</p> <ul> <li>SBOM diffing &amp; drift detection between releases (flag unexpected component additions/removals).</li> <li>Automated vulnerability scanning + vulnerability attestations (VEX / SARIF to attestation).</li> <li>Policy-level provenance (splitting bundle into logical subcomponents with separate subjects if needed).</li> <li>Rekor transparency log monitoring / alerting on signature anomalies.</li> </ul> <p>Open an issue to propose additional integrity artifacts or verification policies.</p>"},{"location":"security-threat-model/","title":"High-Level Threat Model: Metadata -&gt; Coverage Map -&gt; dist/index.json -&gt; Consumers","text":"<p>This document captures a pragmatic, evolving threat model for the RuleHub policy supply chain from authoring time to downstream consumption.</p>"},{"location":"security-threat-model/#1-scope-assets","title":"1. Scope &amp; Assets","text":"<p>Pipeline stages: 1. Source Metadata &amp; Policies (<code>policies/**/metadata.yaml</code>, <code>policy.rego</code>, tests) 2. Tooling &amp; Transformation (<code>tools/coverage_map.py</code>, metadata loaders, guardrails) 3. Generated Aggregates (<code>coverage.json</code>, <code>dist/index.json</code>, maps, bundle manifests) 4. Distribution Artifacts (OPA bundle, manifest, SBOMs, signatures, provenance) 5. Consumer Integration (CI/CD checks, admission controllers, reporting systems)</p> <p>Primary assets:</p> <ul> <li>Policy logic (Rego) and associated metadata fields (id, severity, tags, links).</li> <li>Compliance maps (mapping policies to frameworks / sections).</li> <li>Integrity artifacts: bundle manifest hashes, signatures, provenance attestation.</li> <li>Index (<code>dist/index.json</code>) - canonical machine-readable catalog.</li> </ul> <p>Security properties desired: | Property | Description | |----------|-------------| | Integrity | Prevent unauthorized modification of policies, metadata, or generated index. | | Authenticity | Demonstrate origin &amp; build identity of artifacts. | | Completeness | Ensure no silent omission of required policies in index/bundle. | | Non-ambiguity | Prevent ID collisions / inconsistent metadata leading to misinterpretation. | | Traceability | Ability to trace an index entry back to source commit &amp; file path reliably. |</p> <p>Out of scope (for now):</p> <ul> <li>Confidentiality (content is open)</li> <li>Fine\u2011grained authorization inside consumer clusters</li> <li>Runtime Rego evaluation threats</li> </ul>"},{"location":"security-threat-model/#2-data-flow-textual","title":"2. Data Flow (Textual)","text":"<pre><code>Authors \u2192 Git Repo (policies/, metadata/) \u2192 Guardrail / Lint (CI) \u2192\n  Coverage &amp; Index Generation (coverage_map.py, loaders) \u2192 dist/index.json \u2192\n    Bundle Packaging (opa-bundle.tar.gz + manifest + sboms + provenance) \u2192\n      Signing / Attestations (cosign) \u2192 Registry / Release \u2192 Consumers pull &amp; verify\n</code></pre> <p>Trust boundaries:</p> <ul> <li>B1: Contributor workstation -&gt; GitHub repo.</li> <li>B2: GitHub Actions workflow execution environment.</li> <li>B3: Storage / Release distribution (GitHub Releases, GHCR registry).</li> <li>B4: Consumer environment (clusters / pipelines verifying artifacts).</li> </ul>"},{"location":"security-threat-model/#3-threat-enumeration-stride-oriented-per-stage","title":"3. Threat Enumeration (STRIDE-Oriented per Stage)","text":"Stage Threat Examples Source (B1) T: Tampering with metadata IDs; R: Malicious Rego; I: Inconsistent severity/tags. Tooling (B2) T: Build modifies generator; R: Script injection; I: Skipped validation yields incomplete index. Generated Artifacts T: Add/remove entries; R: Replay stale index; I: Hash truncation/collision attempts. Distribution (B3) T: Registry substitution / MITM; R: Replay old bundle; D: Large malicious policy set (DoS). Consumer (B4) T: Use unverified bundle; E: Skip provenance; I: Partial ingestion without alert."},{"location":"security-threat-model/#4-existing-controls","title":"4. Existing Controls","text":"Control Coverage Git version control + code review Source integrity &amp; traceability Guardrails scripts (metadata, links, tests) Reduce malformed / risky content Rego test enforcement Deny/pass presence regression safety Deterministic generation script Predictable diff-based review Bundle manifest (hash list + aggregate) Post-build tamper detection Cosign signatures Distribution authenticity &amp; integrity SBOM generation Component transparency (Planned) Provenance attestation Build identity &amp; material linkage"},{"location":"security-threat-model/#5-gaps-risks","title":"5. Gaps &amp; Risks","text":"Gap Impact Priority Lack of explicit freshness / timestamp check on consumer side Replay of old but validly signed bundle Medium No policy for minimum test coverage vs deny rules enforced at release gate Logic modifications slipping Medium Incomplete provenance adoption for all artifacts (only bundle) Reduced traceability for index-only consumers Medium No automated ID collision detector across historical releases Potential confusion / override risk Low Absence of reproducible build assertion (no secondary build compare) Harder to detect compromised build runner Low Metadata field normalization (tags/geo) partially manual Inconsistent semantics to consumers Low"},{"location":"security-threat-model/#6-recommended-mitigations-roadmap","title":"6. Recommended Mitigations &amp; Roadmap","text":"<p>Short term (1-2 releases):</p> <ul> <li>Consumer guidance: document verification workflow (provenance + freshness check).</li> <li>Add Make target <code>verify-index</code> to recompute &amp; compare <code>dist/index.json</code> vs sources + manifest.</li> <li>Enforce aggregate test gate (deny rules &gt;1 must have aggregate test).</li> </ul> <p>Mid term (2-4 releases):</p> <ul> <li>Extend provenance predicate to include <code>dist/index.json</code> hash.</li> <li>Introduce release metadata file (policy count &amp; index SHA) signed separately.</li> <li>Implement ID collision scanner (new index vs previous tag; fail on conflicting reuse).</li> <li>Add evaluation performance budget metric (detect pathologic Rego growth).</li> </ul> <p>Long term:</p> <ul> <li>Reproducible build: secondary ephemeral rebuild to compare hashes.</li> <li>Continuous attestation monitoring (Rekor scanning / mismatch alerts).</li> <li>Policy-level provenance (source digest -&gt; packaged path mapping).</li> </ul>"},{"location":"security-threat-model/#7-attack-scenarios-mitigations","title":"7. Attack Scenarios &amp; Mitigations","text":"Scenario Description Mitigations Malicious contributor exfil rule Exfil via trusted decision output Review, deny/pass tests, future static scan Build runner compromise Phantom policies added / removed Deterministic script + manifest + provenance Replay (old bundle) Outdated controls persist Freshness policy, tag pinning, provenance timestamp check Tampered distribution (MITM) Bundle bytes modified Cosign signature + manifest hash verification Silent severity downgrade Risk underestimated downstream Release diff review, approval rule on severity lowers Oversized pathological policy Evaluation resource exhaustion Complexity lint, performance gate"},{"location":"security-threat-model/#8-assurance-monitoring-metrics","title":"8. Assurance &amp; Monitoring Metrics","text":"<p>Suggested KPIs:</p> <ul> <li>Policy count delta vs prior release (expected vs actual)</li> <li>% policies with aggregate + negative tests</li> <li>Index generation time (baseline drift)</li> <li>Hash mismatches in verification job (target: 0)</li> <li>Provenance attestation availability rate</li> </ul>"},{"location":"security-threat-model/#9-consumer-verification-checklist-quick-reference","title":"9. Consumer Verification Checklist (Quick Reference)","text":"<ol> <li>Download bundle + manifest + signatures (or pull OCI ref + referrers)</li> <li>Verify cosign signatures with identity constraints</li> <li>Verify provenance (builder ID, workflow path, subject digest matches bundle / manifest)</li> <li>Recompute manifest aggregate hash locally; compare</li> <li>Optionally regenerate <code>index.json</code> (checkout tag) and diff vs distributed file</li> <li>Enforce freshness (approved tag; within policy schedule)</li> <li>Monitor unexpected policy ID removals vs last baseline</li> </ol>"},{"location":"security-threat-model/#10-status-summary","title":"10. Status Summary","text":"Property Status Integrity Strong (bundle hash + signature); moderate for raw <code>index.json</code> sans manual verify Authenticity Cosign keyless + planned broader provenance Completeness Guardrails + deterministic gen; need automated cross-version diff Traceability Commit refs implicit; multi-subject provenance pending Replay Resistance Relies on consumer freshness policy <p>This threat model is versioned implicitly via repository history; propose updates by submitting a PR.</p>"},{"location":"integrity/plugin_index_validation/","title":"Backstage Plugin Index Validation","text":"<p>This document describes the <code>plugin_index_validate.py</code> tool which validates the Backstage plugin index (<code>dist/index.json</code>) against the repository JSON Schema (<code>tools/schemas/plugin-index.schema.json</code>).</p>"},{"location":"integrity/plugin_index_validation/#purpose","title":"Purpose","text":"<p>The Backstage Policy Catalog plugin consumes a canonical index at <code>dist/index.json</code>. This tool ensures the generated index adheres to the expected schema and produces a small integrity report suitable for CI or human review.</p>"},{"location":"integrity/plugin_index_validation/#location","title":"Location","text":"<ul> <li>Tool: <code>tools/plugin_index_validate.py</code></li> <li>Schema: <code>tools/schemas/plugin-index.schema.json</code></li> <li>Index (generated): <code>dist/index.json</code></li> <li>Reports (generated): <code>dist/integrity/plugin_index_validation.md</code> and <code>dist/integrity/plugin_index_validation.json</code></li> </ul>"},{"location":"integrity/plugin_index_validation/#acceptance","title":"Acceptance","text":"<ul> <li>When the index is valid the tool exits 0 and prints \"Schema valid\". The markdown report contains the single line <code>Schema valid</code>.</li> <li>When invalid the tool exits 2, prints a short list of JSON Pointer locations and error messages, and writes a markdown report enumerating errors. The JSON file includes the error objects with <code>pointer</code>, <code>message</code>, and <code>instance</code> fields.</li> </ul>"},{"location":"integrity/plugin_index_validation/#usage","title":"Usage","text":"<p>From repository root:</p> <pre><code>python3 tools/plugin_index_validate.py\n</code></pre> <p>Optional flags:</p> <ul> <li><code>--schema</code> - path to JSON Schema (default: <code>tools/schemas/plugin-index.schema.json</code>)</li> <li><code>--index</code> - path to index JSON (default: <code>dist/index.json</code>)</li> <li><code>--out-md</code> - path to markdown report (default: <code>dist/integrity/plugin_index_validation.md</code>)</li> <li><code>--out-json</code> - path to JSON errors output (default: <code>dist/integrity/plugin_index_validation.json</code>)</li> <li><code>--no-json</code> - skip writing the JSON errors file</li> </ul> <p>Example (custom paths):</p> <pre><code>python3 tools/plugin_index_validate.py --index dist/index.json --schema tools/schemas/plugin-index.schema.json\n</code></pre>"},{"location":"integrity/plugin_index_validation/#ci-integration","title":"CI integration","text":"<p>The repository already contains a lightweight schema validation step in <code>.github/workflows/coverage.yml</code> which imports <code>jsonschema</code> and runs validation inline. The <code>plugin_index_validate.py</code> tool produces the same validation results plus a human-friendly markdown artifact under <code>dist/integrity</code> suitable for upload as a CI artifact.</p> <p>To add the tool to CI, call it after <code>make catalog</code>/index generation and upload <code>dist/integrity/plugin_index_validation.md</code> as an artifact.</p>"},{"location":"integrity/plugin_index_validation/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>If you see <code>Missing file: dist/index.json</code> ensure the catalog/index generation step ran (<code>make catalog</code> or <code>python3 tools/coverage_map.py</code>).</li> <li>If <code>jsonschema</code> is not installed, install it in your environment (<code>pip install jsonschema</code>) or let CI install requirements.</li> </ul>"},{"location":"integrity/plugin_index_validation/#notes","title":"Notes","text":"<ul> <li>The tool uses Draft-07 validation to match the schema's <code>$schema</code> declaration.</li> <li>Reports use JSON Pointer-like paths (e.g., <code>/packages/3/id</code>) to help locate errors inside the index.</li> </ul>"}]}